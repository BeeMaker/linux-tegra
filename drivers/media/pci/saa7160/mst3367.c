#include "LINUXV4L2.h"
#include "sa7160.h"
#include "fh8735.h"
#include "mz0380.h"
#include "pl330b.h"
#include "property.h"
#include "wrapper.h"

//daniel, add RGB SOG input 2015, 10, 7
#define NO_HV_SIGNAL	0
#define HV_SEP_SIGNAL	1
#define HV_COMPOSITE	2
#define SOG_SIGNAL		3

#define HV_SEP_MODE		0
#define SOG_NO_HSYNC	1
#define SOG_WITH_HSYNC	2
#define SOG_TV_MODE		3

extern UINT FADD02C9C13B14f83989880EFACB8D8DC [ 64 ][ 4 ];

extern UINT F3A66BD0F0BCB4afcAD006E378E671B9A   [ 64 ][ 4 ];

extern UINT F925442591E22492f9239C6028CE3DD94 [ 64 ][ 4 ];

extern UINT F42BAA55A84E847faA4D0C0565699845E        [ 64 ][ 4 ];

extern UINT F1D56E1ED762E4b99BB2BD370DFE317D1  [ 64 ][ 4 ] ;

extern BOOLEAN F6B9E557A4BA24ffd926B820B836289C8_100NS( ULONG F6B9E557A4BA24ffd926B820B836289C8 );

extern BOOLEAN B98859FFE32A4FC2A1A6B33CBCB91945( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, BYTE bBitNum, BYTE bDirection );

BOOLEAN MST3367_ADC_INIT( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice );

BOOLEAN MST3367_HDMI_INIT( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice );

BOOLEAN MST3367_HDMI_RESET( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice );

BOOLEAN MST3367_HDCP_RESET( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice );

BOOLEAN MST3367_TMDS_HOT_PLUG( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, ULONG dwType );

#ifdef AME_PL330B
extern void CheckAllSettingParameters( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, ULONG* status );
#endif



VOID MST3367_AUDIO_SELECT( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, ULONG nAudioIn );

UINT MST3367_DETECT_VSYNC_WIDTH( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, ULONG knownvtotal, ULONG vfreq);

ULONG SearchDisplayModeTable( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, ULONG inputmode, ULONG vtotal, ULONG vfreq, ULONG polarity );

WORD MST3367_GetAudioSamplingFreq( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice );

#define MODESIZE 19

BYTE MST3367_HDCP_KEY[ 6 ] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };

static ULONG RX_ADC_SET_VALUES_EIA[ DEFAULT_MST3367_VESA_SIZE ][ MODESIZE ] = {

	{ 0x28, 0x08, 0x08, 0x30, 0x33, 0x03,  800,  525 / 1, 144 -      1, 35,  640,  480, 60, 0, 3147,  2,   25175,  96, 0 }, // [01]  640 X  480 @60 [DMT  ]

#if defined(AME_SA7160) || defined(AME_CY3014)

	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  858,  525 / 2, 119 -      0, 19, 1440,  240, 60, 0, 1573,  3,   13500,  62, 0 }, // [02] 1440 X  240 @60
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  864,  625 / 2, 132 -      1, 23, 1440,  288, 50, 0, 1563,  3,   13500,  62, 0 }, // [03] 1440 X  288 @50
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  864,  645 / 2, 132 -      0, 23, 1440,  288, 50, 0, 1563,  5,   13500,  62, 0 }, // [03] 1440 X  288 @50 (PS2.PAL)
#else
	{ 0x08, 0x08, 0x08, 0x18, 0x88, 0x04, 1716,  525 / 2, 124 +    114, 18, 1440,  240, 60, 0, 3146,  3,   27000, 124, 0 }, // [02] 1440 X  240 @60
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  864,  625 / 2, 132 -      1, 23, 1440,  288, 50, 0, 1563,  3,   13500,  62, 0 }, // [03] 1440 X  288 @50
	{ 0x08, 0x08, 0x08, 0x18, 0x88, 0x04, 1728,  645 / 2, 126 +    138, 23, 1440,  288, 50, 0, 1563,  5,   13500,  62, 0 }, // [03] 1440 X  288 @50 (PS2.PAL)
#endif

	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  858,  525 / 2, 119 -      1, 18,  720,  240, 60, 0, 1573,  3,   13500,  62, 1 }, // [04]  720 X  240 @60
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  864,  625 / 2, 132 -      1, 22,  720,  288, 50, 0, 1563,  3,   13500,  62, 1 }, // [05]  720 X  288 @50
	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03,  858,  525 / 1, 122 -      1, 36,  720,  480, 60, 0, 3147,  6,   27000,  62, 0 }, // [06]  720 X  480 @60
	{ 0x18, 0x08, 0x08, 0x18, 0x33, 0x03,  864,  625 / 1, 132 -      1, 44,  720,  576, 50, 0, 3125,  5,   27000,  64, 0 }, // [07]  720 X  576 @50
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 3300,  750 / 1, 260 + 40 - 1, 25, 1280,  720, 30, 3, 2250,  5,   74250,  40, 0 }, // [08] 1280 X  720 @30
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 3960,  750 / 1, 260 + 40 - 1, 25, 1280,  720, 25, 3, 1875,  5,   74250,  40, 0 }, // [09] 1280 X  720 @25
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 3300,  750 / 1, 260 + 40 - 1, 25, 1280,  720, 24, 3, 1800,  5,   59400,  40, 0 }, // [10] 1280 X  720 @24
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 1650,  756 / 1, 260 + 40 - 1, 25, 1280,  720, 60, 3, 4500, 11,   74250,  40, 0 }, // [11] 1280 X  720 @60 (QQ: 770948433)
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 1650,  750 / 1, 260 + 40 - 1, 25, 1280,  720, 60, 3, 4500,  5,   74250,  40, 0 }, // [11] 1280 X  720 @60
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 1980,  750 / 1, 260 + 40 - 1, 25, 1280,  720, 50, 3, 3750,  5,   74250,  40, 0 }, // [12] 1280 X  720 @50
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 2200, 1125 / 2, 192 + 44 - 1, 20, 1920,  540, 60, 3, 3375,  5,   74250,  44, 1 }, // [13] 1920 X  540 @60
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 2640, 1125 / 2, 192 + 44 - 1, 20, 1920,  540, 50, 3, 2813,  5,   74250,  44, 1 }, // [14] 1920 X  540 @50
	{ 0xE8, 0x38, 0x30, 0x60, 0x00, 0x00, 2200, 1125 / 1, 192 + 44 - 1, 41, 1920, 1080, 30, 3, 3375,  5,   74250,  44, 0 }, // [15] 1920 X 1080 @30
	{ 0xE8, 0x38, 0x30, 0x60, 0x00, 0x00, 2640, 1125 / 1, 192 + 44 - 1, 41, 1920, 1080, 25, 3, 2815,  5,   74250,  44, 0 }, // [16] 1920 X 1080 @25
	{ 0xE8, 0x38, 0x30, 0x60, 0x00, 0x00, 2750, 1125 / 1, 192 + 44 - 1, 41, 1920, 1080, 24, 3, 2700,  5,   74250,  44, 0 }, // [17] 1920 X 1080 @24
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2200, 1117 / 1, 192 +      1, 33, 1920, 1080, 60, 3, 6750,  6,  148500,  44, 0 }, // [18] 1920 X 1080 @60 [DMT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2200, 1131 / 1, 192 +      1, 41, 1920, 1080, 60, 3, 6750, 11,  148500,  44, 0 }, // [18] 1920 X 1080 @60 (QQ: 770948433)
	{ 0xE8, 0x38, 0x30, 0x60, 0x00, 0x00, 2200, 1125 / 1, 192 + 44 - 1, 41, 1920, 1080, 60, 3, 6750,  5,  148500,  44, 0 }, // [18] 1920 X 1080 @60
	{ 0xE8, 0x38, 0x30, 0x60, 0x00, 0x00, 2640, 1125 / 1, 192 + 44 - 1, 41, 1920, 1080, 50, 3, 5625,  5,  148500,  44, 0 }, // [19] 1920 X 1080 @50
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1712, 1065 / 1, 352 +      0, 36, 1280, 1024, 60, 3, 6378,  2,  109191, 136, 0 }, // [00] 1280 X 1024 @60 [CVT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1716, 1111 / 1, 384 +      1, 80, 1280, 1024, 60, 0, 6396,  6,  107964, 142, 0 }, // [00] 1280 X 1024 @60 [DMT  ]
	{ 0xE8, 0x38, 0x30, 0x60, 0x00, 0x00,    0,        0,            0,        0,    0,  0, 0,    0,  0,       0,   0, 0 }, // [20] ---- X  --- @--	
};

static ULONG RX_ADC_SET_VALUES_VESA[ DEFAULT_MST3367_VESA_SIZE ][ MODESIZE ] = { 
	
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  832,  445 / 1, 160 + 3, 63 + 0,  640,  350, 85, 2, 3783,  3,  31470,  64, 0 }, // [00]  640 X  350 @85 [DMT  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  371 / 1, 144 + 3, 18 + 0,  640,  350, 85, 1, 3153, 10,  25228,  64, 0 }, // [00]  640 X  350 @85 [CVT  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  368 / 1, 144 + 3, 17 + 0,  640,  350, 85, 1, 3128,  3,  25024,  64, 0 }, // [00]  640 X  350 @85 [GTF  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  369 / 1, 112 + 3, 16 + 0,  640,  350, 85, 2, 3136, 10,  25092,  32, 0 }, // [00]  640 X  350 @85 [CVTRB]

	{ 0x30, 0x08, 0x08, 0x30, 0x33, 0x03,  848,  440 / 1, 140 + 0, 26 + 0,  640,  384, 60, 1, 2418, 10,  14701,  48, 0 }, // [01]  496 X  384 @60 [OLD  ]
	{ 0x28, 0x08, 0x08, 0x30, 0x22, 0x02,  608,  403 / 1, 104 + 0, 16 + 0,  640,  384, 60, 1, 2418, 10,  14701,  48, 0 }, // [00]  496 X  384 @60 [CVT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  608,  398 / 1, 104 + 0, 13 + 0,  640,  384, 60, 1, 2388,  3,  14519,  48, 0 }, // [00]  496 X  384 @60 [GTF  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  656,  403 / 1, 112 + 0, 16 + 0,  640,  384, 60, 2, 2418, 10,  15862,  32, 0 }, // [00]  496 X  384 @60 [CVTRB]

	{ 0x30, 0x08, 0x08, 0x30, 0x33, 0x03,  848,  440 / 1, 140 + 0, 26 + 0,  640,  384, 60, 1, 2418, 10,  19344,  64, 0 }, // [01]  640 X  384 @60 [OLD  ]
	{ 0x28, 0x08, 0x08, 0x30, 0x22, 0x02,  800,  403 / 1, 144 + 0, 16 + 0,  640,  384, 60, 1, 2418, 10,  19344,  64, 0 }, // [00]  640 X  384 @60 [CVT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  768,  398 / 1, 128 + 0, 13 + 0,  640,  384, 60, 1, 2388,  3,  18339,  64, 0 }, // [00]  640 X  384 @60 [GTF  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  403 / 1, 112 + 0, 16 + 0,  640,  384, 60, 2, 2418, 10,  19344,  32, 0 }, // [00]  640 X  384 @60 [CVTRB]

	{ 0x30, 0x08, 0x08, 0x30, 0x33, 0x03,  848,  440 / 1, 147 + 3, 40 - 6,  640,  400, 60, 1, 3596,  6,  29339,  64, 0 }, // [02]  640 X  400 @60 [OLD  ] (DEMPA'S NEC PROJECT)
//	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  525 / 1, 144 + 3, 75 + 0,  640,  400, 60, 0, 3150,  2,  25200,  96, 0 }, // [00]  640 X  400 @60 [DMT  ] (SAME AS 640X480X60 DMT)
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  417 / 1, 144 + 3, 14 + 0,  640,  400, 60, 1, 3596,  6,  29339,  64, 0 }, // [00]  640 X  400 @60 [CVT  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  784,  415 / 1, 136 + 3, 14 + 0,  640,  400, 60, 1, 2490,  3,  19521,  64, 0 }, // [00]  640 X  400 @60 [GTF  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  415 / 1, 112 + 3, 12 + 0,  640,  400, 60, 2, 2490,  6,  19920,  32, 0 }, // [00]  640 X  400 @60 [CVTRB]

	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  832,  445 / 1, 160 + 3, 44 + 0,  640,  400, 85, 1, 3783,  3,  31470,  64, 0 }, // [00]  640 X  400 @85 [DMT  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  816,  423 / 1, 152 + 3, 20 + 0,  640,  400, 85, 1, 3596,  6,  29339,  64, 0 }, // [00]  640 X  400 @85 [CVT  ] 
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  816,  421 / 1, 144 +11, 20 + 0,  640,  400, 85, 1, 3578,  3,  29200,  64, 0 }, // [00]  640 X  400 @85 [GTF  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  417 / 1, 112 + 3, 14 + 0,  640,  400, 85, 2, 3544,  6,  28356,  32, 0 }, // [00]  640 X  400 @85 [CVTRB]
																												   
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  936,  446 / 1, 180 + 3, 45 + 0,  720,  400, 85, 1, 3791,  3,  35483,  72, 0 }, // [00]  720 X  400 @85 [DMT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  912,  423 / 1, 168 + 3, 20 + 0,  720,  400, 85, 1, 3596, 10,  32791,  72, 0 }, // [00]  720 X  400 @85 [CVT  ]
//	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  912,  421 / 1, 168 + 3, 20 + 0,  720,  400, 85, 1, 3578,  3,  32635,  64, 0 }, // [00]  720 X  400 @85 [GTF  ] (SAME AS 640X400X85 GTF)
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  880,  419 / 1, 112 + 3, 16 + 0,  720,  400, 85, 2, 3562, 10,  31341,  32, 0 }, // [00]  720 X  400 @85 [CVTRB]
																												   
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  525 / 1, 144 + 0, 35 + 0,  640,  480, 57, 0, 3150,  2,  25200,  96, 0 }, // [00]  640 X  480 @50 [DMT  ]

	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  525 / 1, 144 + 0, 35 + 0,  640,  480, 60, 0, 3150,  2,  25200,  96, 0 }, // [00]  640 X  480 @60 [DMT  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  500 / 1, 144 + 3, 17 + 0,  640,  480, 60, 1, 3000,  4,  24000,  64, 0 }, // [00]  640 X  480 @60 [CVT  ]
//	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  497 / 1, 144 + 0, 16 + 0,  640,  480, 60, 1, 2982,  3,  23856,  64, 0 }, // [00]  640 X  480 @60 [GTF  ] (SAME AS 720X480X60 GTF)
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  494 / 1, 112 + 3, 11 + 0,  640,  480, 60, 2, 2964,  4,  23712,  32, 0 }, // [00]  640 X  480 @60 [CVTRB]
																																	   
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  503 / 1, 154 + 3, 20 + 0,  640,  480, 70, 1, 3622,  4,  29552,  64, 0 }, // [00]  640 X  480 @70 [CVT  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  856,  503 / 1, 152 + 0, 10 + 0,  680,  480, 70, 1, 3521, 10,  30139,  64, 0 }, // [00]  680 X  480 @70 [CVT  ]
																												   
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  832,  520 / 1, 168 + 3, 31 + 0,  640,  480, 72, 0, 3744,  3,  31150,  40, 0 }, // [00]  640 X  480 @72 [DMT  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  816,  503 / 1, 152 + 3, 20 + 0,  640,  480, 72, 1, 3622,  4,  29552,  64, 0 }, // [00]  640 X  480 @72 [CVT  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  816,  501 / 1, 152 + 3, 20 + 0,  640,  480, 72, 1, 3607,  3,  29434,  64, 0 }, // [00]  640 X  480 @72 [GTF  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  497 / 1, 112 + 3, 14 + 0,  640,  480, 72, 2, 3578,  4,  28627,  32, 0 }, // [00]  640 X  480 @72 [CVTRB]
																												   
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  840,  500 / 1, 184 + 3, 19 + 0,  640,  480, 75, 0, 3750,  3,  31500,  64, 0 }, // [00]  640 X  480 @75 [DMT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  816,  504 / 1, 152 + 3, 21 + 0,  640,  480, 75, 1, 3780,  4,  30844,  64, 0 }, // [00]  640 X  480 @75 [CVT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  816,  502 / 1, 152 + 3, 21 + 0,  640,  480, 75, 1, 3765,  3,  30722,  64, 0 }, // [00]  640 X  480 @75 [GTF  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  498 / 1, 112 + 3, 15 + 0,  640,  480, 75, 2, 3735,  4,  29880,  32, 0 }, // [00]  640 X  480 @75 [CVTRB]
																												   
	{ 0x30, 0x08, 0x08, 0x18, 0x33, 0x03,  832,  509 / 1, 136 + 3, 28 + 0,  640,  480, 85, 0, 4326,  3,  35996,  56, 0 }, // [00]  640 X  480 @85 [DMT  ]
	{ 0x30, 0x08, 0x08, 0x18, 0x33, 0x03,  816,  507 / 1, 152 + 3, 24 + 0,  640,  480, 85, 1, 4310,  4,  35165,  64, 0 }, // [00]  640 X  480 @85 [CVT  ] (NOT TEST YET)
	{ 0x30, 0x08, 0x08, 0x18, 0x33, 0x03,  832,  505 / 1, 160 + 3, 24 + 0,  640,  480, 85, 1, 4292,  3,  35713,  64, 0 }, // [00]  640 X  480 @85 [GTF  ] (NOT TEST YET)
	{ 0x30, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  500 / 1, 112 + 3, 17 + 0,  640,  480, 85, 2, 4250,  4,  34000,  32, 0 }, // [00]  640 X  480 @85 [CVTRB]

#if defined(AME_SA7160) || defined(AME_CY3014)
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  858,  526 / 2, 119 + 1, 19 + 0, 1440,  240, 60, 0, 1554,  3,  27847, 136, 0 }, // [04] 1440 X  240 @60 [PS2  ] (PS2.NTSC)
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  858,  526 / 2, 119 + 0, 19 + 0, 1440,  240, 60, 0, 1554, 10,  27847, 136, 0 }, // [04] 1440 X  240 @60 [OLD  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  858,  525 / 2, 119 + 0, 19 + 0, 1440,  240, 60, 1, 1554, 10,  27847, 136, 0 }, // [04] 1440 X  240 @60 [OLD  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1792,  259 / 1, 312 + 0, 16 + 0, 1440,  240, 60, 1, 1554, 10,  27847, 136, 0 }, // [00] 1440 X  240 @60 [CVT  ]

	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  864,  314 / 1, 132 + 0, 23 + 0, 1440,  288, 50, 0, 1535,  3,  27507, 136, 0 }, // [05] 1440 X  288 @50 [PS2  ] (PS2.PAL)
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  864,  625 / 2, 132 + 0, 23 + 0, 1440,  288, 50, 1, 1535, 10,  27507, 136, 0 }, // [05] 1440 X  288 @50 [OLD  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1792,  307 / 1, 312 + 0, 16 + 0, 1440,  288, 50, 1, 1535, 10,  27507, 136, 0 }, // [00] 1440 X  288 @50 [CVT  ]
#else
	{ 0x08, 0x08, 0x08, 0x18, 0x88, 0x04, 1716,  526 / 2, 238 + 0, 15 + 3, 1440,  240, 60, 0, 3146,  3,  27000, 124, 0 }, // [04] 1440 X  240 @60 [PS2  ] (PS2.NTSC)
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  858,  526 / 2, 119 + 0, 19 + 0, 1440,  240, 60, 0, 1554, 10,  27847, 136, 0 }, // [04] 1440 X  240 @60 [OLD  ]
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  858,  525 / 2, 119 + 0, 19 + 0, 1440,  240, 60, 1, 1554, 10,  27847, 136, 0 }, // [04] 1440 X  240 @60 [OLD  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1792,  259 / 1, 312 + 0, 16 + 0, 1440,  240, 60, 1, 1554, 10,  27847, 136, 0 }, // [00] 1440 X  240 @60 [CVT  ]

	{ 0x08, 0x08, 0x08, 0x18, 0x88, 0x04, 1728,  314 / 1, 264 + 0, 23 + 0, 1440,  288, 50, 0, 1535,  3,  27507, 136, 0 }, // [05] 1440 X  288 @50 [PS2  ] (PS2.PAL)
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  864,  625 / 2, 132 + 0, 23 + 0, 1440,  288, 50, 1, 1535, 10,  27507, 136, 0 }, // [05] 1440 X  288 @50 [OLD  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1792,  307 / 1, 312 + 0, 16 + 0, 1440,  288, 50, 1, 1535, 10,  27507, 136, 0 }, // [00] 1440 X  288 @50 [CVT  ]
#endif
	
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  858,  525 / 2, 119 + 0, 18 + 0,  720,  240, 60, 0, 1573,  3,  13500,  62, 1 }, // [04]  720 X  240 @60 (?�京?�正?�信)																				 
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  858,      281, 119 + 0, 18 + 0,  720,  240, 60, 3, 1573,  1,  13500,  62, 1 }, // [04]  720 X  240 @60 (?�京?�正?�信)
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  858,      281, 119 + 0, 18 + 0,  720,  240, 60, 3, 1573,  2,  13500,  62, 1 }, // [04]  720 X  240 @60 (?�京?�正?�信)
	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  858,      281, 119 + 0, 18 + 0,  720,  240, 60, 3, 1573,  3,  13500,  62, 1 }, // [04]  720 X  240 @60 (?�京?�正?�信)

	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  864,  625 / 2, 132 + 0, 22 + 0,  720,  288, 50, 0, 1563,  3,  13500,  62, 1 }, // [05]  720 X  288 @50 (?�京?�正?�信)

	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03,  858,  530 / 1, 122 - 1, 36 + 0,  720,  480, 59, 0, 3147, 13,  27000,  62, 0 }, // [06]  720 X  480 @60 [EIA AS DMT] (河�??�维)
	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03,  858,  525 / 1, 122 - 1, 36 + 0,  720,  480, 60, 0, 3147,  6,  27000,  62, 0 }, // [06]  720 X  480 @60 [EIA AS DMT] (NOT TEST YET)
	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03,  896,  500 / 1, 152 + 3, 17 + 0,  720,  480, 60, 1, 3000, 10,  26880,  64, 0 }, // [00]  720 X  480 @60 [CVT  ]
	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03,  896,  497 / 1, 160 + 3, 16 + 0,  720,  480, 60, 1, 2982,  3,  26718,  72, 0 }, // [00]  720 X  480 @60 [GTF  ]
	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03,  880,  499 / 1, 112 + 3, 16 + 0,  720,  480, 60, 2, 2994, 10,  26347,  32, 0 }, // [00]  720 X  480 @60 [CVTRB]

	{ 0x08, 0x08, 0x08, 0x18, 0x44, 0x04,  922,  625 / 2, 141 + 0, 22 + 0,  768,  288, 50, 1, 1535, 10,  14736,  72, 0 }, // [67]  768 X  288 @50 [OLD  ]
	{ 0x28, 0x08, 0x08, 0x30, 0x22, 0x02,  960,  307 / 1, 168 + 0, 16 + 0,  768,  288, 50, 1, 1535, 10,  14736,  72, 0 }, // [00]  768 X  288 @50 [CVT  ]
																																	   
	{ 0x28, 0x08, 0x08, 0x30, 0x22, 0x02, 1104,  568 / 1, 264 + 0, 42 + 0,  768,  512, 55, 1, 2926, 10,  28089,  72, 0 }, // [69]  768 X  512 @55 [OLD  ]
	{ 0x28, 0x08, 0x08, 0x30, 0x22, 0x02,  960,  532 / 1, 168 + 0, 17 + 0,  768,  512, 55, 1, 2926, 10,  28089,  72, 0 }, // [00]  768 X  512 @55 [CVT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  960,  529 / 1, 176 + 0, 16 + 0,  768,  512, 55, 1, 2909,  3,  27931,  80, 0 }, // [00]  768 X  512 @55 [GTF  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  928,  531 / 1, 112 + 0, 16 + 0,  768,  512, 55, 2, 2920, 10,  27102,  32, 0 }, // [00]  768 X  512 @55 [CVTRB]

	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03, 1088,  517 / 1, 224 + 3, 31 + 0,  848,  480, 60, 3, 3102,  8,  33749, 112, 0 }, // [00]  848 X  480 @60 [DMT  ]
	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03, 1056,  500 / 1, 184 + 3, 17 + 0,  848,  480, 60, 1, 3000,  5,  31680,  80, 0 }, // [00]  848 X  480 @60 [CVT  ]
//	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03, 1056,  497 / 1, 192 + 0, 16 + 0,  848,  480, 60, 1, 2982,  3,  31489,  88, 0 }, // [00]  848 X  480 @60 [GTF  ] (SAME AS 720X480X60 GTF)
	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03, 1008,  494 / 1, 112 + 3, 11 + 0,  848,  480, 60, 2, 2964,  5,  29877,  32, 0 }, // [00]  848 X  480 @60 [CVTRB]

	{ 0x28, 0x08, 0x08, 0x30, 0x33, 0x03, 1056,  500 / 1, 186 + 0, 17 + 0,  848,  480, 60, 1, 3000,  5,  31680,  80, 0 }, // [--]  848 X  480 @60 [OLD  ]
	{ 0x28, 0x08, 0x08, 0x30, 0x22, 0x02, 1056,  500 / 1, 184 + 0, 17 + 0,  848,  480, 60, 1, 3000,  5,  31680,  80, 0 }, // [00]  848 X  480 @60 [CVT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1056,  497 / 1, 192 + 0, 16 + 0,  848,  480, 60, 1, 2982,  3,  31489,  88, 0 }, // [00]  848 X  480 @60 [GTF  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1008,  494 / 1, 112 + 0, 11 + 0,  848,  480, 60, 2, 2964,  5,  29877,  32, 0 }, // [00]  848 X  480 @60 [CVTRB]

	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03, 1024,  525 / 1, 192 + 3, 22 + 0,  800,  500, 75, 1, 3938,  6,  40320,  80, 0 }, // [00]  800 X  500 @75 [CVT  ]
	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03, 1024,  523 / 1, 192 + 3, 22 + 0,  800,  500, 75, 1, 3922,  3,  40166,  80, 0 }, // [00]  800 X  500 @75 [GTF  ]
	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03,  960,  518 / 1, 112 + 3, 15 + 0,  800,  500, 75, 2, 3885,  6,  37296,  32, 0 }, // [00]  800 X  500 @75 [CVTRB]

	{ 0x18, 0x08, 0x08, 0x18, 0x33, 0x03,  864,  625 / 1, 132 - 1, 44 + 0,  720,  576, 50, 0, 3125,  5,  27000,  64, 0 }, // [07]  720 X  576 @50 [EIA AS DMT] (NOT TEST YET)
	{ 0x28, 0x08, 0x08, 0x30, 0x33, 0x03,  896,  596 / 1, 152 + 3, 17 + 0,  720,  576, 50, 1, 2980, 10,  26700,  64, 0 }, // [00]  720 X  576 @50 [CVT  ]
	{ 0x28, 0x08, 0x08, 0x30, 0x33, 0x03,  896,  593 / 1, 160 + 3, 16 + 0,  720,  576, 50, 1, 2965,  3,  26566,  72, 0 }, // [00]  720 X  576 @50 [GTF  ]
	{ 0x28, 0x08, 0x08, 0x30, 0x33, 0x03,  880,  595 / 1, 112 + 3, 16 + 0,  720,  576, 50, 2, 2975, 10,  26180,  32, 0 }, // [00]  720 X  576 @50 [CVTRB]
	{ 0x28, 0x08, 0x08, 0x30, 0x22, 0x02, 1064,  666 / 1, 224 + 0, 28 + 0,  800,  600, 54, 0, 3421,  4,  34483,  80, 0 }, // [68]  800 X  600 @54 [OLD  ]
	{ 0x28, 0x08, 0x08, 0x30, 0x22, 0x02, 1064,  666 / 1, 224 + 0, 28 + 0,  800,  600, 55, 1, 3421,  4,  34483,  80, 0 }, // [68]  800 X  600 @55 [OLD  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1008,  622 / 1, 184 + 0, 19 + 0,  800,  600, 55, 1, 3421,  4,  34483,  80, 0 }, // [00]  800 X  600 @55 [CVT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1008,  620 / 1, 184 + 0, 19 + 0,  800,  600, 55, 1, 3410,  3,  34372,  80, 0 }, // [00]  800 X  600 @55 [GTF  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  960,  616 / 1, 112 + 0, 13 + 0,  800,  600, 55, 2, 3388,  4,  32524,  32, 0 }, // [00]  800 X  600 @55 [CVTRB]

	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  992,  621 / 1, 168 + 2, 18 + 0,  800,  600, 50, 1, 3105,  4,  30801,  72, 0 }, // [00]  800 X  600 @50 [CVT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1008,  618 / 1, 184 + 2, 17 + 0,  800,  600, 50, 1, 3090,  3,  31147,  80, 0 }, // [00]  800 X  600 @50 [GTF  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  960,  615 / 1, 112 + 2, 12 + 0,  800,  600, 50, 2, 3075,  4,  29520,  32, 0 }, // [00]  800 X  600 @50 [CVTRB]

	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1024,  625 / 1, 200 + 3, 24 + 0,  800,  600, 56, 3, 3500,  2,  35840,  72, 0 }, // [00]  800 X  600 @56 [DMT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1008,  623 / 1, 184 + 3, 20 + 0,  800,  600, 56, 1, 3489,  4,  35167,  80, 0 }, // [00]  800 X  600 @56 [CVT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1024,  620 / 1, 192 + 3, 19 + 0,  800,  600, 56, 1, 3472,  3,  35553,  80, 0 }, // [00]  800 X  600 @56 [GTF  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  960,  616 / 1, 112 + 3, 13 + 0,  800,  600, 56, 2, 3450,  4,  33116,  32, 0 }, // [00]  800 X  600 @56 [CVTRB]

	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1024,  636 / 1, 200 + 3, 24 + 0,  800,  600, 56, 0, 3500,  0,  35840,  72, 0 }, // [00]  800 X  600 @56 [DMT  ]
	
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1056,  629 / 1, 216 + 3, 27 + 0,  800,  600, 60, 3, 3768,  1,  39790, 128, 0 }, // [00]  800 X  600 @60 [DMT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1056,  628 / 1, 216 + 3, 27 + 0,  800,  600, 60, 0, 3768,  5,  39790, 128, 0 }, // [00]  800 X  600 @60 [DMT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1056,  628 / 1, 216 + 3, 27 + 0,  800,  600, 60, 0, 3768,  4,  39790, 128, 0 }, // [00]  800 X  600 @60 [DMT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1056,  628 / 1, 216 + 3, 27 + 0,  800,  600, 60, 3, 3768,  4,  39790, 128, 0 }, // [00]  800 X  600 @60 [DMT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1024,  624 / 1, 192 + 3, 21 + 0,  800,  600, 60, 1, 3744,  4,  38338,  80, 0 }, // [00]  800 X  600 @60 [CVT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1024,  622 / 1, 192 + 3, 21 + 0,  800,  600, 60, 1, 3732,  3,  38215,  80, 0 }, // [00]  800 X  600 @60 [GTF  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1024,  631 / 1, 192 + 3, 21 + 0,  800,  600, 60, 0, 3744,  5,  38338,  80, 0 }, // [00]  800 X  600 @60 [CVT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  960,  618 / 1, 112 + 3, 15 + 0,  800,  600, 60, 2, 3708,  4,  35596,  32, 0 }, // [00]  800 X  600 @60 [CVTRB]

	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02, 1040,  666 / 1, 184 + 3, 29 + 0,  800,  600, 72, 3, 4795,  6,  49870, 120, 0 }, // [00]  800 X  600 @72 [DMT  ]
	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02, 1040,  628 / 1, 200 + 3, 25 + 0,  800,  600, 72, 1, 4522,  4,  47024,  80, 0 }, // [00]  800 X  600 @72 [CVT  ]
	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02, 1040,  626 / 1, 200 + 3, 25 + 0,  800,  600, 72, 1, 4507,  3,  46874,  80, 0 }, // [00]  800 X  600 @72 [GTF  ]
	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02,  960,  621 / 1, 112 + 3, 18 + 0,  800,  600, 72, 2, 4471,  4,  42923,  32, 0 }, // [00]  800 X  600 @72 [CVTRB]

	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02, 1056,  625 / 1, 240 + 3, 24 + 0,  800,  600, 75, 3, 4688,  3,  49500,  80, 0 }, // [00]  800 X  600 @75 [DMT  ]
	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02, 1040,  629 / 1, 200 + 2, 26 + 0,  800,  600, 75, 1, 4717,  4,  49062,  80, 0 }, // [00]  800 X  600 @75 [CVT  ]
	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02, 1040,  627 / 1, 200 + 2, 26 + 0,  800,  600, 75, 1, 4703,  3,  48906,  80, 0 }, // [00]  800 X  600 @75 [GTF  ]
	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02,  960,  622 / 1, 112 + 3, 19 + 0,  800,  600, 75, 2, 4665,  4,  44784,  32, 0 }, // [00]  800 X  600 @75 [CVTRB]

	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02,  960,  720 / 1, 112 + 3, 19 + 0,  800,  600, 75, 3, 5400,  4,  44784,  32, 0 }, // [00]  800 X  600 @75 [-----]

	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1048,  631 / 1, 216 + 2, 30 + 0,  800,  600, 84, 3, 5363,  0,  56209,  64, 0 }, // [00]  800 X  600 @84 [DMT  ]

	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1048,  631 / 1, 216 + 2, 30 + 0,  800,  600, 85, 3, 5363,  3,  56209,  64, 0 }, // [00]  800 X  600 @85 [DMT  ]
	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1056,  633 / 1, 208 + 2, 30 + 0,  800,  600, 85, 1, 5381,  4,  56818,  80, 0 }, // [00]  800 X  600 @85 [CVT  ]
	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1056,  630 / 1, 216 + 2, 29 + 0,  800,  600, 85, 1, 5355,  3,  56548,  88, 0 }, // [00]  800 X  600 @85 [GTF  ]
	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02,  960,  625 / 1, 112 + 2, 22 + 0,  800,  600, 85, 2, 5313,  4,  51000,  32, 0 }, // [00]  800 X  600 @85 [CVTRB]

	{ 0x20, 0x08, 0x08, 0x18, 0x33, 0x03, 1120,  654 / 1, 256 + 0, 27 + 0,  832,  624, 75, 1, 4905,  4,  53366,  80, 0 }, // [55]  832 X  624 @75 [OLD  ]
	{ 0x28, 0x08, 0x08, 0x30, 0x22, 0x02, 1088,  654 / 1, 208 + 0, 27 + 0,  832,  624, 75, 1, 4905,  4,  53366,  80, 0 }, // [00]  832 X  624 @75 [CVT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1088,  652 / 1, 216 + 0, 27 + 0,  832,  624, 75, 1, 4890,  3,  53203,  88, 0 }, // [00]  832 X  624 @75 [GTF  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03,  992,  647 / 1, 112 + 0, 20 + 0,  832,  624, 75, 2, 4853,  4,  48136,  32, 0 }, // [00]  832 X  624 @75 [CVTRB]

	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02, 1312,  624 / 1, 248 + 2, 21 + 0, 1024,  600, 60, 1, 3744, 10,  49121, 104, 0 }, // [00] 1024 X  600 @60 [CVT  ]
//	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02, 1312,  622 / 1, 248 + 0, 21 + 0, 1024,  600, 60, 1, 3732,  3,  48963, 104, 0 }, // [00] 1024 X  600 @60 [GTF  ] (SAME AS 800X600X60 GTF)
	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02, 1184,  619 / 1, 112 + 3, 16 + 0, 1024,  600, 60, 2, 3714, 10,  43973,  32, 0 }, // [00] 1024 X  600 @60 [CVTRB]

	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02, 1352,  624 / 1, 248 + 2, 21 + 0, 1064,  600, 60, 1, 3744,  5,  50618, 104, 0 }, // [00] 1064 X  600 @60 [CVT  ]
//	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02, 1368,  622 / 1, 264 + 0, 21 + 0, 1064,  600, 60, 1, 3732,  3,  51053, 112, 0 }, // [00] 1064 X  600 @60 [GTF  ] (SAME AS 800X600X60 GTF)
	{ 0x30, 0x08, 0x08, 0x18, 0x22, 0x02, 1224,  618 / 1, 112 + 3, 15 + 0, 1064,  600, 60, 2, 3708,  5,  45385,  32, 0 }, // [00] 1064 X  600 @60 [CVTRB]

//	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1632,  624 / 1, 304 + 0, 21 + 0, 1280,  600, 60, 1, 3744, 10,  61102, 128, 0 }, // [00] 1280 X  600 @60 [CVT  ] (SAME AS 1024X600X60 CVT)
//	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1648,  622 / 1, 312 + 0, 21 + 0, 1280,  600, 60, 1, 3732,  3,  61503, 128, 0 }, // [00] 1280 X  600 @60 [GTF  ] (SAME AS 800X600X60 GTF)
//	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1440,  619 / 1, 112 + 0, 16 + 0, 1280,  600, 60, 2, 3714, 10,  53481,  32, 0 }, // [00] 1280 X  600 @60 [CVTRB] (SAME AS 1024X600X60 CVTRB)

	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1600,  736 / 1, 288 + 3, 13 + 0, 1280,  720, 30, 1, 2208,  5,  35328, 128, 0 }, // [00] 1280 X  720 @30 [CVT  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1536,  733 / 1, 248 + 3, 12 + 0, 1280,  720, 30, 1, 2199,  3,  33776, 120, 0 }, // [00] 1280 X  720 @30 [GTF  ]
	{ 0x28, 0x08, 0x08, 0x18, 0x33, 0x03, 1440,  734 / 1, 112 + 3, 11 + 0, 1280,  720, 30, 2, 2202,  5,  31708,  32, 0 }, // [00] 1280 X  720 @30 [CVTRB]

	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 1980,  750 / 1, 260 - 1, 25 + 0, 1280,  720, 50, 3, 3750,  5,  74250,  40, 0 }, // [12] 1280 X  720 @50 [EIA AS DMT]
	{ 0x28, 0x08, 0x08, 0x30, 0x33, 0x03, 1632,  744 / 1, 304 + 2, 21 + 0, 1280,  720, 50, 1, 3720,  5,  60710, 128, 0 }, // [00] 1280 X  720 @50 [CVT  ]
    { 0x28, 0x08, 0x08, 0x30, 0x33, 0x03, 1632,  741 / 1, 304 + 2, 20 + 0, 1280,  720, 50, 1, 3705,  3,  60465, 128, 0 }, // [00] 1280 X  720 @50 [GTF  ]
    { 0x28, 0x08, 0x08, 0x30, 0x33, 0x03, 1440,  737 / 1, 112 + 2, 14 + 0, 1280,  720, 50, 2, 3685,  5,  53064,  32, 0 }, // [00] 1280 X  720 @50 [CVTRB]

	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1584, 1956 / 1, 310 + 2, 33 + 0, 1200, 1920, 30, 1, 5868, 10,  92949, 128, 0 }, // [00] 1200 X 1920 @60 [CVT  ]

	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1650,  750 / 1, 260 + 2, 25 + 0, 1280,  720, 60, 3, 4500,  5,  74250,  40, 0 }, // [00] 1280 X  720 @60 [DMT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1664,  748 / 1, 320 + 2, 25 + 0, 1280,  720, 60, 1, 4488,  5,  74680, 128, 0 }, // [00] 1280 X  720 @60 [CVT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1664,  746 / 1, 328 + 2, 25 + 0, 1280,  720, 60, 1, 4476,  3,  74480, 136, 0 }, // [00] 1280 X  720 @60 [GTF  ]
	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1440,  741 / 1, 112 + 2, 18 + 0, 1280,  720, 60, 2, 4446,  5,  64022,  32, 0 }, // [00] 1280 X  720 @60 [CVTRB]
																																	   
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1696,  755 / 1, 336 + 2, 32 + 0, 1280,  720, 75, 1, 5663,  5,  96036, 128, 0 }, // [00] 1280 X  720 @75 [CVT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1696,  752 / 1, 344 + 2, 31 + 0, 1280,  720, 75, 1, 5640,  3,  95654, 136, 0 }, // [00] 1280 X  720 @75 [GTF  ]
	{ 0xA0, 0x08, 0x20, 0x30, 0x11, 0x01, 1440,  746 / 1, 112 + 2, 23 + 0, 1280,  720, 75, 2, 5595,  5,  80568,  32, 0 }, // [00] 1280 X  720 @75 [CVTRB]
																																	   
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1712,  759 / 1, 352 + 2, 36 + 0, 1280,  720, 85, 1, 6451,  5, 110449, 136, 0 }, // [00] 1280 X  720 @85 [CVT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1712,  756 / 1, 352 + 2, 35 + 0, 1280,  720, 85, 1, 6426,  3, 110013, 136, 0 }, // [00] 1280 X  720 @85 [GTF  ]
	{ 0xA0, 0x18, 0x20, 0x30, 0x11, 0x01, 1440,  750 / 1, 112 + 2, 27 + 0, 1280,  720, 85, 2, 6375,  5,  91800,  32, 0 }, // [00] 1280 X  720 @85 [CVTRB]

	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1312,  793 / 1, 248 + 0, 22 + 0, 1024,  768, 50, 1, 3965,  4,  52020, 104, 0 }, // [00] 1024 X  768 @50 [CVT  ]
	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1312,  791 / 1, 248 + 0, 22 + 0, 1024,  768, 50, 1, 3955,  3,  51889, 104, 0 }, // [00] 1024 X  768 @50 [GTF  ]
	{ 0x60, 0x08, 0x08, 0x18, 0x22, 0x02, 1184,  787 / 1, 112 + 0, 16 + 0, 1024,  768, 50, 2, 3935,  4,  46590,  32, 0 }, // [00] 1024 X  768 @50 [CVTRB]
																																	   
	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1344,  806 / 1, 296 + 2, 35 + 0, 1024,  768, 60, 3, 4836,  6,  64995, 136, 0 }, // [00] 1024 X  768 @60 [DMT  ]
	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1344,  802 / 1, 296 + 2, 31 + 0, 1024,  768, 60, 0, 4836,  4,  64995, 136, 0 }, // [00] 1024 X  768 @60 [DMT  ]
	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1344,  806 / 1, 296 + 2, 35 + 0, 1024,  768, 60, 0, 4836,  6,  64995, 136, 0 }, // [00] 1024 X  768 @60 [DMT  ]
	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1328,  798 / 1, 256 + 2, 27 + 0, 1024,  768, 60, 1, 4788,  4,  63584, 104, 0 }, // [00] 1024 X  768 @60 [CVT  ]
	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1328,  812 / 1, 256 + 2, 27 + 0, 1024,  768, 60, 3, 4788,  6,  63584, 104, 0 }, // [00] 1024 X  768 @60 [CVT  ]
	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1344,  795 / 1, 264 + 2, 26 + 0, 1024,  768, 60, 1, 4770,  3,  64108, 104, 0 }, // [00] 1024 X  768 @60 [GTF  ]
	{ 0x60, 0x08, 0x08, 0x18, 0x22, 0x02, 1184,  790 / 1, 112 + 2, 19 + 0, 1024,  768, 60, 2, 4740,  4,  56121,  32, 0 }, // [00] 1024 X  768 @60 [CVTRB]
																																	   
	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1344,  800 / 1, 264 + 0, 29 + 0, 1024,  768, 64, 1, 5120,  4,  68812, 104, 0 }, // [00] 1024 X  768 @64 [CVT  ]
	{ 0x60, 0x08, 0x20, 0x18, 0x22, 0x02, 1344,  800 / 1, 264 + 2, 29 + 0, 1024,  768, 64, 1, 4788,  4,  63584, 104, 0 }, // [00] 1024 X  768 @64 [CVT  ]
																																	   
	{ 0x60, 0x08, 0x20, 0x30, 0x22, 0x02, 1328,  806 / 1, 280 + 2, 35 + 0, 1024,  768, 70, 3, 5642,  0,  74925, 136, 0 }, // [00] 1024 X  768 @70 [DMT  ]
	{ 0x60, 0x08, 0x20, 0x30, 0x22, 0x02, 1328,  806 / 1, 280 + 2, 35 + 0, 1024,  768, 70, 3, 5642,  6,  74925, 136, 0 }, // [00] 1024 X  768 @70 [DMT  ]
	{ 0x60, 0x08, 0x20, 0x30, 0x22, 0x02, 1328,  806 / 1, 280 + 2, 35 + 0, 1024,  768, 70, 0, 5642,  6,  74925, 136, 0 }, // [00] 1024 X  768 @70 [DMT  ]
	{ 0x60, 0x08, 0x20, 0x30, 0x22, 0x02, 1344,  802 / 1, 264 + 2, 31 + 0, 1024,  768, 70, 1, 5614,  4,  75452, 104, 0 }, // [00] 1024 X  768 @70 [CVT  ]
	{ 0x60, 0x08, 0x20, 0x30, 0x22, 0x02, 1360,  800 / 1, 280 + 2, 31 + 0, 1024,  768, 70, 1, 5600,  3,  76160, 112, 0 }, // [00] 1024 X  768 @70 [GTF  ]
	{ 0x60, 0x08, 0x08, 0x18, 0x22, 0x02, 1184,  794 / 1, 112 + 2, 23 + 0, 1024,  768, 70, 2, 5558,  4,  65806,  32, 0 }, // [00] 1024 X  768 @70 [CVTRB]
																																	   
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1312,  800 / 1, 272 + 2, 31 + 0, 1024,  768, 75, 3, 6000,  3,  78720,  96, 0 }, // [00] 1024 X  768 @75 [DMT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1360,  805 / 1, 272 + 2, 34 + 0, 1024,  768, 75, 1, 6038,  4,  82110, 104, 0 }, // [00] 1024 X  768 @75 [CVT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1360,  802 / 1, 280 + 2, 33 + 0, 1024,  768, 75, 1, 6015,  3,  81804, 112, 0 }, // [00] 1024 X  768 @75 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x18, 0x22, 0x02, 1184,  796 / 1, 112 + 2, 25 + 0, 1024,  768, 75, 2, 5970,  4,  70684,  32, 0 }, // [00] 1024 X  768 @75 [CVTRB]

	{ 0xA0, 0x38, 0x20, 0x30, 0x22, 0x02, 1376,  808 / 1, 304 + 2, 39 + 0, 1024,  768, 85, 3, 6868,  3,  94503,  96, 0 }, // [00] 1024 X  768 @85 [DMT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x22, 0x02, 1376,  809 / 1, 276 + 6, 38 + 0, 1024,  768, 85, 1, 6876,  4,  94620, 104, 0 }, // [00] 1024 X  768 @85 [CVT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x22, 0x02, 1376,  807 / 1, 288 + 2, 38 + 0, 1024,  768, 85, 1, 6860,  3,  94386, 112, 0 }, // [00] 1024 X  768 @85 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 1184,  800 / 1, 112 + 2, 29 + 0, 1024,  768, 85, 2, 6800,  4,  80512,  32, 0 }, // [00] 1024 X  768 @85 [CVTRB]
																																	   
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1648,  793 / 1, 312 + 0, 22 + 0, 1280,  768, 50, 1, 3965,  7,  65343, 128, 0 }, // [00] 1280 X  768 @50 [CVT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1648,  791 / 1, 312 + 0, 22 + 0, 1280,  768, 50, 1, 3955,  3,  65178, 128, 0 }, // [00] 1280 X  768 @50 [GTF  ]
	{ 0x60, 0x18, 0x08, 0x30, 0x22, 0x02, 1440,  787 / 1, 112 + 0, 16 + 0, 1280,  768, 50, 2, 3935,  7,  56664,  32, 0 }, // [00] 1280 X  768 @50 [CVTRB]
																																	   
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1664,  798 / 1, 320 + 2, 27 + 0, 1280,  768, 60, 1, 4788,  7,  79672, 128, 0 }, // [00] 1280 X  768 @60 [CVT  ]
//	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1680,  795 / 1, 336 + 0, 26 + 0, 1280,  768, 60, 1, 4770,  3,  80136, 136, 0 }, // [00] 1280 X  768 @60 [GTF  ] (SAME AS 1024X768X60 GTF)
	{ 0x60, 0x18, 0x08, 0x30, 0x22, 0x02, 1440,  790 / 1, 112 + 2, 19 + 0, 1280,  768, 60, 2, 4740,  7,  68256,  32, 0 }, // [00] 1280 X  768 @60 [CVTRB]

	{ 0xA0, 0x38, 0x20, 0x30, 0x22, 0x02, 1696,  805 / 1, 336 + 2, 37 - 3, 1280,  768, 75, 1, 6038,  7, 102396, 128, 0 }, // [00] 1280 X  768 @75 [CVT  ]
//	{ 0xA0, 0x38, 0x20, 0x30, 0x22, 0x02, 1712,  802 / 1, 352 + 0, 33 + 0, 1280,  768, 75, 1, 6015,  3, 102976, 136, 0 }, // [00] 1280 X  768 @75 [GTF  ] (SAME AS 1024X768X75 GTF)
	{ 0xA0, 0x18, 0x20, 0x30, 0x22, 0x02, 1440,  796 / 1, 112 + 2, 25 + 0, 1280,  768, 75, 2, 5970,  7,  85968,  32, 0 }, // [00] 1280 X  768 @75 [CVTRB]
																												   					   
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1712,  809 / 1, 352 + 2, 38 + 0, 1280,  768, 85, 1, 6876,  7, 117725, 136, 0 }, // [00] 1280 X  768 @85 [CVT  ]
//	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1728,  807 / 1, 360 + 0, 38 + 0, 1280,  768, 85, 1, 6860,  3, 118532, 136, 0 }, // [00] 1280 X  768 @85 [GTF  ] (SAME AS 1280X768X85 GTF)
	{ 0xA0, 0x18, 0x20, 0x30, 0x22, 0x02, 1440,  800 / 1, 112 + 2, 29 + 0, 1280,  768, 85, 2, 6800,  7,  97920,  32, 0 }, // [00] 1280 X  768 @85 [CVTRB]
																												   					   
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1744,  793 / 1, 328 + 0, 22 + 0, 1360,  768, 50, 1, 3965,  5,  69149, 136, 0 }, // [00] 1360 X  768 @50 [CVT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1760,  791 / 1, 344 + 0, 22 + 0, 1360,  768, 50, 1, 3955,  3,  69608, 144, 0 }, // [00] 1360 X  768 @50 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 1520,  787 / 1, 112 + 0, 16 + 0, 1360,  768, 50, 2, 3935,  5,  59812,  32, 0 }, // [00] 1360 X  768 @50 [CVTRB]
																												   					   
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1792,  795 / 1, 368 + 2, 24 + 0, 1360,  768, 60, 3, 4770,  6,  85478, 112, 0 }, // [00] 1360 X  768 @60 [DMT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1776,  798 / 1, 344 + 2, 27 + 0, 1360,  768, 60, 1, 4788,  5,  85034, 136, 0 }, // [00] 1360 X  768 @60 [CVT  ]
//	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1776,  795 / 1, 352 + 0, 26 + 0, 1360,  768, 60, 1, 4770,  6,  84715, 144, 0 }, // [00] 1360 X  768 @60 [GTF  ] (SAME AS 1024X768X60 DMT)
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 1520,  790 / 1, 112 + 2, 19 + 0, 1360,  768, 60, 2, 4740,  5,  72048,  32, 0 }, // [00] 1360 X  768 @60 [CVTRB]
																												   
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1752,  793 / 1, 328 + 0, 22 + 0, 1360,  768, 50, 1, 3965, 10,  69466, 136, 0 }, // [00] 1366 X  768 @50 [CVT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1768,  791 / 1, 344 + 0, 22 + 0, 1360,  768, 50, 1, 3955,  3,  69924, 144, 0 }, // [00] 1366 X  768 @50 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 1528,  787 / 1, 112 + 0, 16 + 0, 1360,  768, 50, 2, 3935, 10,  60126,  32, 0 }, // [00] 1366 X  768 @50 [CVTRB]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1792,  798 / 1, 356 + 2, 27 + 0, 1360,  768, 60, 0, 4788,  3,  85801, 143, 0 }, // [00] 1366 X  768 @60 [DMT  ]																											   
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1792,  798 / 1, 356 + 2, 27 + 0, 1360,  768, 60, 3, 4788,  3,  85801, 143, 0 }, // [00] 1366 X  768 @60 [DMT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1500,  800 / 1, 120 - 1, 31 + 0, 1360,  768, 60, 3, 4800,  3,  72000,  56, 0 }, // [00] 1366 X  768 @60 [DMT RB]

//	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1784,  798 / 1, 344 + 0, 27 + 0, 1368,  768, 60, 1, 4788, 10,  85417, 136, 0 }, // [00] 1366 X  768 @60 [CVT  ] (H ACTIVE 1368 NOT EXIST)
//	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1800,  795 / 1, 360 + 0, 26 + 0, 1368,  768, 60, 1, 4770,  3,  85860, 144, 0 }, // [00] 1366 X  768 @60 [GTF  ] (H ACTIVE 1368 NOT EXIST)
//	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 1528,  790 / 1, 112 + 0, 19 + 0, 1368,  768, 60, 2, 4740, 10,  72427,  32, 0 }, // [00] 1366 X  768 @60 [CVTRB] (H ACTIVE 1368 NOT EXIST)
																												   
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1680,  831 / 1, 328 + 1, 28 + 0, 1280,  800, 60, 1, 4986,  6,  83764, 128, 0 }, // [00] 1280 X  800 @60 [CVT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1680,  828 / 1, 336 + 0, 27 + 0, 1280,  800, 60, 1, 4968,  3,  83462, 136, 0 }, // [00] 1280 X  800 @60 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 1440,  823 / 1, 112 + 0, 20 + 0, 1280,  800, 60, 2, 4938,  6,  71107,  32, 0 }, // [00] 1280 X  800 @60 [CVTRB]
																												   					   
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1696,  838 / 1, 336 + 2, 35 + 0, 1280,  800, 75, 1, 6285,  6, 106593, 128, 0 }, // [00] 1280 X  800 @75 [CVT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1712,  835 / 1, 352 + 2, 34 + 0, 1280,  800, 75, 1, 6263,  3, 107214, 136, 0 }, // [00] 1280 X  800 @75 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 1440,  829 / 1, 112 + 2, 26 + 0, 1280,  800, 75, 2, 6217,  6,  89532,  32, 0 }, // [00] 1280 X  800 @75 [CVTRB]
																												   					   
	{ 0xB0, 0x38, 0x20, 0x60, 0x11, 0x01, 1712,  843 / 1, 352 + 2, 40 + 0, 1280,  800, 85, 1, 7165,  6, 122673, 136, 0 }, // [00] 1280 X  800 @85 [CVT  ]
	{ 0xB0, 0x38, 0x20, 0x60, 0x11, 0x01, 1728,  840 / 1, 360 + 2, 39 + 0, 1280,  800, 85, 1, 7160,  3, 123379, 136, 0 }, // [00] 1280 X  800 @85 [GTF  ]
	{ 0xA0, 0x18, 0x20, 0x30, 0x11, 0x01, 1440,  833 / 1, 112 + 2, 30 + 0, 1280,  800, 85, 2, 7081,  6, 101959,  32, 0 }, // [00] 1280 X  800 @85 [CVTRB]
																												   					   
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1520,  897 / 1, 304 + 2, 30 + 0, 1152,  864, 60, 1, 5382,  4,  81806, 120, 0 }, // [00] 1152 X  864 @60 [CVT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1520,  895 / 1, 304 + 2, 30 + 0, 1152,  864, 60, 1, 5370,  3,  81624, 120, 0 }, // [00] 1152 X  864 @60 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 1312,  889 / 1, 112 + 2, 22 + 0, 1152,  864, 60, 2, 5334,  4,  69982,  32, 0 }, // [00] 1152 X  864 @60 [CVTRB]
																																	   
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1600,  900 / 1, 384 + 2, 35 + 0, 1152,  864, 75, 3, 6750,  0, 108000, 128, 0 }, // [00] 1152 X  864 @75 [DMT  ]

	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1600,  900 / 1, 384 + 2, 35 + 0, 1152,  864, 75, 3, 6750,  3, 108000, 128, 0 }, // [00] 1152 X  864 @75 [DMT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1536,  905 / 1, 312 + 2, 38 + 0, 1152,  864, 75, 1, 6788,  4, 104256, 120, 0 }, // [00] 1152 X  864 @75 [CVT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1552,  902 / 1, 328 + 2, 37 + 0, 1152,  864, 75, 1, 6765,  3, 104992, 120, 0 }, // [00] 1152 X  864 @75 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 1312,  895 / 1, 112 + 2, 28 + 0, 1152,  864, 75, 2, 6713,  4,  88068,  32, 0 }, // [00] 1152 X  864 @75 [CVTRB]
																										   
	{ 0xB0, 0x08, 0x20, 0x60, 0x11, 0x01, 1904, 1115 / 2, 384 + 0, 32 + 0, 1440,  540, 50, 1, 2795, 10,  50086, 136, 0 }, // [62] 1440 X  540 @50 [OLD  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1792,  559 / 1, 312 + 0, 16 + 0, 1440,  540, 50, 1, 2795, 10,  50086, 136, 0 }, // [00] 1440 X  900 @50 [CVT  ]
																												   					   
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1872,  929 / 1, 360 + 0, 26 + 0, 1440,  900, 50, 1, 4645,  6,  86954, 144, 0 }, // [00] 1440 X  900 @50 [CVT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1888,  926 / 1, 376 + 0, 25 + 0, 1440,  900, 50, 1, 4630,  3,  87414, 152, 0 }, // [00] 1440 X  900 @50 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 1600,  922 / 1, 112 + 0, 19 + 0, 1440,  900, 50, 2, 4610,  6,  73760,  32, 0 }, // [00] 1440 X  900 @50 [CVTRB]
																												   					   
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1904,  934 / 1, 384 + 2, 31 + 0, 1440,  900, 60, 1, 5604,  6, 106700, 152, 0 }, // [00] 1440 X  900 @60 [CVT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1904,  932 / 1, 384 + 2, 31 + 0, 1440,  900, 60, 1, 5592,  3, 106471, 152, 0 }, // [00] 1440 X  900 @60 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 1600,  926 / 1, 112 + 2, 23 + 0, 1440,  900, 60, 2, 5556,  6,  88896,  32, 0 }, // [00] 1440 X  900 @60 [CVTRB]
																																	   
	{ 0xB0, 0x38, 0x30, 0x60, 0x11, 0x01, 1936,  942 / 1, 400 + 2, 39 + 0, 1440,  900, 75, 1, 7065,  6, 136778, 152, 0 }, // [00] 1440 X  900 @75 [CVT  ]
	{ 0xB0, 0x38, 0x30, 0x60, 0x11, 0x01, 1936,  940 / 1, 400 + 2, 39 + 0, 1440,  900, 75, 1, 7050,  3, 136488, 152, 0 }, // [00] 1440 X  900 @75 [GTF  ]
	{ 0xA0, 0x18, 0x20, 0x30, 0x11, 0x01, 1600,  933 / 1, 112 + 2, 30 + 0, 1440,  900, 75, 2, 6997,  6, 111960,  32, 0 }, // [00] 1440 X  900 @75 [CVTRB]
																												   					   
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 1952,  948 / 1, 408 + 1, 45 + 0, 1440,  900, 85, 1, 8058,  6, 157292, 152, 0 }, // [00] 1440 X  900 @85 [CVT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 1952,  945 / 1, 416 + 1, 44 + 0, 1440,  900, 85, 1, 8032,  3, 156794, 160, 0 }, // [00] 1440 X  900 @85 [GTF  ]
	{ 0xB0, 0x18, 0x20, 0x60, 0x11, 0x01, 1600,  937 / 1, 112 + 2, 34 + 0, 1440,  900, 85, 2, 7964,  6, 127432,  32, 0 }, // [00] 1440 X  900 @85 [CVTRB]
																												   					   
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 2080,  929 / 1, 400 + 0, 26 + 0, 1600,  900, 50, 1, 4645,  5,  96616, 160, 0 }, // [00] 1600 X  900 @50 [CVT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 2096,  926 / 1, 416 + 0, 25 + 0, 1600,  900, 50, 1, 4630,  3,  97044, 168, 0 }, // [00] 1600 X  900 @50 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 1760,  922 / 1, 112 + 0, 19 + 0, 1600,  900, 50, 2, 4610,  5,  81136,  32, 0 }, // [00] 1600 X  900 @50 [CVTRB]
																												   
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1800, 1000 / 1, 176 + 2, 99 + 0, 1600,  900, 60, 3, 6000,  3, 108000,  80, 0 }, // [00] 1600 X  900 @60 [DMTRB]
	{ 0xB0, 0x38, 0x20, 0x30, 0x11, 0x01, 2112,  934 / 1, 424 + 2, 31 + 0, 1600,  900, 60, 1, 5604,  5, 118356, 168, 0 }, // [00] 1600 X  900 @60 [CVT  ]
//	{ 0xB0, 0x38, 0x20, 0x30, 0x11, 0x01, 2128,  932 / 1, 432 + 0, 31 + 0, 1600,  900, 60, 1, 5592,  3, 118997, 168, 0 }, // [00] 1600 X  900 @60 [GTF  ] (SAME AS 1440X900X60 GTF)
	{ 0xA0, 0x18, 0x20, 0x30, 0x11, 0x01, 1760,  926 / 1, 112 + 2, 23 + 0, 1600,  900, 60, 2, 5556,  5,  97785,  32, 0 }, // [00] 1600 X  900 @60 [CVTRB]
																																	   
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1680,  991 / 1, 328 + 0, 28 + 0, 1280,  960, 50, 1, 4955,  4,  83244, 128, 0 }, // [00] 1280 X  960 @50 [CVT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1680,  988 / 1, 336 + 0, 27 + 0, 1280,  960, 50, 1, 4940,  3,  82992, 136, 0 }, // [00] 1280 X  960 @50 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x11, 0x01, 1440,  983 / 1, 112 + 0, 20 + 0, 1280,  960, 50, 2, 4915,  4,  70776,  32, 0 }, // [00] 1280 X  960 @50 [CVTRB]
																												   					   
//	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1800, 1000 / 1, 424 + 0, 39 + 0, 1280,  960, 60, 3, 6000,  3, 108000, 112, 0 }, // [00] 1280 X  960 @60 [DMT  ] (SAME AS 1600X900X60 DMT)
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1696,  996 / 1, 336 + 2, 33 + 0, 1280,  960, 60, 1, 5976,  4, 101353, 128, 0 }, // [00] 1280 X  960 @60 [CVT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1712,  994 / 1, 352 + 2, 33 + 0, 1280,  960, 60, 1, 5964,  3, 102103, 136, 0 }, // [00] 1280 X  960 @60 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x11, 0x01, 1440,  988 / 1, 112 + 2, 25 + 0, 1280,  960, 60, 2, 5928,  4,  85363,  32, 0 }, // [00] 1280 X  960 @60 [CVTRB]
																												   					   
	{ 0xB0, 0x38, 0x30, 0x60, 0x11, 0x01, 1728, 1005 / 1, 360 + 2, 42 + 0, 1280,  960, 75, 1, 7538,  4, 130248, 136, 0 }, // [00] 1280 X  960 @75 [CVT  ]
	{ 0xB0, 0x38, 0x20, 0x60, 0x11, 0x01, 1728, 1002 / 1, 360 + 2, 41 + 0, 1280,  960, 75, 1, 7515,  3, 129859, 136, 0 }, // [00] 1280 X  960 @75 [GTF  ]
	{ 0xA0, 0x18, 0x20, 0x30, 0x11, 0x01, 1440,  995 / 1, 112 + 2, 32 + 0, 1280,  960, 75, 2, 7463,  4, 107460,  32, 0 }, // [00] 1280 X  960 @75 [CVTRB]
																												   					   
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 1728, 1011 / 1, 384 + 2, 50 + 0, 1280,  960, 85, 3, 8593,  3, 148495, 160, 0 }, // [00] 1280 X  960 @85 [DMT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 1728, 1011 / 1, 360 + 2, 48 + 0, 1280,  960, 85, 1, 8593,  4, 148495, 136, 0 }, // [00] 1280 X  960 @85 [CVT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 1744, 1008 / 1, 368 + 2, 47 + 0, 1280,  960, 85, 1, 8568,  3, 149425, 136, 0 }, // [00] 1280 X  960 @85 [GTF  ]
	{ 0xB0, 0x18, 0x20, 0x60, 0x11, 0x01, 1440, 1000 / 1, 112 + 2, 37 + 0, 1280,  960, 85, 2, 8500,  4, 122400,  32, 0 }, // [00] 1280 X  960 @85 [CVTRB]

	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1200, 1057 / 1, 328 + 1, 30 + 0, 1280, 1024, 50, 3, 5285,  3,  88788, 128, 0 }, // [00] 1280 X 1024 @50 [CVT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1680, 1057 / 1, 328 + 1, 30 + 0, 1280, 1024, 50, 1, 5285,  7,  88788, 128, 0 }, // [00] 1280 X 1024 @50 [CVT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 1696, 1054 / 1, 344 + 1, 29 + 0, 1280, 1024, 50, 1, 5270,  3,  89379, 136, 0 }, // [00] 1280 X 1024 @50 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 1440, 1049 / 1, 112 + 0, 22 + 0, 1280, 1024, 50, 2, 5245,  7,  75528,  32, 0 }, // [00] 1280 X 1024 @50 [CVTRB]

	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1688, 1066 / 1, 360 + 1, 41 + 0, 1280, 1024, 60, 3, 6396,  0, 107964, 112, 0 }, // [00] 1280 ? 1024 @60 [DMT  ]

	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1716, 1111 / 1, 384 + 1, 80 + 0, 1280, 1024, 60, 0, 6396,  6, 107964, 142, 0 }, // [00] 1280 X 1024 @60 [DMT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1688, 1066 / 1, 380 + 1, 41 + 0, 1280, 1024, 60, 0, 6396,  3, 107964, 112, 0 }, // [00] 1280 X 1024 @60 [DMT  ] (CODDY USB CAMERA)
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1688, 1066 / 1, 360 + 1, 41 + 0, 1280, 1024, 60, 3, 6396,  3, 107964, 112, 0 }, // [00] 1280 X 1024 @60 [DMT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1712, 1063 / 1, 352 + 0, 36 + 0, 1280, 1024, 60, 1, 6378,  7, 109191, 136, 0 }, // [00] 1280 X 1024 @60 [CVT  ]
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1688, 1065 / 1, 362 + 0, 37 + 0, 1280, 1024, 60, 0, 6360,  2, 108883, 136, 0 }, // [00] 1280 X 1024 @60 [CVT  ] 
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1688, 1065 / 1, 362 + 0, 37 + 0, 1280, 1024, 60, 0, 6360,  0, 108883, 136, 0 }, // [00] 1280 X 1024 @60 [CVT  ] 	
	{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1712, 1060 / 1, 352 + 0, 35 + 0, 1280, 1024, 60, 1, 6360,  3, 108883, 136, 0 }, // [00] 1280 X 1024 @60 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x11, 0x01, 1440, 1054 / 1, 112 + 0, 27 + 0, 1280, 1024, 60, 2, 6324,  7,  91065,  32, 0 }, // [00] 1280 X 1024 @60 [CVTRB]
																												   					   
	{ 0xB0, 0x38, 0x30, 0x60, 0x11, 0x01, 1752, 1063 / 1, 406 + 0, 43 + 0, 1280, 1024, 72, 0, 7704,  7, 133125, 136, 0 }, // [00] 1280 X 1024 @72 [CVT  ] (SIEMENS FLUOROSPOT)
	{ 0xB0, 0x38, 0x30, 0x60, 0x11, 0x01, 1752, 1085 / 1, 406 + 0, 43 + 0, 1280, 1024, 72, 0, 7704,  3, 133125, 136, 0 }, // [00] 1280 X 1024 @72 [CVT  ]
																																	   
	{ 0xB0, 0x38, 0x30, 0x60, 0x11, 0x01, 1688, 1067 / 1, 392 + 1, 41 + 0, 1280, 1024, 75, 3, 7995,  8, 134955, 144, 0 }, // [00] 1280 X 1024 @75 [DMT  ]
	{ 0xB0, 0x38, 0x30, 0x60, 0x11, 0x01, 1688, 1066 / 1, 392 + 1, 41 + 0, 1280, 1024, 76, 3, 7995,  8, 134955, 144, 0 }, // [00] 1280 X 1024 @75 [DMT  ]
	{ 0xB0, 0x38, 0x30, 0x60, 0x11, 0x01, 1688, 1066 / 1, 392 + 1, 41 + 0, 1280, 1024, 76, 3, 7995,  0, 134955, 144, 0 }, // [00] 1280 X 1024 @75 [DMT  ]
	{ 0xB0, 0x38, 0x30, 0x60, 0x11, 0x01, 1688, 1066 / 1, 392 + 1, 41 + 0, 1280, 1024, 75, 3, 7995,  3, 134955, 144, 0 }, // [00] 1280 X 1024 @75 [DMT  ]
	{ 0xB0, 0x38, 0x30, 0x60, 0x11, 0x01, 1728, 1072 / 1, 360 + 1, 45 + 0, 1280, 1024, 75, 1, 8040,  7, 138931, 136, 0 }, // [00] 1280 X 1024 @75 [CVT  ]
	{ 0xB0, 0x38, 0x30, 0x60, 0x11, 0x01, 1728, 1069 / 1, 360 + 1, 44 + 0, 1280, 1024, 75, 1, 8018,  3, 138542, 136, 0 }, // [00] 1280 X 1024 @75 [GTF  ]
	{ 0xA0, 0x18, 0x20, 0x30, 0x11, 0x01, 1440, 1061 / 1, 112 + 1, 34 + 0, 1280, 1024, 75, 2, 7957,  7, 114588,  32, 0 }, // [00] 1280 X 1024 @75 [CVTRB]
																												   					   
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 1728, 1072 / 1, 384 + 1, 47 + 0, 1280, 1024, 85, 3, 9112,  3, 157455, 160, 0 }, // [00] 1280 X 1024 @85 [DMT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 1744, 1078 / 1, 368 + 1, 51 + 0, 1280, 1024, 85, 1, 9163,  7, 159802, 136, 0 }, // [00] 1280 X 1024 @85 [CVT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 1744, 1075 / 1, 368 + 1, 50 + 0, 1280, 1024, 85, 1, 9138,  3, 159358, 136, 0 }, // [00] 1280 X 1024 @85 [GTF  ]
	{ 0xB0, 0x18, 0x30, 0x60, 0x11, 0x01, 1440, 1066 / 1, 112 + 1, 39 + 0, 1280, 1024, 85, 2, 9061,  7, 130478,  32, 0 }, // [00] 1280 X 1024 @85 [CVTRB]
																												   					   
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 4816, 1045 / 1, 872 + 0, 18 + 0, 3840, 1024, 30, 1, 3135, 10, 150981, 384, 0 }, // [00] 3840 X 1024 @30 [CVT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 4832, 1042 / 1, 880 + 0, 17 + 0, 3840, 1024, 30, 1, 3126,  3, 151048, 384, 0 }, // [00] 3840 X 1024 @30 [GTF  ]
	{ 0xb0, 0x18, 0x30, 0x60, 0x11, 0x01, 4000, 1043 / 1, 112 + 0, 16 + 0, 3840, 1024, 30, 2, 3129, 10, 125160,  32, 0 }, // [00] 3840 X 1024 @30 [CVTRB]
																												   
#if defined(AME_PL330B) || defined(AME_PL330A)
	{ 0xA0, 0x38, 0x30, 0x60, 0x11, 0x01, 1864, 1089 / 1, 376 + 2, 36 + 0, 1392, 1050, 60, 1, 6534,  4, 121793, 144, 0 }, // [00] 1400 X 1050 @60 [CVT  ]
//	{ 0xA0, 0x38, 0x30, 0x60, 0x11, 0x01, 1880, 1087 / 1, 392 + 0, 36 + 0, 1392, 1050, 60, 1, 6522,  3, 122613, 152, 0 }, // [00] 1400 X 1050 @60 [GTF  ] (SAME AS 1680X1050X60 GTF)
	{ 0xA0, 0x18, 0x20, 0x30, 0x11, 0x01, 1560, 1080 / 1, 112 + 2, 27 + 0, 1392, 1050, 60, 2, 6480,  4, 101088,  32, 0 }, // [00] 1400 X 1050 @60 [CVTRB]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 1896, 1099 / 1, 392 + 1, 46 + 0, 1392, 1050, 75, 1, 8243,  4, 156277, 144, 0 }, // [00] 1400 X 1050 @75 [CVT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 1896, 1096 / 1, 400 + 1, 45 + 0, 1392, 1050, 75, 1, 8220,  3, 155851, 152, 0 }, // [00] 1400 X 1050 @75 [GTF  ]
	{ 0xB0, 0x18, 0x30, 0x60, 0x11, 0x01, 1560, 1088 / 1, 112 + 2, 35 + 0, 1392, 1050, 75, 2, 8160,  4, 127296,  32, 0 }, // [00] 1400 X 1050 @75 [CVTRB]
#else																																   
	{ 0xA0, 0x38, 0x30, 0x60, 0x11, 0x01, 1864, 1089 / 1, 376 + 2, 36 + 0, 1400, 1050, 60, 1, 6534,  4, 121793, 144, 0 }, // [00] 1400 X 1050 @60 [CVT  ]
//	{ 0xA0, 0x38, 0x30, 0x60, 0x11, 0x01, 1880, 1087 / 1, 392 + 0, 36 + 0, 1400, 1050, 60, 1, 6522,  3, 122613, 152, 0 }, // [00] 1400 X 1050 @60 [GTF  ] (SAME AS 1680X1050X60 GTF)
	{ 0xA0, 0x18, 0x20, 0x30, 0x11, 0x01, 1560, 1080 / 1, 112 + 2, 27 + 0, 1400, 1050, 60, 2, 6480,  4, 101088,  32, 0 }, // [00] 1400 X 1050 @60 [CVTRB]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 1896, 1099 / 1, 392 + 1, 46 + 0, 1400, 1050, 75, 1, 8243,  4, 156277, 144, 0 }, // [00] 1400 X 1050 @75 [CVT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 1896, 1096 / 1, 400 + 1, 45 + 0, 1400, 1050, 75, 1, 8220,  3, 155851, 152, 0 }, // [00] 1400 X 1050 @75 [GTF  ]
	{ 0xB0, 0x18, 0x30, 0x60, 0x11, 0x01, 1560, 1088 / 1, 112 + 2, 35 + 0, 1400, 1050, 75, 2, 8160,  4, 127296,  32, 0 }, // [00] 1400 X 1050 @75 [CVTRB]
#endif

	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 1920, 1116 / 1, 400 + 0, 45 + 0, 1424, 1068, 72, 1, 8035,  4, 154275, 152, 0 }, // [00] 1424 X 1068 @72 [CVT  ]
																												   
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2240, 1089 / 1, 456 + 1, 36 + 0, 1680, 1050, 60, 1, 6534,  6, 146361, 176, 0 }, // [00] 1680 X 1050 @60 [CVT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2256, 1087 / 1, 472 + 1, 36 + 0, 1680, 1050, 60, 1, 6522,  3, 147136, 184, 0 }, // [00] 1680 X 1050 @60 [GTF  ]
	{ 0xB0, 0x18, 0x30, 0x60, 0x11, 0x01, 1840, 1080 / 1, 112 + 0, 28 + 0, 1680, 1050, 60, 2, 6480,  6, 119232,  32, 0 }, // [00] 1680 X 1050 @60 [CVTRB]
																												   
	{ 0x60, 0x18, 0x08, 0x30, 0x22, 0x02, 2400, 1098 / 1, 432 + 1, 15 + 0, 1920, 1080, 24, 1, 2635,  5,  63244, 192, 0 }, // [00] 1920 X 1080 @24 [CVT  ]
	{ 0x60, 0x18, 0x08, 0x30, 0x22, 0x02, 2352, 1095 / 1, 408 + 1, 14 + 0, 1920, 1080, 24, 1, 2628,  3,  61810, 192, 0 }, // [00] 1920 X 1080 @24 [GTF  ]
	{ 0x60, 0x18, 0x08, 0x30, 0x22, 0x02, 2080, 1094 / 1, 112 + 2, 11 + 0, 1920, 1080, 24, 2, 2626,  5,  54612,  32, 0 }, // [00] 1920 X 1080 @24 [CVTRB]
																												   
	{ 0x60, 0x18, 0x08, 0x30, 0x22, 0x02, 2400, 1099 / 1, 432 + 1, 16 + 0, 1920, 1080, 25, 1, 2748,  5,  65940, 192, 0 }, // [00] 1920 X 1080 @25 [CVT  ]
	{ 0x60, 0x18, 0x08, 0x30, 0x22, 0x02, 2368, 1096 / 1, 416 + 1, 15 + 0, 1920, 1080, 25, 1, 2740,  3,  64883, 192, 0 }, // [00] 1920 X 1080 @25 [GTF  ]
	{ 0x60, 0x18, 0x08, 0x30, 0x22, 0x02, 2080, 1094 / 1, 112 + 2, 11 + 0, 1920, 1080, 25, 2, 2735,  5,  56888,  32, 0 }, // [00] 1920 X 1080 @25 [CVTRB]
																												   					   
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 2416, 1102 / 1, 440 + 1, 19 + 0, 1920, 1080, 30, 1, 3306,  5,  79873, 192, 0 }, // [00] 1920 X 1080 @30 [CVT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 2432, 1099 / 1, 448 + 1, 18 + 0, 1920, 1080, 30, 1, 3297,  3,  80183, 192, 0 }, // [00] 1920 X 1080 @30 [GTF  ]
	{ 0x60, 0x18, 0x08, 0x30, 0x22, 0x02, 2080, 1096 / 1, 112 + 2, 13 + 0, 1920, 1080, 30, 2, 3288,  5,  68390,  32, 0 }, // [00] 1920 X 1080 @30 [CVTRB]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2200, 1125 / 1, 192 + 0, 41 + 0, 1920, 1080, 30, 3, 6750,  5,  74850,  44, 0 }, // [00] 1920 X 1080 @30 [DMT  ]
																												   					   
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2544, 1114 / 1, 512 + 1, 31 + 0, 1920, 1080, 50, 1, 5570,  5, 141700, 200, 0 }, // [00] 1920 X 1080 @50 [CVT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2544, 1112 / 1, 512 + 1, 31 + 0, 1920, 1080, 50, 1, 5560,  3, 141446, 200, 0 }, // [00] 1920 X 1080 @50 [GTF  ]
	{ 0xe8, 0x18, 0x38, 0x60, 0x11, 0x01, 2080, 1106 / 1, 112 + 4, 23 + 0, 1920, 1080, 50, 2, 5530,  5, 115024,  32, 0 }, // [00] 1920 X 1080 @50 [CVTRB]
																																	   
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2200, 1117 / 1, 192 + 1, 33 + 0, 1920, 1080, 60, 3, 6750,  6, 148500,  44, 0 }, // [00] 1920 X 1080 @60 [DMT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2200, 1125 / 1, 192 + 1, 41 + 0, 1920, 1080, 60, 3, 6750,  0, 148500,  44, 0 }, // [00] 1920 X 1080 @60 [DMT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2200, 1125 / 1, 192 + 1, 41 + 0, 1920, 1080, 60, 3, 6750,  5, 148500,  44, 0 }, // [00] 1920 X 1080 @60 [DMT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2576, 1120 / 1, 528 + 0, 37 + 0, 1920, 1080, 60, 1, 6720,  5, 173107, 200, 0 }, // [00] 1920 X 1080 @60 [CVT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2576, 1118 / 1, 536 + 0, 37 + 0, 1920, 1080, 60, 1, 6708,  3, 172798, 208, 0 }, // [00] 1920 X 1080 @60 [GTF  ]
	{ 0xE8, 0x18, 0x38, 0xA0, 0x00, 0x00, 2080, 1111 / 1, 112 + 3, 28 + 0, 1920, 1080, 60, 2, 6666,  5, 138652,  32, 0 }, // [00] 1920 X 1080 @60 [CVTRB]
 																												   
//	{ 0x28, 0x08, 0x08, 0x30, 0x33, 0x03, 2544, 1114 / 1, 512 + 0, 28 + 0, 1920, 1080, 60, 4, 5570, 10, 141700, 200, 0 }, // [00] 1920 X  540 @50 [CVT  ] (NO USE)
//	{ 0x28, 0x08, 0x08, 0x30, 0x33, 0x03, 2544, 1112 / 1, 512 + 0, 30 + 0, 1920, 1080, 60, 4, 5560,  2, 141446, 200, 0 }, // [00] 1920 X  540 @50 [GTF  ] (NO USE)
//	{ 0x28, 0x08, 0x08, 0x30, 0x33, 0x03, 2080, 1106 / 1, 112 + 0, 20 + 0, 1920, 1080, 60, 5, 5530, 10, 115024,  32, 0 }, // [00] 1920 X  540 @50 [CVTRB] (NO USE)
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 2640, 1125 / 2, 192 + 0, 20 + 0, 1920,  540, 50, 1, 2795, 10,  67080, 192, 1 }, // [38] 1920 X  540 @50 [OLD  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2400,  559 / 1, 432 + 0, 16 + 0, 1920,  540, 50, 1, 2795, 10,  67080, 192, 1 }, // [00] 1920 X  540 @50 [CVT  ]
																												   					   
//	{ 0x28, 0x08, 0x08, 0x30, 0x33, 0x03, 2576, 1120 / 1, 528 + 0, 34 + 0, 1920, 1080, 60, 4, 6720, 10, 173107, 200, 0 }, // [00] 1920 X  540 @60 [CVT  ] (NO USE)
//	{ 0x28, 0x08, 0x08, 0x30, 0x33, 0x03, 2576, 1118 / 1, 536 + 0, 36 + 0, 1920, 1080, 60, 4, 6708,  2, 172798, 208, 0 }, // [00] 1920 X  540 @60 [GTF  ] (NO USE)
//	{ 0x28, 0x08, 0x08, 0x30, 0x33, 0x03, 2080, 1110 / 1, 112 + 0, 24 + 0, 1920, 1080, 60, 5, 6660, 10, 138528,  32, 0 }, // [00] 1920 X  540 @60 [CVTRB] (NO USE)
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 2200, 1125 / 2, 192 + 0, 20 + 0, 1920,  540, 60, 1, 3372, 10,  82007, 192, 1 }, // [37] 1920 X  540 @60 [old  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2432,  562 / 1, 448 + 0, 19 + 0, 1920,  540, 60, 1, 3372, 10,  82007, 192, 1 }, // [00] 1920 X  540 @60 [CVT  ]
																												   					   
	{ 0xE8, 0x08, 0x08, 0x30, 0x33, 0x03, 2128, 1238 / 1, 432 + 2, 35 + 0, 1600, 1200, 50, 1, 6190,  4, 131723, 168, 0 }, // [00] 1600 X 1200 @50 [CVT  ]
	{ 0xE8, 0x08, 0x08, 0x30, 0x33, 0x03, 2144, 1235 / 1, 440 + 2, 34 + 0, 1600, 1200, 50, 1, 6175,  3, 132392, 168, 0 }, // [00] 1600 X 1200 @50 [GTF  ]
	{ 0x28, 0x08, 0x08, 0x30, 0x33, 0x03, 1760, 1229 / 1, 112 + 0, 26 + 0, 1600, 1200, 50, 2, 6145,  4, 108152,  32, 0 }, // [00] 1600 X 1200 @50 [CVTRB]
																																	   
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2160, 1250 / 1, 496 + 2, 49 + 0, 1600, 1200, 60, 3, 7500,  3, 162000, 192, 0 }, // [00] 1600 X 1200 @60 [DMT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2160, 1245 / 1, 448 + 1, 42 + 0, 1600, 1200, 60, 1, 7470,  4, 161352, 168, 0 }, // [00] 1600 X 1200 @60 [CVT  ]
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2160, 1242 / 1, 456 + 1, 41 + 0, 1600, 1200, 60, 1, 6765,  3, 160963, 176, 0 }, // [00] 1600 X 1200 @60 [GTF  ]
	{ 0xE8, 0x18, 0x30, 0x60, 0x00, 0x00, 1760, 1235 / 1, 112 + 2, 32 + 0, 1600, 1200, 60, 2, 7410,  4, 130416,  32, 0 }, // [00] 1600 X 1200 @60 [CVTRB]

//	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2086, 1265 / 1, 524 + 2, 49 + 0, 1600, 1200, 60, 0, 7540,  3, 162851, 192, 0 }, // [00] 1600 X 1200 @60 [-----]

	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2092, 1265 / 1, 456 + 2, 49 + 0, 1600, 1200, 60, 0, 7500,  3, 162000, 192, 0 }, // [00] 1600 X 1200 @60 [DMT  ]
																																	   
//	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2160, 1250 / 1, 496 + 0, 49 + 0, 1600, 1200, 75, 3, 9375,  3, 202500, 192, 0 }, // [00] 1600 X 1200 @75 [DMT  ] (PCLK TOO HIGH)	
//	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2176, 1255 / 1, 456 + 0, 52 + 0, 1600, 1200, 75, 1, 9413,  4, 204816, 168, 0 }, // [00] 1600 X 1200 @75 [CVT  ] (PCLK TOO HIGH)		
//	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2192, 1253 / 1, 472 + 0, 52 + 0, 1600, 1200, 75, 1, 9397,  3, 205993, 176, 0 }, // [00] 1600 X 1200 @75 [GTF  ] (PCLK TOO HIGH)		
	{ 0xE8, 0x18, 0x30, 0xA0, 0x00, 0x00, 1760, 1243 / 1, 112 + 0, 40 + 0, 1600, 1200, 75, 2, 9322,  4, 164076,  32, 0 }, // [00] 1600 X 1200 @75 [CVTRB]
																																	   
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2496,  748 / 1, 480 + 0, 25 + 0, 1920,  720, 60, 1, 4488,  10, 11202, 192, 0 }, // [00] 1920 X  720 @60 [CVT  ]
																																	   
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 2448, 1224 / 1, 456 + 1, 21 + 0, 1920, 1200, 30, 1, 3672,  6,  89890, 192, 0 }, // [00] 1920 X 1200 @30 [CVT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 2448, 1221 / 1, 456 + 1, 20 + 0, 1920, 1200, 30, 1, 3663,  3,  89670, 192, 0 }, // [00] 1920 X 1200 @30 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 2080, 1217 / 1, 112 + 0, 14 + 0, 1920, 1200, 30, 2, 3651,  6,  75940,  32, 0 }, // [00] 1920 X 1200 @30 [CVTRB]
																												   					   
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 2560, 1238 / 1, 520 + 0, 35 + 0, 1920, 1200, 50, 1, 6190,  6, 158464, 200, 0 }, // [00] 1920 X 1200 @50 [CVT  ]
	{ 0x60, 0x38, 0x20, 0x30, 0x22, 0x02, 2560, 1235 / 1, 528 + 0, 34 + 0, 1920, 1200, 50, 1, 6175,  3, 158080, 208, 0 }, // [00] 1920 X 1200 @50 [GTF  ]
	{ 0x60, 0x18, 0x20, 0x30, 0x22, 0x02, 2080, 1229 / 1, 112 + 0, 26 + 0, 1920, 1200, 50, 2, 6145,  6, 127816,  32, 0 }, // [00] 1920 X 1200 @50 [CVTRB]
																												   					   
	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2592, 1245 / 1, 536 + 1, 42 + 0, 1920, 1200, 60, 1, 7470,  6, 193622, 200, 0 }, // [00] 1920 X 1200 @60 [CVT  ]
//	{ 0xE8, 0x38, 0x30, 0xA0, 0x00, 0x00, 2592, 1242 / 1, 544 + 0, 41 + 0, 1920, 1200, 60, 1, 7452,  3, 193155, 208, 0 }, // [00] 1920 X 1200 @60 [GTF  ] (SAME AS 1920X1200X60 GTF)
	{ 0xE8, 0x18, 0x30, 0xA0, 0x00, 0x00, 2080, 1235 / 1, 112 + 1, 32 + 0, 1920, 1200, 60, 2, 7410,  6, 154128,  32, 0 }, // [00] 1920 X 1200 @60 [CVTRB]

	// EIA MODE
	//
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 3300,  750 / 1, 260 - 1, 25 + 0, 1280,  720, 30, 3, 2250,  5,   74250, 40, 0 }, // [08] 1280 X  720 @30
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 3960,  750 / 1, 260 - 1, 25 + 0, 1280,  720, 25, 3, 1875,  5,   74250, 40, 0 }, // [09] 1280 X  720 @25
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 3300,  750 / 1, 260 - 1, 25 + 0, 1280,  720, 24, 3, 1800,  5,   59400, 40, 0 }, // [10] 1280 X  720 @24
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 2200, 1125 / 2, 192 - 1, 20 + 0, 1920,  540, 60, 3, 3375,  5,   74250, 44, 1 }, // [13] 1920 X  540 @60
	{ 0x58, 0x38, 0x20, 0x30, 0x11, 0x01, 2640, 1125 / 2, 192 - 1, 20 + 0, 1920,  540, 50, 3, 2813,  5,   74250, 44, 1 }, // [14] 1920 X  540 @50
	{ 0xE8, 0x38, 0x30, 0x60, 0x00, 0x00, 2200, 1125 / 1, 192 - 1, 41 + 0, 1920, 1080, 30, 3, 3375,  5,   74250, 44, 0 }, // [15] 1920 X 1080 @30
	{ 0xE8, 0x38, 0x30, 0x60, 0x00, 0x00, 2640, 1125 / 1, 192 - 1, 41 + 0, 1920, 1080, 25, 3, 2815,  5,   74250, 44, 0 }, // [16] 1920 X 1080 @25
	{ 0xE8, 0x38, 0x30, 0x60, 0x00, 0x00, 2750, 1125 / 1, 192 - 1, 41 + 0, 1920, 1080, 24, 3, 2700,  5,   74250, 44, 0 }, // [17] 1920 X 1080 @24
	{ 0xE8, 0x38, 0x30, 0x60, 0x00, 0x00, 2640, 1125 / 1, 192 - 1, 41 + 0, 1920, 1080, 50, 3, 5625,  5,  148500, 44, 0 }, // [19] 1920 X 1080 @50

	{ 0xE8, 0x38, 0x30, 0x60, 0x00, 0x00,    0,        0,       0,      0,    0,    0,  0, 0,    0,  0,      0,   0, 0 }, // [72] ---- X  --- @--
};

BYTE MST3367_GetRegister( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, BYTE nBank, BYTE nIndex )
{
//	return E4353F1BD7E74904BE78DD9F001BD652( pDevice, nBank, nIndex );

	#ifndef AME_PL330A
	if( (pDevice->F9D9594A095F0463193B7588374CF8310->vendor == 0x1131 && pDevice->F9D9594A095F0463193B7588374CF8310->device == 0x7160) )
	{
		return E9FDD7B155AA445A84F2F4493591369B( pDevice, nBank, nIndex );
	}
	else if( (pDevice->F9D9594A095F0463193B7588374CF8310->vendor == 0x3086 && pDevice->F9D9594A095F0463193B7588374CF8310->device == 0x0101) )
	{
		return d9cfcb6942714b3291d4a65a75ba7691_EX2( pDevice, 0x00, 0x9C, nBank, nIndex );
	}
	else if( (pDevice->F9D9594A095F0463193B7588374CF8310->vendor == 0x0907 && pDevice->F9D9594A095F0463193B7588374CF8310->device == 0x0100) )
	{
		return E6FB1249C1F642A38BC0228741149CD8_EX( pDevice, 0x00, 0x9C, nBank, nIndex );
	}
	else if( (pDevice->F9D9594A095F0463193B7588374CF8310->vendor == 0x12AB && pDevice->F9D9594A095F0463193B7588374CF8310->device == 0x0370) )
	{
		return E6FB1249C1F642A38BC0228741149CD8_EX( pDevice, 0x00, 0x9C, nBank, nIndex );
	}
	else if( (pDevice->F9D9594A095F0463193B7588374CF8310->vendor == 0x12AB && pDevice->F9D9594A095F0463193B7588374CF8310->device == 0x0380) )
	{
		return E6FB1249C1F642A38BC0228741149CD8_EX( pDevice, 0x00, 0x9C, nBank, nIndex );
	}
	else if( (pDevice->F9D9594A095F0463193B7588374CF8310->vendor == 0x1AF2 && pDevice->F9D9594A095F0463193B7588374CF8310->device == 0xA001) )
	{
		return C6F39DAE1CE54F0D873113FD657C7FA3( pDevice, 0x00, 0x9C, nBank, nIndex );
	}
	else
	{
		F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "MST3367_GetRegister() error, not implemented for this ID\n" );
		return true;
	}
	#else
		return C6F39DAE1CE54F0D873113FD657C7FA3( pDevice, 0x00, 0x9C, nBank, nIndex );
	#endif

}

BOOLEAN MST3367_SetRegister( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, BYTE nBank, BYTE nIndex, BYTE nValue )
{
//	return C2B253D32391436C99E0206137A018A8( pDevice, nBank, nIndex, nValue );
	
	#ifndef AME_PL330A
	if( (pDevice->F9D9594A095F0463193B7588374CF8310->vendor == 0x1131 && pDevice->F9D9594A095F0463193B7588374CF8310->device == 0x7160) )
	{
		return DFD7C3CC812B44E2A9BDB8C9C6C4BC84( pDevice, nBank, nIndex, nValue );
	}
	else if( (pDevice->F9D9594A095F0463193B7588374CF8310->vendor == 0x3086 && pDevice->F9D9594A095F0463193B7588374CF8310->device == 0x0101) )
	{
		return c944c15a33e6405babe73920d58a1fba_EX( pDevice, 0x00, 0x9C, nBank, nIndex, nValue );
	}
	else if( (pDevice->F9D9594A095F0463193B7588374CF8310->vendor == 0x0907 && pDevice->F9D9594A095F0463193B7588374CF8310->device == 0x0100) )
	{
		return DBF051EEA3B648B49859145F02FA268C_EX( pDevice, 0x00, 0x9C, nBank, nIndex, nValue );
	}
	else if( (pDevice->F9D9594A095F0463193B7588374CF8310->vendor == 0x12AB && pDevice->F9D9594A095F0463193B7588374CF8310->device == 0x0370) )
	{
		return DBF051EEA3B648B49859145F02FA268C_EX( pDevice, 0x00, 0x9C, nBank, nIndex, nValue );
	}
	else if( (pDevice->F9D9594A095F0463193B7588374CF8310->vendor == 0x12AB && pDevice->F9D9594A095F0463193B7588374CF8310->device == 0x0380) )
	{
		return DBF051EEA3B648B49859145F02FA268C_EX( pDevice, 0x00, 0x9C, nBank, nIndex, nValue );
	}
	else if( (pDevice->F9D9594A095F0463193B7588374CF8310->vendor == 0x1AF2 && pDevice->F9D9594A095F0463193B7588374CF8310->device == 0xA001) )
	{
		return F3442C8F4E5244B4852C27C401ED415E( pDevice, 0x00, 0x9C, nBank, nIndex, nValue );
	}
	else
	{
		F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "MST3367_SetRegister() error, not implemented for this ID\n" );
		return true;
	}
	#else
		return F3442C8F4E5244B4852C27C401ED415E( pDevice, 0x00, 0x9C, nBank, nIndex, nValue );
	#endif
}


enum {	RX_TMDS_HPD_OFF   = 0x00,
		
		RX_TMDS_A_HPD_ON  = 0x01,
		
		RX_TMDS_A_LINK_ON = 0x02,
		
		RX_TMDS_B_HPD_ON  = 0x10,
		
		RX_TMDS_B_LINK_ON = 0x20,
};

enum {	AUDIO_MSTAR       = 0x00,

		AUDIO_LINE_IN     = 0x01,
};

#include "MST3367_COLOR_ADJUST.C"

VOID MST3367_READ_HDCP_MASTER_KEY( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice )
{
	if( MST3367_HDCP_KEY[ 5 ] == 0x00 ) {

		MST3367_HDCP_KEY[ 5 ] = 0x01;

		BYTE bksv[ 5 ];

		MST3367_SetRegister( pDevice, 0x01, 0x25, 0x00 ); // SET TO WRITE, 0x74 ADDRESS,

		MST3367_SetRegister( pDevice, 0x01, 0x26, 0x00 ); // ADDRESS SET TO 0

		UINT i = 0;
		for( i = 0 ; i < 5 ; i++ ) {

			//F6B9E557A4BA24ffd926B820B836289C8_100NS( 200000 ); // YOU MUST ADD A 20M SECOND F6B9E557A4BA24ffd926B820B836289C8 
			wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies( 20 ) );

			MST3367_HDCP_KEY[ i ] = MST3367_GetRegister( pDevice, 0x01, 0x27 );
		}
	}
}

BOOLEAN MST3367_HwInitialize( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice )
{

	F1838C0176E054c129B7F2BF440D1236E( KERN_INFO, "[%02d] MST3367_HwInitialize\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE );

	pDevice->m_nAnalogVideoDecoderStatusProperty = 0;

	#ifdef AME_SA7160
	
	SA7160_SYS_CFG * pSysCfg = (SA7160_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

	ULONG R0000E004 = A77C4935F8134B048348571A43F2A9CA( pDevice, 0x0000E000 + 0x0004 ); // GPIO.WR
	
	if( (pDevice->iManufacturer == 0x01 && pDevice->iProduct == 0x07) ||

		(pDevice->iManufacturer == 0x04 && pDevice->iProduct == 0x07) ||
				
		(pDevice->iManufacturer == 0x0A && pDevice->iProduct == 0x07) ||
	
		(pDevice->iManufacturer == 0x10) || 
	
		(pDevice->iManufacturer == 0x16) || 

		(pDevice->iManufacturer == 0x17) ||
		
		(pDevice->iManufacturer == 0x1F) ) {

		R0000E004 |= 0x00020000; // BYPASS.MODE
	}
	else {

		R0000E004 |= 0x00020000; // HDMI.SEL (0 = SDI / 1 = HDMI)
	}

	if( (pDevice->iManufacturer == 0x1F) ) {

		if( pDevice->m_nAnalogCrossbarVideoInputProperty == 0 ||  // HDMI (TMDS.B)

			pDevice->m_nAnalogCrossbarVideoInputProperty == 1 ) { // DVI.DIGITAL (TMDS.A)

			A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 & ~0x00010010 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 500000 ); // GPIO.WR (HARDWARE.RESET)

			A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 |  0x00010010 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 500000 ); // GPIO.WR (HARDWARE.RESET)

			A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 & ~0x00010010 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 500000 ); // GPIO.WR (HARDWARE.RESET)
		}
		else {

			R0000E004 &= ~0x00010000; R0000E004 |=  0x00000010; A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 500000 ); // GPIO.WR (HARDWARE.RESET)

			R0000E004 |=  0x00010000; R0000E004 &= ~0x00000010; A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 500000 ); // GPIO.WR (HARDWARE.RESET)

			R0000E004 &= ~0x00010000; R0000E004 |=  0x00000010; A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 500000 ); // GPIO.WR (HARDWARE.RESET)
		}
	}
	else {

		A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 & ~0x00010000 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 500000 ); // GPIO.WR (HARDWARE.RESET)

		A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 |  0x00010000 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 500000 ); // GPIO.WR (HARDWARE.RESET)

		A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 & ~0x00010000 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 500000 ); // GPIO.WR (HARDWARE.RESET)
	}

	if( pDevice->iManufacturer == 0x01 && pDevice->iProduct == 0x07 ) { FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x20, 0x00 ); }

	if( pDevice->iManufacturer == 0x04 && pDevice->iProduct == 0x07 ) { FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x20, 0x00 ); }

	if( pDevice->iManufacturer == 0x0A && pDevice->iProduct == 0x07 ) { FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x20, 0x00 ); }

	if( pDevice->iManufacturer == 0x10 ) { FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x20, 0x00 ); }

	if( pDevice->iManufacturer == 0x16 ) { FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x20, 0x00 ); }

	if( pDevice->iManufacturer == 0x17 ) { FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x20, 0x00 ); }

	if( (pDevice->iManufacturer == 0x1F) ) { 

		if( pDevice->m_nAnalogCrossbarVideoInputProperty == 0 ||  // HDMI (TMDS.B)

			pDevice->m_nAnalogCrossbarVideoInputProperty == 1 ) { // DVI.DIGITAL (TMDS.A)

			FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x20, 0x01 ); 
		}
		else {
			
			FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x20, 0x00 ); 
		}
	}
	#endif
	
	#ifdef AME_FH8735
	
	FH8735_SYS_CFG * pSysCfg = (FH8735_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

	ULONG R00700000 = d439bfca9ec846ea956d1bf0aa3adc45( pDevice, 1, 0x00700000 + 0x00000000 );

	de288df0e76e4990be34b3bea95ca349( pDevice, 1, 0x00700000 + 0x00000000, R00700000 & ~0x00000100 ); wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies(50) ); // GPIO.WR (HARDWARE.RESET)

	de288df0e76e4990be34b3bea95ca349( pDevice, 1, 0x00700000 + 0x00000000, R00700000 |  0x00000100 ); wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies(50) ); // GPIO.WR (HARDWARE.RESET)

	de288df0e76e4990be34b3bea95ca349( pDevice, 1, 0x00700000 + 0x00000000, R00700000 & ~0x00000100 ); wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies(50) ); // GPIO.WR (HARDWARE.RESET)

	#endif

	#if defined(AME_PL330B) || defined(AME_PL330A)

	PL330B_SYS_CFG * pSysCfg = (PL330B_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

	pSysCfg->n_mst3367_register_bank = -1;

	B98859FFE32A4FC2A1A6B33CBCB91945( pDevice,  2, GPIO_OUTPUT ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 10000 );

	B98859FFE32A4FC2A1A6B33CBCB91945( pDevice, 11, GPIO_OUTPUT ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 10000 );

	B98859FFE32A4FC2A1A6B33CBCB91945( pDevice, 12, GPIO_OUTPUT ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 10000 );

	CBFDDC6395144862ACEDAD3C092FC9A6( pDevice, 2, 1 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 10000 );

	CBFDDC6395144862ACEDAD3C092FC9A6( pDevice, 2, 0 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 10000 );

	CBFDDC6395144862ACEDAD3C092FC9A6( pDevice, 2, 1 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 10000 );

	if( pDevice->iManufacturer == 0xAE ||
		
		pDevice->iManufacturer == 0xAF ) { // POWER.ON/OFF
		
		E057E022AA684160B92E903D99235927( pDevice, 0, 0x88, 0x06, 0x0E );

		E057E022AA684160B92E903D99235927( pDevice, 0, 0x88, 0x1A, 0x40 );

		F163E0DBD4F44FD18730544917C904D1( pDevice, 0, 0x66, 0xFB0F, 0x00AA );

		CBFDDC6395144862ACEDAD3C092FC9A6( pDevice, 2, 1 );
	}
	#endif


	#ifdef AME_MZ0380
	
	MZ0380_SYS_CFG * pSysCfg = (MZ0380_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
	D8735A9140EC43B888E108661E19175A( pDevice, 9, 1 ); wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies(50) );

	D8735A9140EC43B888E108661E19175A( pDevice, 9, 0 ); wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies(50) );

	D8735A9140EC43B888E108661E19175A( pDevice, 9, 1 ); wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies(50) );


	if( pDevice->iManufacturer == 0x55 ||  // SC550N1.MC.FULL	
	
		pDevice->iManufacturer == 0xC5 ) { // SC5C0N1.MC.FULL	

		D8735A9140EC43B888E108661E19175A( pDevice, 2, 0 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 500000 );
	}
	else {

		D8735A9140EC43B888E108661E19175A( pDevice, 8, 0 ); F6B9E557A4BA24ffd926B820B836289C8_100NS( 500000 );
	}

	pSysCfg->n_bank_reg = 0xFF;

	#endif


	pSysCfg->n_input_video_resolution_cx = 0;

	pSysCfg->n_input_video_resolution_cy = 0;

	pSysCfg->n_input_video_resolution_fps = 0;

	pSysCfg->n_input_video_resolution_fps_m = 0;

	pSysCfg->n_input_video_resolution_interleaved = 0;

	pSysCfg->n_input_video_resolution_vbi_F3B543EB6D1C348648C2947A125F64000 = 0;

	pSysCfg->n_input_video_resolution_h_total = 0;

	pSysCfg->n_input_video_resolution_v_total = 0;

	pSysCfg->n_input_video_resolution_hv_polarity = 0;

	pSysCfg->n_input_mode_index = 0xFFFF;
			
	pSysCfg->b_input_video_resolution_spliter_mode = FALSE;

	pSysCfg->b_input_video_resolution_external_sync = FALSE;

	pSysCfg->b_input_video_resolution_vga_period_us_counts = 0;

	pSysCfg->b_input_video_signal_changed = FALSE;

	pSysCfg->n_input_audio_sampling_frequency = 0;

	pSysCfg->n_input_video_resolution_color_colorimetry = 0;

	pSysCfg->n_input_video_resolution_color_range = 0;

	// -----> RxInit()

	// -----> RxTmdsHotPlug()
	//
	MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_HPD_OFF );

	// -----> RxGeneralInit() -----> RxGeneralInitTbl [1.35]
	// 
	MST3367_SetRegister( pDevice, 0x00, 0x41, 0x6F );

	MST3367_SetRegister( pDevice, 0x00, 0xB8, 0x00 );

	// -----> RxTmdsInit() -----> RxTmdsInitTbl [1.35]
	// 
	MST3367_SetRegister( pDevice, 0x01, 0x0F, 0x02 );

	MST3367_SetRegister( pDevice, 0x01, 0x16, 0x30 );

	#ifdef AME_MZ0380
	{ // LOCK PIN OUTPUT

		MST3367_SetRegister( pDevice, 0x00, 0x64, 0x02 );
	
		MST3367_SetRegister( pDevice, 0x00, 0x65, 0xFF );
	
		MST3367_SetRegister( pDevice, 0x00, 0x66, 0x00 );
	
		MST3367_SetRegister( pDevice, 0x00, 0x67, 0x02 );
	}
	#endif
	MST3367_SetRegister( pDevice, 0x01, 0x17, 0x00 );

	MST3367_SetRegister( pDevice, 0x01, 0x18, 0x00 );

	MST3367_SetRegister( pDevice, 0x01, 0x19, 0x00 );
	
	MST3367_SetRegister( pDevice, 0x01, 0x1A, 0x50 );

	BYTE R012A = MST3367_GetRegister( pDevice, 0x01, 0x2A ); R012A &= ~0x07; R012A |= 0x07;

	MST3367_SetRegister( pDevice, 0x01, 0x2A, R012A );

	MST3367_SetRegister( pDevice, 0x02, 0x08, 0x03 );

	// -----> RxHdcpInit() -----> RxHdcpInitTbl [1.35]
	//

#ifdef MEDICAL
//disable HDCP
	MST3367_SetRegister( pDevice, 0x01, 0x24, 0x41 );
#else
//reveice HDCP
	MST3367_SetRegister( pDevice, 0x01, 0x24, 0x40 );
#endif

	MST3367_SetRegister( pDevice, 0x01, 0x25, 0x00 );

	if( MST3367_GetRegister( pDevice, 0x01, 0x24) & 1 ) {

		MST3367_SetRegister( pDevice, 0x01, 0x26, 0x00 );

		int count = 5;
		for( count = 5; count; --count ) {

			MST3367_SetRegister( pDevice, 0x01, 0x27, 0x00 );
		}
	}

	MST3367_SetRegister( pDevice, 0x01, 0x30, 0x80 );

	MST3367_SetRegister( pDevice, 0x01, 0x31, 0x00 );

	MST3367_SetRegister( pDevice, 0x01, 0x32, 0x00 );

	// -----> RxVideoInit() -----> RxVideoInitTbl [1.35]
	//
	MST3367_SetRegister( pDevice, 0x00, 0xB0, 0x14 );

	BYTE R00AE = MST3367_GetRegister( pDevice, 0x00, 0xAE ); R00AE &= ~0x04; R00AE |= 0x04;

	MST3367_SetRegister( pDevice, 0x00, 0xAE, R00AE );

	MST3367_SetRegister( pDevice, 0x00, 0xAD, 0x05 ); // ENABLE LOW.PASS FILTER


	MST3367_SetRegister( pDevice, 0x00, 0xB1, 0xC0 );

	MST3367_SetRegister( pDevice, 0x00, 0xB2, 0x00 );

	MST3367_SetRegister( pDevice, 0x00, 0xB3, 0x00 );

	MST3367_SetRegister( pDevice, 0x00, 0xB4, 0x55 );

	// -----> RxAudioInit() -----> RxAudioInitTbl [1.35]
	// 
	BYTE R00B4 = MST3367_GetRegister( pDevice, 0x00, 0xB4 ); R00B4 &= ~0x03; R00B4 |= 0x00;

	MST3367_SetRegister( pDevice, 0x00, 0xB4, R00B4 );

	MST3367_SetRegister( pDevice, 0x02, 0x01, 0x61 ); // 0x51 -> 0x61

	MST3367_SetRegister( pDevice, 0x02, 0x02, 0xF5 );

	BYTE R0203 = MST3367_GetRegister( pDevice, 0x02, 0x03 ); R0203 &= ~0x02; R0203 |= 0x02;

	MST3367_SetRegister( pDevice, 0x02, 0x03, R0203 );

	MST3367_SetRegister( pDevice, 0x02, 0x04, 0x01 );

	MST3367_SetRegister( pDevice, 0x02, 0x05, 0x00 );

	MST3367_SetRegister( pDevice, 0x02, 0x06, 0x08 );

	MST3367_SetRegister( pDevice, 0x02, 0x1C, 0x1A );

	MST3367_SetRegister( pDevice, 0x02, 0x1D, 0x00 );

	MST3367_SetRegister( pDevice, 0x02, 0x1E, 0x00 );

	MST3367_SetRegister( pDevice, 0x02, 0x1F, 0x00 );

	BYTE R0225 = MST3367_GetRegister( pDevice, 0x02, 0x25 ); R0225 &= ~0xA2; R0225 |= 0xA2;

	MST3367_SetRegister( pDevice, 0x02, 0x25, R0225 );

	///////////////////////////////////////////////////////////////////

	BYTE R0202 = MST3367_GetRegister( pDevice, 0x02, 0x02 ); R0202 &= ~0x80; R0202 |= 0x80;

	MST3367_SetRegister( pDevice, 0x02, 0x02, R0202 );

	BYTE R0207 = MST3367_GetRegister( pDevice, 0x02, 0x07 ); R0207 &= ~0x04; R0207 |= 0x04;

	MST3367_SetRegister( pDevice, 0x02, 0x07, R0207 );

	MST3367_SetRegister( pDevice, 0x02, 0x17, 0xC0 );

	MST3367_SetRegister( pDevice, 0x02, 0x19, 0xFF );

	MST3367_SetRegister( pDevice, 0x02, 0x1A, 0xFF );

	MST3367_SetRegister( pDevice, 0x02, 0x1B, 0xFC );

	MST3367_SetRegister( pDevice, 0x02, 0x20, 0x00 );

	BYTE R0221 = MST3367_GetRegister( pDevice, 0x02, 0x21 ); R0221 &= ~0x03; R0221 |= 0x00;

	MST3367_SetRegister( pDevice, 0x02, 0x21, R0221 );

	MST3367_SetRegister( pDevice, 0x02, 0x22, 0x26 );

	MST3367_SetRegister( pDevice, 0x02, 0x27, 0x00 );

	BYTE R022E = MST3367_GetRegister( pDevice, 0x02, 0x2E ); R022E &= ~0xA1; R022E |= 0xA1;

	MST3367_SetRegister( pDevice, 0x02, 0x2E, R022E );

	// 2016.11.17
	//
	{	BYTE R00AB = MST3367_GetRegister( pDevice, 0x00, 0xAB );

		MST3367_SetRegister( pDevice, 0x00, 0xAB, (R00AB  & 0x80) | 0x15 ); // [2012.05.08] [COLOR.RANGE] 0x15

		BYTE R00AC = MST3367_GetRegister( pDevice, 0x00, 0xAC );

		MST3367_SetRegister( pDevice, 0x00, 0xAC, (R00AC & ~0x3F) | 0x15 ); // [2012.05.08] [COLOR.RANGE] 0x15
	}

	// -----> RxSwitchSource()
	// 
	{	if( pDevice->m_nAnalogCrossbarVideoInputProperty == 0 ||  // HDMI (TMDS.B)

			pDevice->m_nAnalogCrossbarVideoInputProperty == 1 ) { // DVI.DIGITAL (TMDS.A)

			MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_HPD_OFF );

			MST3367_HDCP_RESET( pDevice );

			MST3367_HDMI_RESET( pDevice );

#if defined(AME_PL330B) || defined(AME_PL330A)

			if( (pDevice->m_initData.mpgCodecInitData.BusType == QPHCI_BUS_USB && pDevice->iManufacturer == 0xA1) ||  // PD.PD5A0.MST3367
				
				(pDevice->m_initData.mpgCodecInitData.BusType == QPHCI_BUS_USB && pDevice->iManufacturer == 0xA7) ) { // PD.PD5A0.MST3367

				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x89 );

				MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_A_HPD_ON | RX_TMDS_A_LINK_ON );

				MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
			}
			else if( (pDevice->m_initData.mpgCodecInitData.BusType == QPHCI_BUS_PCI && pDevice->iManufacturer == 0x47) ||  // M2.SC540.MST3363
				
				     (pDevice->m_initData.mpgCodecInitData.BusType == QPHCI_BUS_PCI && pDevice->iManufacturer == 0x4D) ||  // SC542N4.HDMI.MST3363
				
				     (pDevice->m_initData.mpgCodecInitData.BusType == QPHCI_BUS_PCI && pDevice->iManufacturer == 0xA7) ||  // M2.SC5A0.MST3363

				     (pDevice->m_initData.mpgCodecInitData.BusType == QPHCI_BUS_PCI && pDevice->iManufacturer == 0xAD) ) { // SC5A2N4.HDMI.MST3363

				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x89 );

				MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_A_HPD_ON | RX_TMDS_A_LINK_ON );

				MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
			}
			else 
#endif				
			if( (pDevice->iProduct == 0xF5 && pDevice->iManufacturer == 0x07) || // SC502N1.MDIN.HDMI

				(pDevice->iManufacturer == 0x0C) ||  // SC500N1.MC.HDV

				(pDevice->iManufacturer == 0x21) ||  // DARIM.48.SC542N1-L HDV

				(pDevice->iManufacturer == 0x29) ||  // DARIM.43.SC542N2 HDV

				(pDevice->iManufacturer == 0x2D) ||  // DARIM.49.SC542N4 HYBRID.1ST

				(pDevice->iManufacturer == 0x26) ||  // DARIM.48.SC542N6 HYBRID.1ST

				(pDevice->iManufacturer == 0x40) ||  // SC540N1.HDV

				(pDevice->iManufacturer == 0x41) ||  // SC540N1.HDV

				(pDevice->iManufacturer == 0x43) ||  // SC542N2.HDV (60FPS)

				(pDevice->iManufacturer == 0x45) ||  // SC542N1.MC.HDV (60FPS)

				(pDevice->iManufacturer == 0x48) ||  // SC542N1.HDV (60FPS)

				(pDevice->iManufacturer == 0x49) ||  // SC542N4.HDV (60FPS)
				
				(pDevice->iManufacturer == 0x4C) ||  // SC540N1.MC.HDV
				
				(pDevice->iManufacturer == 0xA0) ||  // XX5A0N1.HDV
				
				(pDevice->iManufacturer == 0xA1) ||  // XX5A0N1.HDV
				
				(pDevice->iManufacturer == 0xA3) ||  // SC5A2N2.HDV

				(pDevice->iManufacturer == 0xA5) ||  // SC5A2N1.MC.HDV

				(pDevice->iManufacturer == 0xA8) ||  // SC5A2N1.HDV
				
				(pDevice->iManufacturer == 0xA9) ||  // SC5A2N4.HDV
				
				(pDevice->iManufacturer == 0xAC) ||  // SC5A0N1.MC.HDV
				
				(pDevice->iManufacturer == 0xAE) ||  // UB5A0N1
				
				(pDevice->iManufacturer == 0xAF) ||  // UB5A0N1
				
				(pDevice->iManufacturer == 0x50) ||  // SC550N1.HDV
				
				(pDevice->iManufacturer == 0x55) ||  // SC550N1.MC.FULL			

				(pDevice->iManufacturer == 0x5C) ||  // SC550N1.MC.HDV
				
				(pDevice->iManufacturer == 0xC0) ||  // SC5C0N1.HDV
				
				(pDevice->iManufacturer == 0xC5) ||  // SC5C0N1.MC.FULL			

				(pDevice->iManufacturer == 0xCC) ||  // SC5C0N1.MC.HDV
				
				(pDevice->iManufacturer == 0xCF) ) { // SC5C0N1.HDV

				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x81 );

				MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_A_HPD_ON | RX_TMDS_A_LINK_ON );

				MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
			}
			else if( (pDevice->iProduct == 0x1C && pDevice->iManufacturer == 0xFA) ||  // ELGATO BOARD (SC5C0)
					 (pDevice->iProduct == 0x00 && pDevice->iManufacturer == 0x03) ||  // ELGATO BOARD (SC5C0)
					 (pDevice->iProduct == 0x00 && pDevice->iManufacturer == 0x05) ) { // ELGATO BOARD (SC5C0)

				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x89 );

				MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_B_HPD_ON | RX_TMDS_B_LINK_ON );

				MST3367_AUDIO_SELECT( pDevice, AUDIO_MSTAR );
			}
			else if( pDevice->iManufacturer == 0x5E ||  // ELGATO BOARD (SC5C0)
		
					 pDevice->iManufacturer == 0x5F ||  // SC550N1 M2 HDMI
		
					 pDevice->iManufacturer == 0xCE ||  // ELGATO BOARD (SC5C0)
		
					 pDevice->iManufacturer == 0xCF ) { // SC550N1 M2 HDMI

				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x89 );

				MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_B_HPD_ON | RX_TMDS_B_LINK_ON );

				MST3367_AUDIO_SELECT( pDevice, AUDIO_MSTAR );
			}
			else if( ((pDevice->idVendor == 0x04BB) && (pDevice->idProduct & 0x0FFF) == 0x0543) ||  // IODATA BOARD (UB535)
					 ((pDevice->idVendor == 0x0FD9) && (pDevice->idProduct & 0xFFFF) == 0x004F) ||  // ELGATO BOARD (UB535)
					 ((pDevice->idVendor == 0x0FD9) && (pDevice->idProduct & 0xFFFF) == 0x005E) ||  // ELGATO BOARD (UB535)
					 ((pDevice->idVendor == 0x1164) && (pDevice->idProduct & 0x0FFF) == 0x0536) ||
					 ((pDevice->idVendor == 0x1164) && (pDevice->idProduct & 0x0FFF) == 0x0537) ||
					 ((pDevice->idVendor == 0x1164) && (pDevice->idProduct & 0x0FFF) == 0x0538) ||
				     ((pDevice->idVendor == 0x1164) && (pDevice->idProduct & 0x0FFF) == 0x0535) ) { // ELGATO BOARD (UB535)
	
				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x89 );	//set TMDS input at HDMI, at link A
				
				MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_A_HPD_ON | RX_TMDS_A_LINK_ON );
				
				MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
			}
			else if( (pDevice->iManufacturer == 0x04 && pDevice->iProduct == 0x07) || // EURESYS.SC512N1.DVI.1ST
				
					 (pDevice->iManufacturer == 0x0A && pDevice->iProduct == 0x07) || // EURESYS.SC512N1.DVI.1ST
			
					 (pDevice->iManufacturer == 0x16) ||  // DVI.DIGITAL
				
					 (pDevice->iManufacturer == 0x17) ||  // DVI.DIGITAL
				
					 (pDevice->iManufacturer == 0x1F) ) { // DVI.DIGITAL

				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x81 );

				MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_A_HPD_ON | RX_TMDS_A_LINK_ON );

				MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
			}
			else if( (pDevice->iProduct == 0x75 && pDevice->iManufacturer == 0x81) ) { // ZONKEY.AD.BOARD.CH1

				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x81 );

				MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_A_HPD_ON | RX_TMDS_A_LINK_ON );

				MST3367_AUDIO_SELECT( pDevice, AUDIO_MSTAR );
			}
			else if( (pDevice->iProduct == 0x75 && pDevice->iManufacturer == 0x80) ) { // ZONKEY.AD.BOARD.CH2

				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x89 );

				MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_B_HPD_ON | RX_TMDS_B_LINK_ON );

				MST3367_AUDIO_SELECT( pDevice, AUDIO_MSTAR );
			}
			else if( pDevice->idProduct == 0xF531 ) { // UB-530 DEMPA REV 1.0
		
				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x81 );

				MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_B_HPD_ON | RX_TMDS_B_LINK_ON );

				if( pDevice->m_nAnalogCrossbarAudioInputProperty == 0 ) {

					MST3367_AUDIO_SELECT( pDevice, AUDIO_MSTAR );
				}
				if( pDevice->m_nAnalogCrossbarAudioInputProperty == 1 ) {

					MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
				}
			}
			else if( pDevice->idProduct == 0xF533 ) { // UB-530ST REV 1.1

				if( pDevice->m_nAnalogCrossbarVideoInputProperty == 0 ) { 

					MST3367_SetRegister( pDevice, 0x00, 0x51, 0x81 );

					MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_A_HPD_ON | RX_TMDS_A_LINK_ON );
				}
				if( pDevice->m_nAnalogCrossbarVideoInputProperty == 1 ) { 

					MST3367_SetRegister( pDevice, 0x00, 0x51, 0x89 );

					MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_B_HPD_ON | RX_TMDS_B_LINK_ON );
				}
				if( pDevice->m_nAnalogCrossbarAudioInputProperty == 0 ) {

					MST3367_AUDIO_SELECT( pDevice, AUDIO_MSTAR );
				}
				if( pDevice->m_nAnalogCrossbarAudioInputProperty == 1 ) {

					MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
				}
			}	
			else {

				if( pDevice->m_nAnalogCrossbarVideoInputProperty == 0 ) { 

					MST3367_SetRegister( pDevice, 0x00, 0x51, 0x89 );

					MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_B_HPD_ON | RX_TMDS_B_LINK_ON );
				}
				if( pDevice->m_nAnalogCrossbarVideoInputProperty == 1 ) { 

					MST3367_SetRegister( pDevice, 0x00, 0x51, 0x81 );

					MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_A_HPD_ON | RX_TMDS_A_LINK_ON );
				}
				if( pDevice->m_nAnalogCrossbarAudioInputProperty == 0 ) {

					MST3367_AUDIO_SELECT( pDevice, AUDIO_MSTAR );
				}
				if( pDevice->m_nAnalogCrossbarAudioInputProperty == 1 ) {

					MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
				}
			}
			//wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies(200) );

			MST3367_SetRegister( pDevice, 0x00, 0xB7, 0x00 );

			MST3367_HDMI_INIT( pDevice );
		}
		if( pDevice->m_nAnalogCrossbarVideoInputProperty == 2 ||  // COMPONENT

			pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) { // DVI.ANALOG

			if( (pDevice->iManufacturer == 0x04 && pDevice->iProduct == 0x07) || // EURESYS.SC512N1.DVI.1ST
				
				(pDevice->iManufacturer == 0x0A && pDevice->iProduct == 0x07) || // EURESYS.SC512N1.DVI.1ST

				(pDevice->iManufacturer == 0x16) ||  // DVI.DIGITAL
				
				(pDevice->iManufacturer == 0x17) ||  // DVI.DIGITAL

				(pDevice->iManufacturer == 0x1F) ||  // DVI.DIGITAL

				(pDevice->iManufacturer == 0x21) ||  // DARIM.48.SC542N1-L HDV

				(pDevice->iManufacturer == 0x29) ||  // DARIM.43.SC542N2 HDV

				(pDevice->iManufacturer == 0x2D) ||  // DARIM.49.SC542N4 HYBRID.1ST

				(pDevice->iManufacturer == 0x26) ||  // DARIM.48.SC542N6 HYBRID.1ST

				(pDevice->iManufacturer == 0x40) ||  // SC540N1.HDV

				(pDevice->iManufacturer == 0x41) ||  // SC540N1.HDV

				(pDevice->iManufacturer == 0x42) ||  // SC542N1.FULL

				(pDevice->iManufacturer == 0x43) ||  // SC542N2.HDV (60FPS)

				(pDevice->iManufacturer == 0x45) ||  // SC542N1.MC.HDV (60FPS)

				(pDevice->iManufacturer == 0x47) ||  // SC540N1.M2.HDMI

				(pDevice->iManufacturer == 0x48) ||  // SC542N1.HDV (60FPS)

				(pDevice->iManufacturer == 0x49) ||  // SC542N4.HDV (60FPS)

				(pDevice->iManufacturer == 0x4C) ||  // SC540N1.MC.HDV

				(pDevice->iManufacturer == 0x4D) ||  // SC542N4.HDMI.MST3363

				(pDevice->iManufacturer == 0xA0) ||  // XX5A0N4.HDV

				(pDevice->iManufacturer == 0xA1) ||  // XX5A0N1.HDV

				(pDevice->iManufacturer == 0xA2) ||  // SC5A2N1.FULL

				(pDevice->iManufacturer == 0xA3) ||  // SC5A2N2.HDV

				(pDevice->iManufacturer == 0xA5) ||  // SC5A0N2.MC.HDV

				(pDevice->iManufacturer == 0xA7) ||  // PD5A0N1.HDV (HDMI.ONLY)

				(pDevice->iManufacturer == 0xA7) ||  // SC5A0N1.M2.HDMI

				(pDevice->iManufacturer == 0xA8) ||  // SC5A2N1.HDV

				(pDevice->iManufacturer == 0xA9) ||  // SC5A2N4.HDV

				(pDevice->iManufacturer == 0xAC) ||  // SC5A0N1.MC.HDV
				
				(pDevice->iManufacturer == 0xAD) ||  // SC5A2N4.HDMI.MST3363
				
				(pDevice->iManufacturer == 0xAE) ||  // UB5A0N1
				
				(pDevice->iManufacturer == 0xAF) ||  // UB5A0N1

				(pDevice->iManufacturer == 0x50) ||  // SC550N1.HDV

				(pDevice->iManufacturer == 0x55) ||  // SC550N1.MC.FULL

				(pDevice->iManufacturer == 0x5C) ||  // SC550N1.HDV

				(pDevice->iManufacturer == 0xC0) ||  // SC5C0N1.HDV

				(pDevice->iManufacturer == 0xC5) ||  // SC5C0N1.MC.FULL

				(pDevice->iManufacturer == 0xCC) ||  // SC5C0N1.MC.HDV

				(pDevice->iManufacturer == 0xCF) ) { // SC5C0N1.HDV

				MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_A_HPD_ON | RX_TMDS_A_LINK_ON );
			}
			else if( pDevice->idVendor == 0x05CA && pDevice->idProduct == 0x0901 ) { // RICHO.SC530

				MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_A_HPD_ON | RX_TMDS_B_HPD_ON );
			}
			else {

				MST3367_TMDS_HOT_PLUG( pDevice, RX_TMDS_HPD_OFF );
			}
			MST3367_HDCP_RESET( pDevice );

			MST3367_HDMI_RESET( pDevice );

			#if defined(AME_PL330B) || defined(AME_PL330A)

			if( (pDevice->m_initData.mpgCodecInitData.BusType == QPHCI_BUS_USB && pDevice->iManufacturer == 0xA0) ||  // PD.PD5A0.MST3367
				
				(pDevice->m_initData.mpgCodecInitData.BusType == QPHCI_BUS_USB && pDevice->iManufacturer == 0xAE) ||  // UB.UB5A0.MST3367
				
				(pDevice->m_initData.mpgCodecInitData.BusType == QPHCI_BUS_USB && pDevice->iManufacturer == 0xAF) ||  // UB.UB5A0.MST3367

				(pDevice->iManufacturer == 0x21) ||  // DARIM.48.SC542N1-L HDV

				(pDevice->iManufacturer == 0x26) ||  // DARIM.48.SC542N6 HYBRID.1ST
				
				(pDevice->iManufacturer == 0x42) ||  // SC542N1.FULL

				(pDevice->iManufacturer == 0x48) ||  // SC542N1.HDV

				(pDevice->iManufacturer == 0xA2) ||  // SC5A2N1.FULL

				(pDevice->iManufacturer == 0xA8) ) { // SC5A2N1.HDV

				if( pDevice->m_nAnalogCrossbarVideoInputProperty == 2 ) { 

					//if( pDevice->m_nCustomAnalogVideoDviYCbCrProperty == 1 ) {

						//MST3367_SetRegister( pDevice, 0x00, 0x51, 0x01 );
					//}
					//else {

						MST3367_SetRegister( pDevice, 0x00, 0x51, 0x21 );
					//}
				}
				if( pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) { 

					MST3367_SetRegister( pDevice, 0x00, 0x51, 0x01 );
				}
				MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
			}
			else 
			#endif	
			if( (pDevice->iProduct == 0xF5 && pDevice->iManufacturer == 0x05) ||  // DVI.ANALOG

				(pDevice->iProduct == 0xF5 && pDevice->iManufacturer == 0x06) ) { // COMPONENT

				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x01 );

				MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
			}
			else if( pDevice->iManufacturer == 0x0C ||
				
					 pDevice->iManufacturer == 0x16 ) { // MC.MST3367

				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x01 );

				MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
			}
			else if( (pDevice->iProduct == 0x75 && pDevice->iManufacturer == 0x81) ) { // ZONKEY.AD.BOARD.CH1

				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x01 );

				MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
			}
			else if( (pDevice->iManufacturer == 0x29) ||  // DARIM.43.SC542N2 HDV
				
					 (pDevice->iManufacturer == 0x2D) ||  // DARIM.49.SC542N4 HYBRID.1ST
				
					 (pDevice->iManufacturer == 0x40) ||  // SC540N1.FULL

					 (pDevice->iManufacturer == 0x41) ||  // SC540N1.HDV

					 (pDevice->iManufacturer == 0x43) ||  // SC542N2.HDV (60FPS)

					 (pDevice->iManufacturer == 0x45) ||  // SC542N1.MC.HDV (60FPS)

					 (pDevice->iManufacturer == 0x47) ||  // SC540N1.M2.HDMI

					 (pDevice->iManufacturer == 0x49) ||  // SC542N4.HDV (60FPS)

					 (pDevice->iManufacturer == 0x4C) ||  // SC540N1.MC.HDV

					 (pDevice->iManufacturer == 0x4D) ||  // SC542N4.HDMI.MST3363

					 (pDevice->iManufacturer == 0xA0) ||  // XX5A0N1.FULL

					 (pDevice->iManufacturer == 0xA1) ||  // XX5A0N1.HDV

					 (pDevice->iManufacturer == 0xA3) ||  // SC5A2N2.HDV

					 (pDevice->iManufacturer == 0xA5) ||  // SC5A2N1.MC.HDV

					 (pDevice->iManufacturer == 0xA7) ||  // PD5A0N1.HDV (HDMI.ONLY)

					 (pDevice->iManufacturer == 0xA7) ||  // SC5A0N1.M2.HDMI

					 (pDevice->iManufacturer == 0xA9) ||  // SC5A2N4.HDV

					 (pDevice->iManufacturer == 0xAC) ||  // SC5A0N1.MC.HDV

					 (pDevice->iManufacturer == 0xAD) ||  // SC5A2N4.HDMI.MST3363

					 (pDevice->iManufacturer == 0xAE) ||  // UB5A0N1

					 (pDevice->iManufacturer == 0xAF) ||  // UB5A0N1

					 (pDevice->iManufacturer == 0x50) ||  // SC550N1.HDV

					 (pDevice->iManufacturer == 0x55) ||  // SC550N1.MC.FULL

					 (pDevice->iManufacturer == 0x5C) ||  // SC550N1.MC.HDV

					 (pDevice->iManufacturer == 0xC0) ||  // SC5C0N1.HDV

					 (pDevice->iManufacturer == 0xC5) ||  // SC5C0N1.MC.FULL

					 (pDevice->iManufacturer == 0xCC) ||  // SC5C0N1.MC.HDV

					 (pDevice->iManufacturer == 0xCF) ) { // SC5C0N1.HDV.WHQL

				MST3367_SetRegister( pDevice, 0x00, 0x51, 0x01 );

				MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
			}
			else {

				if( pDevice->m_nAnalogCrossbarVideoInputProperty == 2 ) { 

					//if( pDevice->m_nCustomAnalogVideoDviYCbCrProperty == 1 ) { 

					//	MST3367_SetRegister( pDevice, 0x00, 0x51, 0x01 );
					//}
					//else {

						MST3367_SetRegister( pDevice, 0x00, 0x51, 0x21 );
					//}
					MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
				}
				if( pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) { 

					MST3367_SetRegister( pDevice, 0x00, 0x51, 0x01 );

					MST3367_AUDIO_SELECT( pDevice, AUDIO_LINE_IN );
				}
			}
			MST3367_ADC_INIT( pDevice );
		}
	}

	#if defined(AME_PL330B) || defined(AME_PL330A)
	{ 
		
		MST3367_SetRegister( pDevice, 0x00, 0xB5, 0x0C ); // FIXED VESA 1920X1080P@60FPS H&V SYNC UNLOCK ISSUE

		F163E0DBD4F44FD18730544917C904D1( pDevice, 0, 0x66, 0xFA06, 0x00AA ); // VID.SEL
		
		F163E0DBD4F44FD18730544917C904D1( pDevice, 0, 0x66, 0xFA07, 0x00AA ); // I2S.SEL

		B6DA6D73E4484C36B5A7CF9DFE4BBFB0( pDevice, 1, 0 ); 
	}
	#endif
	

	if( pDevice->m_nAnalogCrossbarVideoInputProperty == 2 || 
			
		pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) {

		F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "MST3367 F6B9E557A4BA24ffd926B820B836289C8\n" ); wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies( 1000 ) );

	}
	else
	{
		F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "MST3367 F6B9E557A4BA24ffd926B820B836289C8\n" ); wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies( 100 ) );
	}

	F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] MST3367_HwInitialize() success\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE );

	return TRUE;
}

ULONG MST3367_GET_FREQV( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice )
{
    WORD vperiod = 0;
	
	WORD vfreq = 0;

	ULONG m = 0;

	if( pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) { // DVI.ANALOG

		return 0;
	}
    vperiod = MST3367_GetRegister( pDevice, 0x00, 0x59 ) & 0x3F;
	
    vperiod = (vperiod << 8) + MST3367_GetRegister( pDevice, 0x00, 0x5A );
	
	if( vperiod > 0 ) {

		vfreq = (WORD)(1250000L / (DWORD)(vperiod));
	}
	if( vfreq > 1190 && vfreq < 1210 ) {

		if( vperiod <= 1042 ) {

			vfreq = 1200;
		}
		else {

			vfreq = 1199; m = 1;	
		}
	}
	if( vfreq > 990 && vfreq < 1010 ) { vfreq = 1000; }

	if( vfreq > 840 && vfreq < 860 ) { vfreq = 850;	}

	if( vfreq > 740 && vfreq < 760 ) { vfreq = 750;	}

	if( vfreq > 710 && vfreq < 730 ) { vfreq = 720;	}	

	if( vfreq > 690 && vfreq < 709 ) { vfreq = 700;	}

	if( vfreq > 590 && vfreq < 610 ) {

		if( vperiod < 2086 ) {

			vfreq = 600;
		}
		else {

			vfreq = 599; m = 1;
		}
	}
	if( vfreq > 550 && vfreq < 560 ) { vfreq = 560;	}

	if( vfreq > 490 && vfreq < 510 ) { vfreq = 500;	}		

	if( vfreq > 240 && vfreq < 260 ) { vfreq = 250;	}	

	if( vfreq > 235 && vfreq < 245 ) {

		if( vperiod > 5216 ) {

			vfreq = 239; m = 1;
		}
		else {

			vfreq = 240;
		}
	}
	if( vfreq > 290 && vfreq < 310 ) {

		if( vperiod > 4173 ) {

			vfreq = 299; m = 1;
		}
		else {

			vfreq = 300;
		}
	}
	return m;

//	if( vperiod == 0 ) {
//		
//		return 0;
//	}		
//	return vfreq;
}

ULONG MST3367_ADC_AUTO_PHASE( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice )
{

	#ifdef AME_SA7160
	
	SA7160_SYS_CFG * pSysCfg = (SA7160_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

	#endif

	#ifdef AME_FH8735
	
	FH8735_SYS_CFG * pSysCfg = (FH8735_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
	#endif

	#if defined(AME_PL330B) || defined(AME_PL330A)
	
	PL330B_SYS_CFG * pSysCfg = (PL330B_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
	#endif

	#ifdef AME_MZ0380
	
	MZ0380_SYS_CFG * pSysCfg = (MZ0380_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
	#endif


	if( pDevice->m_nAnalogCrossbarVideoInputProperty != 2 &&
		
		pDevice->m_nAnalogCrossbarVideoInputProperty != 3 ) { 

		return 0;
	}
	if( (pDevice->m_nCustomAnalogVideoAutoPhaseTypeProperty[ 0 ] & 0x80000000) == 0x00000000 ) {

		ULONG j = pDevice->m_nCustomAnalogVideoAutoPhaseTypeProperty[ 0 ] & 0x3FFFFFFF;

		MST3367_SetRegister( pDevice, 0x00, 0x04, (BYTE)(j << 2) );

		F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "MST3367_ADC_AUTO_PHASE( %d )\n", j );

		return j;
	}

	ULONG n_good_phase_res = 0x00000000;

	ULONG j = 0;

	BYTE R1E = MST3367_GetRegister( pDevice, 0x00, 0x1E ); 

	BYTE R1F = MST3367_GetRegister( pDevice, 0x00, 0x1F ); 
	
	MST3367_SetRegister( pDevice, 0x00, 0x1E, 0x00 );

	MST3367_SetRegister( pDevice, 0x00, 0x1F, 0x00 );

	MST3367_SetRegister( pDevice, 0x00, 0xE0, 0x00 );

	// -----> RxAdcAutoPhase() [1.35]
	//
	ULONG i = 0;
	for( i = 0 ; i < 65 ; i += 4 ) {

		ULONG n_phase_res = 0;

		MST3367_SetRegister( pDevice, 0x00, 0x04, (BYTE)((i % 64) << 2) );

		MST3367_SetRegister( pDevice, 0x00, 0xE0, 0x80 );

		wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies( 5 ) );

		MST3367_SetRegister( pDevice, 0x00, 0xE0, 0x40 );

		n_phase_res += (((ULONG)(MST3367_GetRegister( pDevice, 0x00, 0xE9 ) & 0x03)) << 24) +

					   (((ULONG)(MST3367_GetRegister( pDevice, 0x00, 0xE8 ) & 0xFF)) << 16) +

					   (((ULONG)(MST3367_GetRegister( pDevice, 0x00, 0xE7 ) & 0xFF)) <<  8) +

					   (((ULONG)(MST3367_GetRegister( pDevice, 0x00, 0xE6 ) & 0xFF)) <<  0);

		F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "MST3367_ADC_AUTO_PHASE( %02d -> %02d )", i, n_phase_res );




		if( i == 0 ) { continue ; }

		if( n_phase_res > n_good_phase_res ) {

			n_good_phase_res = n_phase_res;

			j = (i % 64);
		}
	}
	MST3367_SetRegister( pDevice, 0x00, 0xE0, 0x00 );

	MST3367_SetRegister( pDevice, 0x00, 0x1E, R1E );

	MST3367_SetRegister( pDevice, 0x00, 0x1F, R1F );

	MST3367_SetRegister( pDevice, 0x00, 0x04, (BYTE)(j << 2) );

	pSysCfg->n_input_video_good_adc_phase = j;

	F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "MST3367_ADC_AUTO_PHASE( %d )\n", j );


	return j;

}

BOOLEAN MST3367_ADC_INIT( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice )
{
	#ifdef AME_SA7160
	
	SA7160_SYS_CFG * pSysCfg = (SA7160_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

	#endif

	#ifdef AME_FH8735
	
	FH8735_SYS_CFG * pSysCfg = (FH8735_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
	#endif

	#if defined(AME_PL330B) || defined(AME_PL330A)
	
	PL330B_SYS_CFG * pSysCfg = (PL330B_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
	#endif

	#ifdef AME_MZ0380
	
	MZ0380_SYS_CFG * pSysCfg = (MZ0380_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
	#endif


	// -----> RxAdcInit() [1.35]
	//
	MST3367_SetRegister( pDevice, 0x00, 0x00, 0x80 );

	MST3367_SetRegister( pDevice, 0x00, 0x24, 0xC0 );

	MST3367_SetRegister( pDevice, 0x00, 0x00, 0x00 );

	BYTE R0021 = MST3367_GetRegister( pDevice, 0x00, 0x21 ); R0021 &= ~0x07; R0021 |= 0x01;

	MST3367_SetRegister( pDevice, 0x00, 0x21, R0021 );

	MST3367_SetRegister( pDevice, 0x00, 0x04, (BYTE)(pSysCfg->n_input_video_good_adc_phase << 2) );

	// [2014.01.13] [PATCH PROGRAM]
	//
	BYTE R0010 = MST3367_GetRegister( pDevice, 0x00, 0x10 ); R0010 &= 0x0F; R0010 |= 0xD0;

	MST3367_SetRegister( pDevice, 0x00, 0x10, R0010 );

	MST3367_SetRegister( pDevice, 0x00, 0x11, 0x2D );

	MST3367_SetRegister( pDevice, 0x00, 0x20, 0xC0 );

	MST3367_SetRegister( pDevice, 0x00, 0x21, 0x04 );

	// [2011.11.15] [PATCH PROGRAM]
	//
	BYTE R000E = MST3367_GetRegister( pDevice, 0x00, 0x0E ); R000E &= 0xCF;  R000E |= 0x20;

	if( pDevice->m_nAnalogCrossbarVideoInputProperty == 2 ) { // COMPONENT

		MST3367_SetRegister( pDevice, 0x00, 0x0E, R000E | 0x10 ); // SOG
	}
	if( pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) { // DVI.ANALOG

		MST3367_SetRegister( pDevice, 0x00, 0x0E, R000E | 0x00 ); // HSYNC
	}

	return TRUE;
}

ULONGLONG MST3367_ADC_MODE_DETECT( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, ULONG* n_h_period_us, ULONG* n_v_period_us, ULONG* nHTotal, ULONG* nVTotal, ULONG* nHPeriod, ULONG* nVPeriod, ULONG* nDetectDelay )
{
	#ifdef AME_SA7160
	
	SA7160_SYS_CFG * pSysCfg = (SA7160_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

	#endif

	#ifdef AME_FH8735
	
	FH8735_SYS_CFG * pSysCfg = (FH8735_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
	#endif

	#if defined(AME_PL330B) || defined(AME_PL330A)
	
	PL330B_SYS_CFG * pSysCfg = (PL330B_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
	#endif

	#ifdef AME_MZ0380
	
	MZ0380_SYS_CFG * pSysCfg = (MZ0380_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
	#endif

	// -----> RxAdcModeDetect() [1.35]

	MST3367_SetRegister( pDevice, 0x00, 0x0E, 0x40 ); // SOG

	//
	BYTE status = 0x00;

	BYTE R0014 = MST3367_GetRegister( pDevice, 0x00, 0x14 );

	BYTE R0015 = MST3367_GetRegister( pDevice, 0x00, 0x15 );

	if( ((R0014 & 0x80) == 0x80) && ((R0014 & 0x10) == 0x10) ) { status = 1; } // SEP H V

	if( ((R0014 & 0x80) == 0x80) && ((R0014 & 0x10) == 0x00) ) { status = 2; } // COMPOSITE 

	if( ((R0014 & 0x80) == 0x00) && ((R0014 & 0x10) == 0x00) && ((R0015 & 0x40) == 0x40) && ((R0014 & 0x2) == 0x2) ) { 

		status = 3; // SOG
	} 
	if( ((R0014 & 0x80) == 0x00) && ((R0014 & 0x10) == 0x00) && ((R0015 & 0x40) == 0x00) && ((R0014 & 0x2) == 0x2) ) { 

		status = 3; // SOG, but vsync fail
	}
	if( status > 0 ) {

		ULONG R0057 = MST3367_GetRegister( pDevice, 0x00, 0x57 ) & 0x3F;

		ULONG R0058 = MST3367_GetRegister( pDevice, 0x00, 0x58 ) & 0xFF;

		ULONG hperiod_us = (R0057 << 8) | (R0058 << 0);
		
//daniel, 2015, set the VSYNC sep threshold for SOG or composite sync case
		if( status == 2 || status == 3 ) {
			
			if(hperiod_us <= 8*128)
				hperiod_us = 8*128;
			//daniel, 2015, set the vertical sync seperation threshold
			MST3367_SetRegister(pDevice, 0x00, 0x11, (BYTE)(hperiod_us/128));

			F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "SOG/CS detected, H period = %d(us), VSYNC sep threshold = 0x%x \n", hperiod_us, (BYTE)(hperiod_us/128));
		}

		ULONG R0059 = MST3367_GetRegister( pDevice, 0x00, 0x59 ) & 0x3F;

		ULONG R005A = MST3367_GetRegister( pDevice, 0x00, 0x5A ) & 0xFF;

		ULONG R005B = MST3367_GetRegister( pDevice, 0x00, 0x5B ) & 0x07;

		ULONG R005C = MST3367_GetRegister( pDevice, 0x00, 0x5C ) & 0xFF;

		ULONG R005D = MST3367_GetRegister( pDevice, 0x00, 0x5D ) & 0xFF;

		ULONG R005E = MST3367_GetRegister( pDevice, 0x00, 0x5E ) & 0xE0;

		ULONG R005F = MST3367_GetRegister( pDevice, 0x00, 0x5F ) & 0x02;

		ULONG vperiod_us = (R0059 << 8) | (R005A << 0);

		ULONGLONG wx = (((R0057 << 8) | (R0058 << 0)) > 0) ? ((1600000) / ((R0057 << 8) | (R0058 << 0))) : (0); // H.TOTAL (H.FREQ)

		ULONGLONG cx = (((R005D << 4) | (R005E >> 4))); // H.TOTAL

		//peter fix !!!!!!!!!!
		#if defined(AME_PL330B) || defined(AME_PL330A)
		if( cx == 1400 )
		{
			cx = 1392;
		}
		#endif

		ULONGLONG wy = (((R005B << 8) | (R005C << 0))); // V.TOTAL

		ULONGLONG fv = (((R0059 << 8) | (R005A << 0)) > 0) ? ((1250000) / ((R0059 << 8) | (R005A << 0))) : (0); // V.FREQUENCY (V.FREQ)

		ULONGLONG cs = (R005F & 0x02) ? 1 : 0; // I / P

		//peter fix !!!!!!!!!!
		//peter add to make sure it is interlace
		if( cs )
		{
			int i = 0;
			for( i = 0 ; i < 3 ; i ++ ) {
				
				R005F = MST3367_GetRegister( pDevice, 0x00, 0x5F ) & 0x02;

				cs = (R005F & 0x02) ? 1 : 0; // I / P

				if( !cs ) { // progressive
				
					break;
				}
			}
		}
		cs |= (R0014 & 0x04) >> 1; // cs BIT1 as H sync polarity, 1 = positive
		
		cs |= (R0014 & 0x20) >> 3; // cs BIT2 as V sync polarity, 1 = positive

		*n_h_period_us = hperiod_us;

		*n_v_period_us = vperiod_us;

		*nHTotal = (wx > 0) ? (ULONG)(((1650000 / ((ULONG)wx)) / 8) * 8) : (0);

		*nVTotal = (hperiod_us > 0) ? (ULONG)((vperiod_us * 16 * 80 + (hperiod_us / 2)) / hperiod_us) : (0);

		*nHPeriod = (ULONG)(wx);

		*nVPeriod = (ULONG)(fv);

		*nDetectDelay = (R0059 << 8) | (R005A << 0);

		*nDetectDelay = ((*nDetectDelay + 63) * 2) / (125); // unit : ms

		F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] MST3367_ADC_MODE_DETECT( %d x %d x %d x %d x %d x status = %d )\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE,(ULONG)(wx), (ULONG)(cx), (ULONG)(wy), (ULONG)(fv), (ULONG)(cs), status);

		F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] MST3367_ADC_MODE_DETECT( ht:%d x vt:%d x hp:%d x vp:%d x delay:%d )\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, *nHTotal, *nVTotal, *nHPeriod, *nVPeriod, *nDetectDelay);

		F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] m_nAnalogVideoDecoderStatusProperty( %d )\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, pDevice->m_nAnalogVideoDecoderStatusProperty );
		

		//daniel, add RGB SOG input 2015, 10, 7, send back hsync vsync status
		return (0x8000000000000000) | ((ULONGLONG)status << 52) | (cs << 48) | (fv << 32) | (wx << 16) | (wy << 0);
	}
	else {

		// daniel, 2015, set the vertical sync seperation threshold
		//
		MST3367_SetRegister( pDevice, 0x00, 0x11, 0x20 );

		nHTotal = 0;

		nVTotal = 0;

		nHPeriod = 0;

		nVPeriod = 0;

		nDetectDelay = 0;
	}
	return 0x0000000000000000;
}

ULONG MST3367_TMDS_GET_TYPE( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice )
{
	// -----> RxTmdsGetType() [1.35]
	//
	ULONG type = 0x00000000; // RX_TMDS_DVI

	BYTE R0101 = MST3367_GetRegister( pDevice, 0x01, 0x01 );

	BYTE R0134 = MST3367_GetRegister( pDevice, 0x01, 0x34 );

	if( R0101 & 0x04 ) { type |= 0x00000001; } // RX_TMDS_HDMI

	if( R0101 & 0x01 ) { type |= 0x00000002; } // DVI / HDMI WITH HDCP

	if( R0134 & 0x80 ) { type |= 0x00000002; } // RX_TMDS_HDMI_HDCP / RX_TMDS_DVI_HDCP

	//F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "MST3367_TMDS_GET_TYPE( %08X )\n", type );

	return type;
}

BOOLEAN MST3367_TMDS_HOT_PLUG( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, ULONG dwType )
{
	// -----> RxTmdsHotPlug() [1.35]
	//
	#ifdef AME_SA7160

	ULONG R0000E004 = A77C4935F8134B048348571A43F2A9CA( pDevice, 0x0000E000 + 0x0004 );

	if( pDevice->iManufacturer == 0x1F ) { // SC512N1.VPX.1ST

		if( dwType & RX_TMDS_A_HPD_ON ) { R0000E004 &= ~(1 << 20); } else { R0000E004 |= (1 << 20); } // HPD0.CTRL

		if( dwType & RX_TMDS_A_HPD_ON ) { R0000E004 &= ~(1 <<  2); } else { R0000E004 |= (1 <<  2); } // HPD1.CTRL
	}
	else {

		if( dwType & RX_TMDS_A_HPD_ON ) { R0000E004 &= ~(1 << 20); } else { R0000E004 |= (1 << 20); } // HPD0.CTRL

		if( dwType & RX_TMDS_B_HPD_ON ) { R0000E004 &= ~(1 << 26); } else { R0000E004 |= (1 << 26); } // HPD1.CTRL
	}
	A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 );

	#endif

	#ifdef AME_FH8735

	ULONG R00700000 = d439bfca9ec846ea956d1bf0aa3adc45( pDevice, 1, 0x00700000 + 0x00000000 );

	if( dwType & RX_TMDS_A_HPD_ON ) { R00700000 &= ~(1 <<  9); } else { R00700000 |= (1 <<  9); } // HPD0.CTRL

	if( dwType & RX_TMDS_B_HPD_ON ) { R00700000 &= ~(1 << 10); } else { R00700000 |= (1 << 10); } // HPD1.CTRL

	de288df0e76e4990be34b3bea95ca349( pDevice, 1, 0x00700000 + 0x00000000, R00700000 );

	#endif

	#if defined(AME_PL330B) || defined(AME_PL330A)

	if( dwType & RX_TMDS_A_HPD_ON ) { CBFDDC6395144862ACEDAD3C092FC9A6( pDevice, 11, 0 ); } else { CBFDDC6395144862ACEDAD3C092FC9A6( pDevice, 11, 1 ); } // HPD0.CTRL

	if( dwType & RX_TMDS_B_HPD_ON ) { CBFDDC6395144862ACEDAD3C092FC9A6( pDevice, 12, 0 ); } else { CBFDDC6395144862ACEDAD3C092FC9A6( pDevice, 12, 1 ); } // HPD1.CTRL

	#endif

	#ifdef AME_MZ0380

	if( (pDevice->iProduct == 0x1C && pDevice->iManufacturer == 0xFA) ||  // ELGATO BOARD (SC5C0)
		(pDevice->iProduct == 0x00 && pDevice->iManufacturer == 0x03) ||  // ELGATO BOARD (SC5C0)
		(pDevice->iProduct == 0x00 && pDevice->iManufacturer == 0x05) ) { // ELGATO BOARD (SC5C0)
	
		if( dwType & RX_TMDS_B_HPD_ON ) { D8735A9140EC43B888E108661E19175A( pDevice, 1, 0 ); } else { D8735A9140EC43B888E108661E19175A( pDevice, 1, 1 ); } // HPD0.CTRL
	}	
	else if( pDevice->iManufacturer == 0x5E ||  // ELGATO BOARD (SC5C0)
		
			 pDevice->iManufacturer == 0x5F ||  // SC550N1 M2 HDMI
		
			 pDevice->iManufacturer == 0xCE ||  // ELGATO BOARD (SC5C0)
		
			 pDevice->iManufacturer == 0xCF ) { // SC5C0N1 M2 HDMI

		if( dwType & RX_TMDS_B_HPD_ON ) { D8735A9140EC43B888E108661E19175A( pDevice, 1, 0 ); } else { D8735A9140EC43B888E108661E19175A( pDevice, 1, 1 ); } // HPD0.CTRL
	}
	else if( pDevice->iManufacturer == 0x5D ||
		
			 pDevice->iManufacturer == 0xCD ) {
		
		D8735A9140EC43B888E108661E19175A( pDevice, 1, 0 );

		D8735A9140EC43B888E108661E19175A( pDevice, 2, 0 );

//		if( dwType & RX_TMDS_A_HPD_ON ) { D8735A9140EC43B888E108661E19175A( pDevice, 1, 0 ); } else { D8735A9140EC43B888E108661E19175A( pDevice, 1, 1 ); } // HPD0.CTRL
	
//		if( dwType & RX_TMDS_B_HPD_ON ) { D8735A9140EC43B888E108661E19175A( pDevice, 2, 0 ); } else { D8735A9140EC43B888E108661E19175A( pDevice, 2, 1 ); } // HPD1.CTRL
	}
	else {
		
		if( dwType & RX_TMDS_A_HPD_ON ) { D8735A9140EC43B888E108661E19175A( pDevice, 1, 0 ); } else { D8735A9140EC43B888E108661E19175A( pDevice, 1, 1 ); } // HPD0.CTRL
	
	//	if( dwType & RX_TMDS_B_HPD_ON ) { D8735A9140EC43B888E108661E19175A( pDevice, 2, 0 ); } else { D8735A9140EC43B888E108661E19175A( pDevice, 2, 1 ); } // HPD1.CTRL
	}
	#endif

	///////////////////////////////////////////////////////////////////////

	BYTE R00B7 = MST3367_GetRegister( pDevice, 0x00, 0xB7 ); R00B7 |= 0x02;

	if( dwType & RX_TMDS_A_LINK_ON ) { R00B7 &= ~0x02; }

	if( dwType & RX_TMDS_B_LINK_ON ) { R00B7 &= ~0x02; }

	MST3367_SetRegister( pDevice, 0x00, 0xB7, R00B7 );

	return TRUE;
}

VOID MST3367_AUDIO_SELECT( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, ULONG nAudioIn )
{
	#ifdef AME_CY3014

	BYTE FPGA_R20 = CY3014_GetFpgaRegister( pDevice, 0x20 );

	if( nAudioIn == AUDIO_LINE_IN ) {

		FPGA_R20  |=  (1 <<  4); // I2S.SEL = 1
	}
	else {

		FPGA_R20  &= ~(1 <<  4); // I2S.SEL = 0
	}
	CY3014_SetFpgaRegister( pDevice, 0x20, FPGA_R20 );

	#endif

	#ifdef AME_SA7160

	ULONG R0000E004 = A77C4935F8134B048348571A43F2A9CA( pDevice, 0x0000E000 + 0x0004 );

	if( nAudioIn == AUDIO_LINE_IN ) {

		R0000E004 &= ~(1 <<  5); // I2S.SEL = 0
	}
	else {

		R0000E004 |=  (1 <<  5); // I2S.SEL = 1
	}
	A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 );

	#endif

	#ifdef AME_FH8735

	ULONG R00700000 = d439bfca9ec846ea956d1bf0aa3adc45( pDevice, 1, 0x00700000 + 0x00000000 );

	if( nAudioIn == AUDIO_LINE_IN ) {

		R00700000 |=  (1 << 12); // I2S.SEL = 1
	}
	else {

		R00700000 &= ~(1 << 12); // I2S.SEL = 0
	}
	de288df0e76e4990be34b3bea95ca349( pDevice, 1, 0x00700000 + 0x00000000, R00700000 );

	#endif

	#if defined(AME_PL330B) || defined(AME_PL330A)
	
	#endif

	#ifdef AME_MZ0380

	#endif

}


BOOLEAN MST3367_HDMI_INIT( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice )
{
	// -----> RxHdmiInit() -----> RxHdmiInitTbl [1.35]
	// 
	BYTE R0201 = MST3367_GetRegister( pDevice, 0x02, 0x01 ); R0201 &= ~0xF0; R0201 |= 0x40; R0201 |= 0x20;

	MST3367_SetRegister( pDevice, 0x02, 0x01, R0201 );

	BYTE R0204 = MST3367_GetRegister( pDevice, 0x02, 0x04 ); R0204 &= ~0x01; R0204 |= 0x01;

	MST3367_SetRegister( pDevice, 0x02, 0x04, R0204 );

	MST3367_SetRegister( pDevice, 0x02, 0x06, 0x08 );

	BYTE R0209 = MST3367_GetRegister( pDevice, 0x02, 0x09 ); R0209 &= ~0x20; R0209 |= 0x20;

	MST3367_SetRegister( pDevice, 0x02, 0x09, R0209 );

	BYTE R0054 = MST3367_GetRegister( pDevice, 0x00, 0x54 ); R0054 &= ~0x10; R0054 |= 0x00;

	MST3367_SetRegister( pDevice, 0x00, 0x54, R0054 );

	BYTE R00AC = MST3367_GetRegister( pDevice, 0x00, 0xAC ); R00AC &= ~0x80; R00AC |= 0x80;

	MST3367_SetRegister( pDevice, 0x00, 0xAC, R00AC );

	BYTE R0000 = MST3367_GetRegister( pDevice, 0x00, 0x00 ); R0000 &= ~0x80; R0000 |= 0x80;

	MST3367_SetRegister( pDevice, 0x00, 0x00, R0000 );

	BYTE R00CE = MST3367_GetRegister( pDevice, 0x00, 0xCE ); R00CE &= ~0x80; R00CE |= 0x80;

	MST3367_SetRegister( pDevice, 0x00, 0xCE, R00CE );

	BYTE R00CF = MST3367_GetRegister( pDevice, 0x00, 0xCF ); R00CF &= ~0x07; R00CF |= 0x02;

	MST3367_SetRegister( pDevice, 0x00, 0xCF, R00CF );

	R0000 = MST3367_GetRegister( pDevice, 0x00, 0x00 ); R0000 &= ~0x80; R0000 |= 0x00;

	MST3367_SetRegister( pDevice, 0x00, 0x00, R0000 );

	return TRUE;
}

BOOLEAN MST3367_HDMI_RESET( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice )
{
	// -----> RxHdmiReset() [1.35]
	//
	MST3367_SetRegister( pDevice, 0x02, 0x07, 0xF4 );

	MST3367_SetRegister( pDevice, 0x02, 0x07, 0x04 );

	return TRUE;
}

BOOLEAN MST3367_HDCP_RESET( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice )
{
	// -----> RxHdcpReset() [1.35]
	//
	MST3367_SetRegister( pDevice, 0x00, 0xB8, 0x10 ); // HDCP.RESET

	MST3367_SetRegister( pDevice, 0x00, 0xB8, 0x00 );

	return TRUE;
}

ULONGLONG MST3367_HDMI_MODE_DETECT( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, ULONG* nHTotal, ULONG* nVTotal, ULONG* nHPeriod, ULONG* nVPeriod, ULONG* nDetectDelay )
{
	// -----> RxHdmiModeDetect() [1.35]
	//
	BYTE R0055 = MST3367_GetRegister( pDevice, 0x00, 0x55 );

	F1838C0176E054c129B7F2BF440D1236E( KERN_INFO, "[%02d] MST3367_HDMI_MODE_DETECT() R0055(0x%x)\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, R0055 );

	if( (R0055 & 0x3C) == 0x3C ) {	//daniel, UB535_ELGATO, avoid of HDMI input signal unstable


		BYTE R006A = MST3367_GetRegister( pDevice, 0x00, 0x6A ) & 0x0F;

		BYTE R006B = MST3367_GetRegister( pDevice, 0x00, 0x6B ) & 0xFF;

		BYTE R0057 = MST3367_GetRegister( pDevice, 0x00, 0x57 ) & 0x3F;

		BYTE R0058 = MST3367_GetRegister( pDevice, 0x00, 0x58 ) & 0xFF;

		BYTE R0059 = MST3367_GetRegister( pDevice, 0x00, 0x59 ) & 0x3F;

		BYTE R005A = MST3367_GetRegister( pDevice, 0x00, 0x5A ) & 0xFF;

		BYTE R005B = MST3367_GetRegister( pDevice, 0x00, 0x5B ) & 0x07;

		BYTE R005C = MST3367_GetRegister( pDevice, 0x00, 0x5C ) & 0xFF;

		BYTE R005F = MST3367_GetRegister( pDevice, 0x00, 0x5F ) & 0x02;

		BYTE R0229 = MST3367_GetRegister( pDevice, 0x02, 0x29 ) & 0x1F;

		BYTE R0228 = MST3367_GetRegister( pDevice, 0x02, 0x28 ) & 0xFF;

		ULONGLONG wx = (R006A << 8) | (R006B << 0); // H.TOTAL

		ULONGLONG wy = (R005B << 8) | (R005C << 0); // V.TOTAL

		ULONGLONG cx = (R0229 << 8) | (R0228 << 0); // H.ACTIVE

		ULONGLONG fh = (((R0057 << 8) | (R0058 << 0)) > 0) ? ((1600000) / ((R0057 << 8) | (R0058 << 0))) : (0); // H.PERIOD

		ULONGLONG fv = (((R0059 << 8) | (R005A << 0)) > 0) ? ((1250000) / ((R0059 << 8) | (R005A << 0))) : (0); // V.PERIOD

		ULONGLONG fi = (R005F >> 1); // INTERLEAVED

		// [2016.02.02] [DEEP COLOR]
		//
		{	BYTE reg1_1;
		
			BYTE colordepth;
			
			reg1_1 = MST3367_GetRegister( pDevice, 0x01, 0x01 );
			
			if( (reg1_1 & 4) != 0 ) {
				
				colordepth = MST3367_GetRegister( pDevice, 0x02, 0x47 )& 0x0f;

				//if( colordepth == 5 ) wx = (wx*4)/5; // 30bit, TMDS clock = 1.25 * pixel clock
					
				//if( colordepth == 6 ) wx = (wx*2)/3; // 36bit, TMDS clock = 1.50 * pixel clock
					
				//if( colordepth == 7 ) wx = (wx*1)/2; // 48bit, TMDS clock = 2.00 * pixel clock

				if( colordepth == 5 )
				{
					ULONGLONG temp_wx = wx*4;

					do_div(temp_wx, 5);

					wx = temp_wx;
				}
				if( colordepth == 6 )
				{
					ULONGLONG temp_wx = wx*2;

					do_div(temp_wx, 3);

					wx = temp_wx;
				}
				if( colordepth == 7 )
				{
					ULONGLONG temp_wx = wx*1;

					do_div(temp_wx, 2);

					wx = temp_wx;
				}
			}
		}


		*nHTotal = (ULONG)(wx);

		*nVTotal = (ULONG)(wy);

		*nHPeriod = (ULONG)(fh);

		*nVPeriod = (ULONG)(fv);

		*nDetectDelay = (R0059 << 8) | (R005A << 0);

		*nDetectDelay = ((*nDetectDelay + 63) * 2) / (125); // unit : ms

		F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] MST3367_HDMI_MODE_DETECT( %d x %d x %d x %d x %d x R0055 = %02X %c )\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, (ULONG)(wx), (ULONG)(cx), (ULONG)(wy), (ULONG)(fh), (ULONG)(fv), R0055, fi ? 'i' : 'p' );

		#ifdef AME_SA7160
	
		SA7160_SYS_CFG * pSysCfg = (SA7160_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

		#endif

		#ifdef AME_FH8735
	
		FH8735_SYS_CFG * pSysCfg = (FH8735_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
		#endif

		#if defined(AME_PL330B) || defined(AME_PL330A)
	
		PL330B_SYS_CFG * pSysCfg = (PL330B_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
		#endif

		#ifdef AME_MZ0380
	
		MZ0380_SYS_CFG * pSysCfg = (MZ0380_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
		#endif
		
		F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] n_input_audio_sampling_frequency(0d%d)\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, pSysCfg->n_input_audio_sampling_frequency );

		//F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] MST3367_HDMI_MODE_DETECT, bank 1, R0001(0x%x)\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, MST3367_GetRegister( pDevice, 0x01, 0x01 ) );//HDMI 1XX, DVI 0XX
/*
HDMI_MD 2
HDCP_OP_STS 1
HDCP_MD 0
0x0: DVI, without HDCP.
001: DVI OESS* + HDCP, without advance cipher.
011: DVI EESS** + HDCP, with advance cipher.
1x0: HDMI EESS, without HDCP.
101: HDMI EESS + HDCP, without advance cipher.
111: HDMI + HDCP EESS, with advance cipher.
*OESS: Original Encryption Status Signaling.
**EESS: Enhanced Encryption Status Signaling
*/

		return (0x8000000000000000) | (fi << 62) | (fv << 48) | (cx << 32) | (wx << 16) | (wy << 0); // ?��??�容
	}
	else {

		nHTotal = 0;

		nVTotal = 0;

		nHPeriod = 0;

		nVPeriod = 0;

		nDetectDelay = 0;
	}
	return 0x0000000000000000;
}

ULONG MST3367_HdmiGetPacketStatus( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice )
{
	// -----> RxHdmiPacketStatus()
	// 
	ULONG status = 0x00000000;

	BYTE R020B = MST3367_GetRegister( pDevice, 0x02, 0x0B ) & 0xFF;

	BYTE R020C = MST3367_GetRegister( pDevice, 0x02, 0x0C ) & 0x3F;

	BYTE R020E = MST3367_GetRegister( pDevice, 0x02, 0x0E ) & 0x08;

	status = (R020C << 8) | (R020B << 0);

	if( R020E & 0x08 ) { status |= 0x8000; }

	//F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "MST3367_HDMI_GET_PACKET_STATUS( %08X )\n", status );

	return status;
}

ULONG MST3367_HdmiGetPacketColor( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice )
{
	// -----> RxHdmiPacketColor()
	//
	ULONG color = 0x00000000; // RX_INPUT_RGB

	BYTE R0248 = MST3367_GetRegister( pDevice, 0x02, 0x48 ); R0248 &= 0x60;

	if( R0248 == 0x00 ) { color = 0x00000000; } // RX_INPUT_RGB

	if( R0248 == 0x20 ) { color = 0x00000001; } // RX_INPUT_YUV422

	if( R0248 == 0x40 ) { color = 0x00000002; } // RX_INPUT_YUV444

//	F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "MST3367_HDMI_GET_PACKET_COLOR( %08X )\n", color );

	return color;
}

BOOLEAN MST3367_VideoFormatDetection( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice )
{
	#ifdef AME_SA7160
	
	SA7160_SYS_CFG * pSysCfg = (SA7160_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

	#endif

	#ifdef AME_FH8735
	
	FH8735_SYS_CFG * pSysCfg = (FH8735_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
	#endif

	#if defined(AME_PL330B) || defined(AME_PL330A)
	
	PL330B_SYS_CFG * pSysCfg = (PL330B_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
	#endif

	#ifdef AME_MZ0380
	
	MZ0380_SYS_CFG * pSysCfg = (MZ0380_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);
	
	#endif


	if( pDevice->m_nAnalogCrossbarVideoInputProperty == 2 ||  // COMPONENT

		pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) { // DVI.ANALOG

		ULONG n_signal_h_period_us = 0;

		ULONG n_signal_v_period_us = 0;

		ULONG n_signal_h_total = 0;

		ULONG n_signal_v_total = 0;

		ULONG n_signal_h_start = 0;

		ULONG n_signal_v_start = 0;

		ULONG n_signal_h_period = 0; 
		
		ULONG n_signal_v_period = 0;

		ULONG n_signal_detect_delay = 0;

		ULONGLONG n_signal_lock_status = MST3367_ADC_MODE_DETECT( pDevice, &n_signal_h_period_us, &n_signal_v_period_us, &n_signal_h_total, &n_signal_v_total, &n_signal_h_period, &n_signal_v_period, &n_signal_detect_delay );

		BOOL b_is_signal_vaild = FALSE;

		BOOL b_is_signal_changed = FALSE;

		if( n_signal_lock_status & 0x8000000000000000 ) {

			ULONG wx = (ULONG)((n_signal_lock_status & 0x000000000FFF0000) >> 16); // H.FREQ

			ULONG wy = (ULONG)((n_signal_lock_status & 0x0000000000000FFF) >>  0);

			ULONG fv = (ULONG)((n_signal_lock_status & 0x00000FFF00000000) >> 32); // V.FREQ

			ULONG cs = (ULONG)((n_signal_lock_status & 0x0001000000000000) >> 48);

			ULONG x = 0;

			ULONG y = 0;

			ULONG fps = 0;

			ULONG polarity_h = 1;

			ULONG polarity_v = 1;

			ULONG vtotal = 0;

			ULONG polarity_h_v = (ULONG)((n_signal_lock_status & 0x0006000000000000) >> 49);
			
//daniel, add RGB SOG input 2015, 10, 7
			BYTE n_sog_mode = (BYTE)((n_signal_lock_status & 0x0030000000000000) >> 52);

			if( pSysCfg->n_input_mode_index != 0xFFFF )
			{
				if( pSysCfg->n_SOG_mode == HV_COMPOSITE || 
				
				    pSysCfg->n_SOG_mode == SOG_SIGNAL ) { //composite sync or SOG
				
					if(pSysCfg->n_SOG_vsync_mode == SOG_NO_HSYNC)			//VSYNC period without HSYN 
						wy += pSysCfg->n_vsync_width;
					else if(pSysCfg->n_SOG_vsync_mode == SOG_WITH_HSYNC)	//VSYNC period with HSYNC
						;
					else if(pSysCfg->n_SOG_vsync_mode == SOG_TV_MODE)		//VSYNC with TV format, 1125p, 1125i, 720p, 480i, 480p
					{
						if(wy == 1130)		//1080p
							wy = 1125;		
						if(wy == 755)		//720p
							wy = 750;
						if(wy >= 577 && wy <= 579)	//1125i
							wy = 562;	//1125/2
						if(wy >= 271 && wy <= 273)	//480i
							wy = 262;	//525/2
						if(wy >= 319 && wy <= 321)	//576i
							wy = 312;	//625/2
					}
					polarity_h_v = pSysCfg->n_input_video_resolution_hv_polarity;
				}
			}
			if( !(pSysCfg->n_input_video_resolution_v_total >= (wy-cs*2) && pSysCfg->n_input_video_resolution_v_total <= (wy+cs*2))|| 
			    
			    !((pSysCfg->n_input_video_resolution_fps+1) >= (fv+3)/10 && (pSysCfg->n_input_video_resolution_fps-1) <= (fv+3)/10) || 

				pSysCfg->n_SOG_mode != n_sog_mode || 

				pSysCfg->n_Interlace_mode != cs || 
				
				(pSysCfg->n_input_video_resolution_hv_polarity != polarity_h_v && n_sog_mode == HV_SEP_SIGNAL)|| 
				
				pSysCfg->n_input_mode_index == 0xFFFF ) {

				pSysCfg->n_input_mode_index = 0xFFFF;

				wy = (ULONG)((n_signal_lock_status & 0x0000000000000FFF) >>  0);

				polarity_h_v = (ULONG)((n_signal_lock_status & 0x0006000000000000) >> 49);

				pSysCfg->n_SOG_mode = n_sog_mode;

				pSysCfg->n_Interlace_mode = (BYTE)cs;
				
				pSysCfg->n_input_mode_index = SearchDisplayModeTable( pDevice, pDevice->m_nAnalogCrossbarVideoInputProperty, wy, (fv + 3) / 10, polarity_h_v );

				if( pSysCfg->n_SOG_mode == HV_COMPOSITE || 
				
					pSysCfg->n_SOG_mode == SOG_SIGNAL ) {
						
					// coast enable for SOG
					MST3367_SetRegister( pDevice, 0x00, 0x0F, 0x20 );
				}
				else
				{
					// coast enable for SOG
					MST3367_SetRegister( pDevice, 0x00, 0x0F, 0x08 );
				}
				F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "n_input_mode_index(0x%x)---!!!\n", pSysCfg->n_input_mode_index );
			}
			if( pSysCfg->n_input_mode_index != 0xFFFF ) {
				
				if( pDevice->m_nAnalogCrossbarVideoInputProperty == 2 ) {
					
					if( pSysCfg->n_input_mode_index <= (DEFAULT_MST3367_EIA_SIZE - 1) ) {
						
						x = RX_ADC_SET_VALUES_EIA[ pSysCfg->n_input_mode_index ][ 10 ];
						
						y = RX_ADC_SET_VALUES_EIA[ pSysCfg->n_input_mode_index ][ 11 ];
				
						fps = RX_ADC_SET_VALUES_EIA[ pSysCfg->n_input_mode_index ][ 12 ];
						
						vtotal = RX_ADC_SET_VALUES_EIA[ pSysCfg->n_input_mode_index ][ 7 ];
	
						pSysCfg->n_input_video_resolution_h_total = RX_ADC_SET_VALUES_EIA[ pSysCfg->n_input_mode_index ][ 6 ];
					
						pSysCfg->n_input_video_resolution_hv_polarity = RX_ADC_SET_VALUES_EIA[ pSysCfg->n_input_mode_index ][ 13 ];
					}
					else {
						F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] error n_input_mode_index(0x%x)---!!! 111???\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, pSysCfg->n_input_mode_index );
					}
					
				}
				else {
					
					if( pSysCfg->n_input_mode_index <= (DEFAULT_MST3367_VESA_SIZE - 1) ) {
						
						x = RX_ADC_SET_VALUES_VESA[ pSysCfg->n_input_mode_index ][ 10 ];
						
						y = RX_ADC_SET_VALUES_VESA[ pSysCfg->n_input_mode_index ][ 11 ];
						
						fps = RX_ADC_SET_VALUES_VESA[ pSysCfg->n_input_mode_index ][ 12 ];
				
						vtotal = RX_ADC_SET_VALUES_VESA[ pSysCfg->n_input_mode_index ][ 7 ];

						pSysCfg->n_input_video_resolution_h_total = RX_ADC_SET_VALUES_VESA[ pSysCfg->n_input_mode_index ][ 6 ];
					
						pSysCfg->n_input_video_resolution_hv_polarity = RX_ADC_SET_VALUES_VESA[ pSysCfg->n_input_mode_index ][ 13 ];
					}
					else {
						F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] error n_input_mode_index(0x%x)---!!! 222???\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, pSysCfg->n_input_mode_index );
					}
				}
				goto skip_to_setad;
			}
			if( pDevice->m_nAnalogCrossbarVideoInputProperty != 3 ) { goto EXIT_AUTO; }

			if( (wx >= (179 - 5)) && (wx <= (179 + 5)) && (fv >= (2443 -  5)) && (fv <= (2443 +  5))            ) { x = 1280; y =  720; fps = 24; } // YCBCR

			if( (wx >= (179 - 5)) && (wx <= (179 + 4)) && (fv >= (3533 -  5)) && (fv <= (3533 +  5))            ) { x = 1280; y =  720; fps = 24; } // YCBCR

			if( (wx >= (187 - 4)) && (wx <= (187 + 5)) && (fv >= (3533 -  5)) && (fv <= (3533 +  5))            ) { x = 1280; y =  720; fps = 25; } // YCBCR

			if( (wx >= (187 - 4)) && (wx <= (187 + 5)) && (fv >= ( 256 -  5)) && (fv <= ( 256 +  5))            ) { x = 1280; y =  720; fps = 25; } // YCBCR

			if( (wx >= (187 - 4)) && (wx <= (187 + 5))                                                          ) { x = 1280; y =  720; fps = 25; } // YCBCR

			if( (wx >= (224 - 5)) && (wx <= (224 + 5)) && (fv >= ( 144 -  5)) && (fv <= ( 144 +  5))            ) { x = 1280; y =  720; fps = 30; } // YCBCR


			if( (wx >= (269 - 5)) && (wx <= (269 + 5)) && (fv >= (240 -  5)) && (fv <= (240 +  5))              ) { x = 1920; y = 1080; fps = 24; }

			if( (wx >= (281 - 5)) && (wx <= (281 + 5)) && (fv >= (250 -  5)) && (fv <= (250 +  5))              ) { x = 1920; y = 1080; fps = 25; }

			if( (wx >= (337 - 5)) && (wx <= (337 + 5)) && (fv >= (300 -  5)) && (fv <= (300 +  5))              ) { x = 1920; y = 1080; fps = 30; }

			if( (wx >= (312 - 5)) && (wx <= (312 + 5)) && (fv >= (300 -  5)) && (fv <= (300 +  5))              ) { x = 3840; y = 1024; fps = 30; }

			if( pDevice->m_nCustomCompanyVision4CEProperty == 1 ) {
		
				if( (wx >= (156 - 11)) && (wx <= (156 + 11)) && (fv >= (500 - 10)) && (fv <= (500 + 10))          ) { x =  768; y =  288; fps = 50; }
			}
			else {

				if( (wx >= (156 - 11)) && (wx <= (156 + 11)) && (fv >= (500 - 10)) && (fv <= (500 + 10))          ) { x =  720; y =  288; fps = 50; }
			}
			if( (wx >= (156 - 5)) && (wx <= (156 + 5)) && (fv >= (500 - 50)) && (fv <= (500 + 50)) && (cs == 0) ) { x = 1440; y =  288; fps = 50; }

			if( (wx >= (276 - 5)) && (wx <= (276 + 5)) && (fv >= (500 - 10)) && (fv <= (500 + 10))              ) { x = 1440; y =  540; fps = 50; } // ->

			if( (wx >= (281 - 5)) && (wx <= (281 + 5)) && (fv >= (500 - 10)) && (fv <= (500 + 10))              ) { x = 1920; y =  540; fps = 50; } // ->

			if( (wx >= (313 - 5)) && (wx <= (313 + 5)) && (fv >= (500 - 10)) && (fv <= (500 + 10))              ) { x =  720; y =  576; fps = 50; }

			if( (wx >= (375 - 5)) && (wx <= (375 + 5)) && (fv >= (500 - 10)) && (fv <= (500 + 10))              ) { x = 1280; y =  720; fps = 50; }

			if( (wx >= (396 - 5)) && (wx <= (396 + 5)) && (fv >= (500 - 10)) && (fv <= (500 + 10))              ) { x = 1024; y =  768; fps = 50; }

			if( (wx >= (527 - 5)) && (wx <= (527 + 5)) && (fv >= (500 - 10)) && (fv <= (500 + 10))              ) { x = 1280; y = 1024; fps = 50; }

			if( (wx >= (563 - 5)) && (wx <= (563 + 5)) && (fv >= (500 - 10)) && (fv <= (500 + 10))              ) { x = 1920; y = 1080; fps = 50; }

			if( (wx >= (617 - 5)) && (wx <= (617 + 5)) && (fv >= (500 - 10)) && (fv <= (500 + 10))				) { x = 1600; y = 1200; fps = 50; }

			if( (wx >= (617 - 5)) && (wx <= (617 + 5)) && (fv >= (500 - 10)) && (fv <= (500 + 10))				) { x = 1920; y = 1200; fps = 50; }


			if( (wx >= (314 - 5)) && (wx <= (314 + 5)) && (fv >= (550 - 10)) && (fv <= (550 + 10))              ) { x =  768; y =  512; fps = 55; }

			if( (wx >= (363 - 5)) && (wx <= (363 + 5)) && (fv >= (550 - 10)) && (fv <= (550 + 10))              ) { x =  800; y =  600; fps = 55; }

			if( (wx >= (351 - 5)) && (wx <= (351 + 5)) && (fv >= (560 - 10)) && (fv <= (560 + 10))              ) { x =  800; y =  600; fps = 56; }


			if( (wx >= (157 - 5)) && (wx <= (157 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10))              ) { x =  720; y =  240; fps = 60; }

			if( (wx >= (157 - 5)) && (wx <= (157 + 5)) && (fv >= (600 - 50)) && (fv <= (600 + 50)) && (cs == 0) ) { x = 1440; y =  240; fps = 60; }

		//	if( (wx >= (315 - 5)) && (wx <= (315 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10))              ) { x =  720; y =  480; fps = 60; } // ->

			if( (wx >= (337 - 5)) && (wx <= (337 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10))              ) { x = 1920; y =  540; fps = 60; }

			if( (wx >= (372 - 5)) && (wx <= (372 + 2)) && (fv >= (600 - 10)) && (fv <= (600 + 10))              ) { x = 1024; y =  600; fps = 60; } // <-

			if( (wx >= (379 - 4)) && (wx <= (379 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10))              ) { x =  800; y =  600; fps = 60; } // <-

		//	if( (wx >= (450 - 5)) && (wx <= (450 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10))              ) { x = 1280; y =  720; fps = 60; } // ->

			if( (wx >= (484 - 3)) && (wx <= (484 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10))              ) { x = 1024; y =  768; fps = 60; }

		//	if( (wx >= (496 - 5)) && (wx <= (496 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10))              ) { x = 1280; y =  800; fps = 60; }

			if( (wx >= (496 - 5)) && (wx <= (496 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10))              ) {
			 
				x = 1280; y = 800; fps = 60;

				if( wy > 821 && wy < 825 ) {

					vtotal = 823;
				}
			}
			if( (wx >= (555 - 5)) && (wx <= (555 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10))              ) { x = 1440; y =  900; fps = 60; }

			if( (wx >= (600 - 5)) && (wx <= (600 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10))              ) { x = 1280; y =  960; fps = 60; }

		//	if( (wx >= (640 - 5)) && (wx <= (640 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10)) && (wy >= (1066 - 5)) && (wy <= (1066 + 5)) ) { x = 1280; y = 1024; fps = 60; }

			if( (wx >= (640 - 5)) && (wx <= (640 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10)) && (wy >= (1066 - 5)) && (wy <= (1066 + 5)) ) {
			
				x = 1280; y = 1024; fps = 60;

				if( wy > 1061 && wy < 1065 ) {

					vtotal = 1063;
				}
			}
			if( (wx >= (646 - 5)) && (wx <= (646 + 5)) && (fv >= (599 - 10)) && (fv <= (599 + 10)) && (wy >= (1080 - 5)) && (wy <= (1080 + 5)) ) { 

				if( (pSysCfg->n_input_video_resolution_cx == 1400 && pSysCfg->n_input_video_resolution_cy == 1050 && pSysCfg->n_input_video_resolution_fps == 60) ) {

					x = 1400; y = 1050; fps = 61; 
				}
				else if( (pSysCfg->n_input_video_resolution_cx == 1680 && pSysCfg->n_input_video_resolution_cy == 1050 && pSysCfg->n_input_video_resolution_fps == 60) ) {

					x = 1680; y = 1050; fps = 60; vtotal = 1080;
				}
				else {

					x = 1400; y = 1050; fps = 61; 

					ULONG sync_width = pSysCfg->n_vsync_width;

					if( sync_width == 6 ) {

						x = 1680; y = 1050; fps = 60; vtotal = 1080;
					}
				}
			}
			if( (wx >= (652 - 5)) && (wx <= (652 + 5)) && (fv >= (599 - 10)) && (fv <= (599 + 10)) && (wy >= (1089 - 5)) && (wy <= (1089 + 5)) ) { x = 1400; y = 1050; fps = 60; }

		//	if( (wx >= (675 - 5)) && (wx <= (675 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10))              ) { x = 1920; y = 1080; fps = 60; } // ->

		//	if( (wx >= (749 -10)) && (wx <= (749 +10)) && (fv >= (600 - 10)) && (fv <= (600 + 10))				) { x = 1600; y = 1200; fps = 60; } // ->


			if( (wx >= (564 - 5)) && (wx <= (564 + 5)) && (fv >= (700 - 10)) && (fv <= (700 + 10))              ) { x = 1024; y =  768; fps = 70; }


			if( (wx >= (378 - 5)) && (wx <= (378 + 5)) && (fv >= (720 - 10)) && (fv <= (720 + 10))              ) { x =  640; y =  480; fps = 72; }

			if( (wx >= (480 - 5)) && (wx <= (480 + 5)) && (fv >= (720 - 10)) && (fv <= (720 + 10))              ) { x =  800; y =  600; fps = 72; }

			
			if( (wx >= (374 - 5)) && (wx <= (374 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x =  640; y =  480; fps = 75; }

			if( (wx >= (393 - 5)) && (wx <= (393 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x =  800; y =  500; fps = 75; }

			if( (wx >= (468 - 5)) && (wx <= (468 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x =  800; y =  600; fps = 75; }

			if( (wx >= (491 - 5)) && (wx <= (491 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x =  832; y =  624; fps = 75; }

			if( (wx >= (563 - 5)) && (wx <= (563 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x = 1280; y =  720; fps = 75; }

		//	if( (wx >= (600 - 5)) && (wx <= (600 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x = 1024; y =  768; fps = 75; } // ->

		//	if( (wx >= (600 - 5)) && (wx <= (600 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x = 1280; y =  768; fps = 75; } // ->

			if( (wx >= (624 - 5)) && (wx <= (624 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x = 1280; y =  800; fps = 75; }

			if( (wx >= (674 - 5)) && (wx <= (674 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x = 1152; y =  864; fps = 75; }

			if( (wx >= (750 - 5)) && (wx <= (750 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x = 1280; y =  960; fps = 75; }

			if( (wx >= (799 - 5)) && (wx <= (799 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x = 1280; y = 1024; fps = 75; }

		//	if( (wx >= (600 - 5)) && (wx <= (600 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x = 1360; y =  768; fps = 75; } // ->

			if( (wx >= (705 - 5)) && (wx <= (705 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x = 1440; y =  900; fps = 75; }

			if( (wx >= (936 -10)) && (wx <= (936 +10)) && (fv >= (750 - 10)) && (fv <= (750 + 10))              ) { x = 1600; y = 1200; fps = 75; }


			if( (wx >= (379 - 5)) && (wx <= (379 + 5)) && (fv >= (850 - 10)) && (fv <= (850 + 10))              ) { x =  720; y =  400; fps = 85; }

			if( (wx >= (432 - 5)) && (wx <= (432 + 5)) && (fv >= (850 - 10)) && (fv <= (850 + 10))              ) { x =  640; y =  480; fps = 85; }

			if( (wx >= (536 - 5)) && (wx <= (536 + 5)) && (fv >= (850 - 10)) && (fv <= (850 + 10))              ) { x =  800; y =  600; fps = 85; }

			if( (wx >= (642 - 5)) && (wx <= (642 + 5)) && (fv >= (850 - 10)) && (fv <= (850 + 10))              ) { x = 1280; y =  720; fps = 85; }

		//	if( (wx >= (685 - 5)) && (wx <= (685 + 5)) && (fv >= (850 - 10)) && (fv <= (850 + 10))              ) { x = 1024; y =  768; fps = 85; } // ->

		//	if( (wx >= (685 - 5)) && (wx <= (685 + 5)) && (fv >= (850 - 10)) && (fv <= (850 + 10))              ) { x = 1280; y =  768; fps = 85; } // ->

			if( (wx >= (714 - 5)) && (wx <= (714 + 5)) && (fv >= (850 - 10)) && (fv <= (850 + 10))              ) { x = 1280; y =  800; fps = 85; }

			if( (wx >= (859 - 5)) && (wx <= (859 + 5)) && (fv >= (850 - 10)) && (fv <= (850 + 10))              ) { x = 1280; y =  960; fps = 85; }

			if( (wx >= (910 - 5)) && (wx <= (910 + 5)) && (fv >= (850 - 10)) && (fv <= (850 + 10))              ) { x = 1280; y = 1024; fps = 85; }

		//	if( (wx >= (685 - 5)) && (wx <= (685 + 5)) && (fv >= (850 - 10)) && (fv <= (850 + 10))              ) { x = 1360; y =  768; fps = 85; } // ->
			
			if( (wx >= (803 - 5)) && (wx <= (803 + 5)) && (fv >= (850 - 10)) && (fv <= (850 + 10))              ) { x = 1440; y =  900; fps = 85; }


			///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

			if( (wx >= (279 - 5)) && (wx <= (279 + 5))  && (fv >= (500 - 5)) && (fv <= (500 + 5)) )
			{ 
				BYTE R14 = MST3367_GetRegister( pDevice, 0x00, 0x14 );
				
				if( (R14 & 0x24) == (0x04) ) {

					x = 1440; y = 540; fps = 50;
				}
				else {

					x = 1920; y = 540; fps = 50;
				}
			}
			if( (wx >= (247 - 5)) && (wx <= (247 + 5)) && (fv >= (600 - 50)) && (fv <= (600 + 50)) ) { 
				
				if( (wy >= (420 - 5)) && (wy <= (420 + 5)) ) { 

				//	x = 496; y = 384; fps = 60;
					
					x = 640; y = 384; fps = 60;
				}
				else {

					x = 640; y = 400; fps = 60; 
				}	
			}
			if( (wx >= (299 - 3)) && (wx <= (299 + 3)) && (fv >= (599 - 5)) && (fv <= (599 + 5)) ) {

				if( (wy >= (500 - 5)) && (wy <= (500 + 5)) ) {

					x = 848; y = 480; fps = 60;
				}
			}
			if( (wx >= (450 - 5)) && (wx <= (450 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10)) ) { 
				
				BYTE R14 = MST3367_GetRegister( pDevice, 0x00, 0x14 );

				if( (R14 & 0x24) == (0x04) ) {

					x = 1280; y =  720; fps = 61;  // ++++++++++++++++++++++
				}
				else {					

					x = 1280; y =  720; fps = 60; 
				}
			}
			if( (wx >= (477 - 5)) && (wx <= (477 + 3)) && (fv >= (600 - 10)) && (fv <= (600 + 10)) ) {
				
				BYTE R14 = MST3367_GetRegister( pDevice, 0x00, 0x14 );

				if( (R14 & 0x24) == (0x24) ) {

					x = 1360; y = 768; fps = 60;
				}
				else if( (R14 & 0x24) == (0x00) ) {

					x = 1360; y = 768; fps = 61; // ++++++++++++++++++++++
				}
				else {

					if( wy > 793 && wy < 797 ) {

						x = 1024; y = 768; fps = 60; vtotal = 795;
					}
					else {

						if( (pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy == 768 && pSysCfg->n_input_video_resolution_fps == 60) ) {

							x = 1280; y = 768; fps = 60;
						}
						else if( (pSysCfg->n_input_video_resolution_cx == 1024 && pSysCfg->n_input_video_resolution_cy == 768 && pSysCfg->n_input_video_resolution_fps == 60) ) {

							x = 1024; y = 768; fps = 60; vtotal = 798;
				}
				else {

					x = 1280; y = 768; fps = 60;
						
							ULONG sync_width = pSysCfg->n_vsync_width;

							if( sync_width == 4 ) {

								x = 1024; y = 768; fps = 60; vtotal = 798;
							}
						}
					}
				}
			}
			if( (wx >= (675 - 15)) && (wx <= (675 + 10)) && (fv >= (600 - 10)) && (fv <= (600 + 10)) ) { 

				BYTE R14 = MST3367_GetRegister( pDevice, 0x00, 0x14 );

				polarity_h = (R14 & 0x20) ? 1 : 0;

				polarity_v = (R14 & 0x04) ? 1 : 0;

				if( (R14 & 0x24) == (0x20) ) {

					x = 1920; y = 1080; fps = 60; vtotal = 1111;
				}
				else if( (R14 & 0x24) == (0x04) ) {

					if( n_signal_v_total == 1118 ||
						
						n_signal_v_total == 1117 ) { 

						x = 1920; y = 1080; fps = 60; vtotal = 1118;
					}
					else {

						x = 1920; y = 1080; fps = 60; vtotal = 1120;
					}
				}
				else {					

					x = 1920; y = 1080; fps = 60; vtotal = 0;
				}
			}
			if( (wx >= (749 - 10)) && (wx <= (749 + 10)) && (fv >= (600 - 10)) && (fv <= (600 + 10)) ) { 
				
				if( (n_signal_h_total >= (2200 - 100)) && (n_signal_h_total <= (2200 + 100)) ) {

					x = 1600; y = 1200; fps = 60; 
				}
				else {

					x = 1920; y = 1200; fps = 60; 
				}
			}
			if( (wx >= (315 - 5)) && (wx <= (315 + 5)) && (fv >= (600 - 10)) && (fv <= (600 + 10)) ) {

				if( (pDevice->m_nCustomAnalogVideoResolutionProperty == 0x028001E0) ) { x = 640; y = 480; fps = 60; }

				else if( (pDevice->m_nCustomAnalogVideoResolutionProperty == 0x02D001E0) ) { x = 720; y = 480; fps = 60; }
				
				else {
					
					BYTE R0054_BACKUP = MST3367_GetRegister( pDevice, 0x00, 0x54 );
			
					BYTE R000E_BACKUP = MST3367_GetRegister( pDevice, 0x00, 0x0E );
			
					BYTE R0054 = R0054_BACKUP & (~0x10);
			
					BYTE R000E = R000E_BACKUP | ( 0x08);
			
					MST3367_SetRegister( pDevice, 0x00, 0x54, R0054 );
			
					MST3367_SetRegister( pDevice, 0x00, 0x0E, R000E );
			
					x = 720; y = 480; fps = 60;
			
					ULONG c = 0 ;
					for( c = 0 ; c < 10 ; c++ ) {
			
						MST3367_SetRegister( pDevice, 0x00, 0x54, MST3367_GetRegister( pDevice, 0x00, 0x54 ) & (~0x10) ); 
			
						MST3367_SetRegister( pDevice, 0x00, 0x0E, MST3367_GetRegister( pDevice, 0x00, 0x0E ) | ( 0x08) );

						MST3367_SetRegister( pDevice, 0x00, 0x0E, MST3367_GetRegister( pDevice, 0x00, 0x0E ) ^ ( 0x04) );
				
						ULONG VTOAL1 = (MST3367_GetRegister( pDevice, 0x00, 0x5B ) << 8) | (MST3367_GetRegister( pDevice, 0x00, 0x5C ));
			
						MST3367_SetRegister( pDevice, 0x00, 0x0E, MST3367_GetRegister( pDevice, 0x00, 0x0E ) ^ ( 0x04) );
			
						MST3367_SetRegister( pDevice, 0x00, 0x0E, R000E ^ ( 0x04) );
			
						ULONG VTOAL2 = (MST3367_GetRegister( pDevice, 0x00, 0x5B ) << 8) | (MST3367_GetRegister( pDevice, 0x00, 0x5C ));

						#define DIFF( a, b ) ((a > b) ? (a - b) : (b - a))

						ULONG offset = DIFF( VTOAL1, VTOAL2 );

						if( offset == 2 ) { x = 640; y = 480; fps = 60; break; }

						if( offset == 6 ) { x = 720; y = 480; fps = 60; break; }
					}
					MST3367_SetRegister( pDevice, 0x00, 0x54, R0054_BACKUP );
			
					MST3367_SetRegister( pDevice, 0x00, 0x0E, R000E_BACKUP );
				}
			}
			if( (wx >= (600 - 5)) && (wx <= (600 + 5)) && (fv >= (750 - 10)) && (fv <= (750 + 10)) ) {
				
				BYTE R14 = MST3367_GetRegister( pDevice, 0x00, 0x14 );

				if( (R14 & 0x24) == (0x24) ) {

					x = 1024; y = 768; fps = 75;
				}
				else {					

					x = 1280; y = 768; fps = 75; 

				//	x = 1360; y = 768; fps = 75; 
				}
			}
			if( (wx >= (685 - 5)) && (wx <= (685 + 5)) && (fv >= (850 - 10)) && (fv <= (850 + 10)) ) {
				
				BYTE R14 = MST3367_GetRegister( pDevice, 0x00, 0x14 );

				if( (R14 & 0x24) == (0x24) ) {

					x = 1024; y = 768; fps = 85;
				}
				else {					

					x = 1280; y = 768; fps = 85; 

				//	x = 1360; y = 768; fps = 85; 
				}
			}
			if( (fps == 0) || (x == 0) || (y == 0) ) {

				if( pDevice->m_nAnalogCrossbarVideoInputProperty != 3 ) { goto EXIT_AUTO; }

				if( pSysCfg->b_input_video_resolution_vga_period_us_counts == 0 ) {

					pSysCfg->b_input_video_resolution_vga_h_period_us = n_signal_h_period_us;

					pSysCfg->b_input_video_resolution_vga_v_period_us = n_signal_v_period_us;

					pSysCfg->b_input_video_resolution_vga_h_period_us_sum = n_signal_h_period_us;

					pSysCfg->b_input_video_resolution_vga_v_period_us_sum = n_signal_v_period_us;

					pSysCfg->b_input_video_resolution_vga_period_us_counts = 1;
				}
				else {

					ULONG dx = 0;

					ULONG dy = 0;

					if( pSysCfg->b_input_video_resolution_vga_h_period_us > n_signal_h_period_us ) {

						dx = pSysCfg->b_input_video_resolution_vga_h_period_us - n_signal_h_period_us;
					}
					else {

						dx = n_signal_h_period_us - pSysCfg->b_input_video_resolution_vga_h_period_us;
					}
					if( pSysCfg->b_input_video_resolution_vga_v_period_us > n_signal_v_period_us ) {

						dy = pSysCfg->b_input_video_resolution_vga_v_period_us - n_signal_v_period_us;
					}
					else {

						dy = n_signal_v_period_us - pSysCfg->b_input_video_resolution_vga_v_period_us;
					}
					if( dx > 5 || 
						
						dy > 5 ) {

						pSysCfg->b_input_video_resolution_vga_period_us_counts = 0;

						pSysCfg->n_input_video_resolution_h_total = 0;

						MST3367_SetRegister( pDevice, 0x00, 0x04, 0x00 ); // PHASE
					}
					else if( pSysCfg->b_input_video_resolution_vga_period_us_counts < 10 ) {

						pSysCfg->b_input_video_resolution_vga_period_us_counts++;

						pSysCfg->b_input_video_resolution_vga_h_period_us_sum += n_signal_h_period_us;

						pSysCfg->b_input_video_resolution_vga_v_period_us_sum += n_signal_v_period_us;

						do_div(pSysCfg->b_input_video_resolution_vga_h_period_us_sum, pSysCfg->b_input_video_resolution_vga_period_us_counts);

						do_div(pSysCfg->b_input_video_resolution_vga_v_period_us_sum, pSysCfg->b_input_video_resolution_vga_period_us_counts);

						pSysCfg->b_input_video_resolution_vga_h_period_us = pSysCfg->b_input_video_resolution_vga_h_period_us_sum;

						pSysCfg->b_input_video_resolution_vga_v_period_us = pSysCfg->b_input_video_resolution_vga_v_period_us_sum;

					}
				}
#if 1
				//F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] b_input_video_resolution_vga_period_us_counts( 0d%d )\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, pSysCfg->b_input_video_resolution_vga_period_us_counts );

				if( pSysCfg->b_input_video_resolution_vga_period_us_counts >= 10 ) {

					if( pSysCfg->n_input_video_resolution_h_total > 0 ) {

						x = pSysCfg->n_input_video_resolution_cx;

						y = pSysCfg->n_input_video_resolution_cy;

						fps = pSysCfg->n_input_video_resolution_fps;

						F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] x(0d%d) y(0d%d) fps(0d%d)\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, x, y, fps );
	
						goto EXIT_AUTO;
					}
					{	ULONG hperiod_us = pSysCfg->b_input_video_resolution_vga_h_period_us;

						ULONG vperiod_us = pSysCfg->b_input_video_resolution_vga_v_period_us;
					
						ULONG wx = (hperiod_us > 0) ? (1600000 / hperiod_us) : (0); // H.TOTAL (H.FREQ)

						n_signal_h_total = (wx > 0) ? (ULONG)(((1650000 / wx) / 8) * 8) : (0);
						
						n_signal_v_total = (hperiod_us > 0) ? (ULONG)((vperiod_us * 16 * 80 + (hperiod_us / 2)) / hperiod_us) : (0);

						n_signal_v_period = (ULONG)(wx);

						if( n_signal_h_total > 4000 ) { 

							n_signal_h_total = 4000;
						}
					}

					// -----> SetADParameters()
					//
					{	WORD dotclock;

						BYTE pllgain, clpdly, clpdur, hsopw, adc_bw0, adc_bw1;

						LONGLONG tmp = n_signal_h_period;

						dotclock = (WORD)(((DWORD)n_signal_h_period * n_signal_h_total + 5000) / 10000);

						clpdly = 0x8;	

						if( dotclock < 30 ) {

							pllgain = 0x00 + 0x8;
							
							clpdur  = 0x08;
							
							hsopw   = 0x18;
							
							adc_bw0 = 0x44;
							
							adc_bw1 = 0x04;
						}
						else if( dotclock < 75 ) {

							pllgain = 0x40 + 0x18;
							
							clpdur = 0x20;
							
							hsopw = 0x30;
							
							adc_bw0 = 0x33;
							
							adc_bw1 = 0x03;
						}
						else if( dotclock < 100 ) {

							pllgain = 0x80 + 0x20;

							clpdur = 0x20;
							
							hsopw = 0x30;
							
							adc_bw0 = 0x11;
							
							adc_bw1 = 0x01;
						}
						else {

							pllgain = 0xC0 + 0x28;

							clpdur = 0x30;
							
							hsopw = 0x60;
							
							adc_bw0 = 0x00;
							
							adc_bw1 = 0x00;
						}
   						MST3367_SetRegister( pDevice, 0x00, 0x03, pllgain );

   						MST3367_SetRegister( pDevice, 0x00, 0x05, clpdly );

   						MST3367_SetRegister( pDevice, 0x00, 0x06, clpdur );

   						MST3367_SetRegister( pDevice, 0x00, 0x07, hsopw );

   						MST3367_SetRegister( pDevice, 0x00, 0x1E, adc_bw0 );

   						MST3367_SetRegister( pDevice, 0x00, 0x1F, adc_bw1 );

   					//	MST3367_SetRegister( pDevice, 0x00, 0xB5, 0x00 );
					}
					// -----> ADCSetAutoDetectFormat()
					//
					{	MST3367_SetRegister( pDevice, 0x00, 0x01, (BYTE)((n_signal_h_total - 1) >> 4) );

						MST3367_SetRegister( pDevice, 0x00, 0x02, (BYTE)((n_signal_h_total - 1) << 4) );

						MST3367_SetRegister( pDevice, 0x00, 0x0B, 0x80 ); // GRADE SCALE

						MST3367_SetRegister( pDevice, 0x00, 0x0C, 0x80 );

						MST3367_SetRegister( pDevice, 0x00, 0x0D, 0x80 );

						MST3367_SetRegister( pDevice, 0x00, 0x08, 0x80 );

						MST3367_SetRegister( pDevice, 0x00, 0x09, 0x80 );

						MST3367_SetRegister( pDevice, 0x00, 0x0A, 0x80 );
					}
					ULONG tempx = MST3367_GetRegister( pDevice, 0x00, 0x14 );

					ULONG hv_polarity = ((tempx & 0x20) >> 4) |
						
									    ((tempx & 0x04) >> 2);	  	

					hv_polarity |= (MST3367_GetRegister( pDevice, 0x00, 0x5F ) & 0x02) << 1;

	  				MST3367_SetRegister( pDevice, 0x00, 0xB2, (BYTE)((hv_polarity & 0x03) ^ 0x03) );

					MST3367_SetRegister( pDevice, 0x00, 0xE2, 0x80 ); // ENABLE AUTO POSITION

					MST3367_SetRegister( pDevice, 0x00, 0xE3, 0x00 ); // REPORT DIGITAL DE WINDOW

					{	ULONG i = 1;

						ULONG tempy = 0;

						while( TRUE ) {

	    					MST3367_SetRegister( pDevice, 0x00, 0xE4, (BYTE)(0x32 * i) );

							LONGLONG ts = n_signal_detect_delay;

							ts *= 10000;

							//F6B9E557A4BA24ffd926B820B836289C8_100NS( ts );
							wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies( 1 ) );

							ULONG n_signal_test_h_start = ((MST3367_GetRegister( pDevice, 0x00, 0xF4 ) & 0x0F) << 8) | 

														  ((MST3367_GetRegister( pDevice, 0x00, 0xF3 ) & 0xFF) << 0);

							tempx = n_signal_test_h_start / 8;

							if( tempx != 0 ) {

								if( tempy >= tempx ) { break; }

								tempy = tempx;
							}
							i++;

							if( i > 5 ) { i = 5; break; }
						}
    					MST3367_SetRegister( pDevice, 0x00, 0xE4, (BYTE)(0x32 * i - 0x16) );

						LONGLONG ts = n_signal_detect_delay;

						ts *= 10000 * 2;

						//F6B9E557A4BA24ffd926B820B836289C8_100NS( ts );
						wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies( 1 ) );

					}
					
					n_signal_h_start = ((MST3367_GetRegister( pDevice, 0x00, 0xF4 ) & 0x0F) << 8) | 

									   ((MST3367_GetRegister( pDevice, 0x00, 0xF3 ) & 0xFF) << 0);

					ULONG n_signal_h_end = ((MST3367_GetRegister( pDevice, 0x00, 0xF6 ) & 0x0F) << 8) | 

										   ((MST3367_GetRegister( pDevice, 0x00, 0xF5 ) & 0xFF) << 0);

					n_signal_v_start = ((MST3367_GetRegister( pDevice, 0x00, 0xF8 ) & 0x0F) << 8) | 

									   ((MST3367_GetRegister( pDevice, 0x00, 0xF7 ) & 0xFF) << 0);

					ULONG n_signal_v_end = ((MST3367_GetRegister( pDevice, 0x00, 0xFA ) & 0x0F) << 8) | 

										   ((MST3367_GetRegister( pDevice, 0x00, 0xF9 ) & 0xFF) << 0);

					ULONG n_signal_v_width = (MST3367_GetRegister( pDevice, 0x00, 0x6D ) & 0x1F);

					n_signal_v_start = ((n_signal_v_start + 1));

					n_signal_v_end   = ((n_signal_v_end + 1));

					n_signal_h_start = ((n_signal_h_start + 4) / 8) * 8;

					n_signal_h_end   = ((n_signal_h_end + 4) / 8) * 8;

					ULONG    n_signal_h_width = ((n_signal_h_start + 12) / 24) * 8;

					ULONG n_calc_cx = n_signal_h_end - n_signal_h_start + 0;

					ULONG n_calc_cy = n_signal_v_end - n_signal_v_start + 1;

					ULONG    n_aspect_ratio = pDevice->m_nCustomAnalogVideoVgaAspectRatioProperty;

					ULONG temp = n_calc_cx;

					F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] MST3367_ADC_MODE_DETECT_AUTO( hs:%d x he:%d x vs:%d x ve:%d x hw:%d x ax:%d x ay:%d )", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, n_signal_h_start, n_signal_h_end, n_signal_v_start, n_signal_v_end, n_signal_h_width, (LONG)(n_calc_cx), (LONG)(n_calc_cy));

					if( n_aspect_ratio == 0 ) { // 4 : 3

						n_calc_cx = (((n_calc_cy *  4) / 3 + 4) / 8) * 8;
					}
					else if( n_aspect_ratio == 1 ) { // 5 : 4

						n_calc_cx = (((n_calc_cy * 5) / 4 + 4) / 8) * 8;
					}
					else if( n_aspect_ratio == 2 ) { // 16 : 9

						n_calc_cx = (((n_calc_cy * 16) / 9 + 4) / 8) * 8;
					}
					else if( n_aspect_ratio == 3 ) { // 16 : 10

						n_calc_cx = (((n_calc_cy * 16) / 10 + 4) / 8) * 8;
					}
					else if( n_aspect_ratio == 4 ) { // 3 : 2

						n_calc_cx = (((n_calc_cy * 3) / 2 + 4) / 8) * 8;
					}
					else if( n_aspect_ratio == 5 ) { // 1 : 1

						n_calc_cx = (((n_calc_cy * 1) / 1 + 4) / 8) * 8;
					}
					else {

						n_calc_cx = pDevice->m_nCustomAnalogVideoVgaHActiveProperty;

						if( n_calc_cx == 0 ) {

							n_calc_cx = (((n_calc_cy * 16) / 9 + 4) / 8) * 8;
						}
					}
				//	if( n_calc_cx > temp ) {
				//
				//		n_calc_cx = (((n_calc_cy * 5) / 4 + 4) / 8) * 8; // 5 : 4
				//	}
					if( n_calc_cx < 640 ) {

						n_calc_cx = 640;
					}
					if( (temp != 0) && ( (temp + 4) != 0) ) {

	    				n_signal_h_start = (ULONG)((((n_signal_h_start * n_calc_cx) / temp + 4) / 8) * 8);

	    				n_signal_h_total = (ULONG)((((n_signal_h_total * n_calc_cx) / temp + 4) / 8) * 8);
					}
					LONGLONG n_calc_sz = n_calc_cx * n_calc_cy;

					F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] MST3367_ADC_MODE_DETECT_AUTO( ht:%d x vt:%d x hs:%d x vs:%d x aw:%d x ah:%d )", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, (ULONG)(n_signal_h_total), (ULONG)(n_signal_v_total), n_signal_h_start, n_signal_v_start, (LONG)(n_calc_cx), (LONG)(n_calc_cy));

					ULONG summary = 0;//pDevice->m_nCloneStreamPointerBaseCommonBufferSize[ 0 ] >> 1;

					if( summary <= (1920 * 1440) ) {

						summary = (1920 * 1440);
					}
					if( n_calc_sz <= summary &&
									
						n_calc_cx > 1 &&
						
						n_calc_cy > 1 &&
						
					   (n_calc_cx & 0x07) == 0 ) {

						x = (ULONG)(n_calc_cx);

						y = (ULONG)(n_calc_cy);

						fps = (fv + 5) / (10);

						pSysCfg->n_input_video_resolution_h_total = n_signal_h_total;

						if( (x * y * fps) > (80000000) ||
						
							(x * y) > (2073600) ) {

							pSysCfg->b_input_video_resolution_spliter_mode = TRUE;
						}
						else {

							pSysCfg->b_input_video_resolution_spliter_mode = FALSE;
						}
					}
					MST3367_SetRegister( pDevice, 0x00, 0xE2, 0x00 ); // DISABLE AUTO POSITION
				}
#endif
				;
EXIT_AUTO:
				;
			}
			else {

				pSysCfg->n_input_video_resolution_h_total = 0;

				pSysCfg->b_input_video_resolution_spliter_mode = FALSE;

				pSysCfg->b_input_video_resolution_vga_period_us_counts = 0;
			}
	
skip_to_setad:	

			if( x != 0 && y != 0 ) {

				ULONG m = MST3367_GET_FREQV( pDevice );

				if( pSysCfg->n_input_video_resolution_cx != x ||

					pSysCfg->n_input_video_resolution_cy != y ||
					
					pSysCfg->n_input_video_resolution_fps != fps ||
					
				//	pSysCfg->n_input_video_resolution_fps_m != m || // [2016.02.15]
					
					pSysCfg->n_input_video_resolution_v_total != vtotal ) {

					pSysCfg->n_input_video_resolution_cx = x;

					pSysCfg->n_input_video_resolution_cy = y;

					pSysCfg->n_input_video_resolution_fps = fps;

					pSysCfg->n_input_video_resolution_v_total = vtotal;

					pSysCfg->n_input_video_resolution_fps_m = m;

					if( pDevice->m_nAnalogCrossbarVideoInputProperty == 2 ) { // COMPONENT

						pSysCfg->n_input_video_resolution_color_colorimetry = (x == 720) ? 1 : 2;

						pSysCfg->n_input_video_resolution_color_range = 1;
					}
					else { // DVI.ANALOG

						pSysCfg->n_input_video_resolution_color_colorimetry = (x == 720) ? 1 : 2;

						pSysCfg->n_input_video_resolution_color_range = 2;
					}
					if( (pSysCfg->n_input_video_resolution_cx ==  720 && pSysCfg->n_input_video_resolution_cy == 240) ||

						(pSysCfg->n_input_video_resolution_cx ==  720 && pSysCfg->n_input_video_resolution_cy == 288) ||

						(pSysCfg->n_input_video_resolution_cx ==  768 && pSysCfg->n_input_video_resolution_cy == 288) ||

						(pSysCfg->n_input_video_resolution_cx == 1440 && pSysCfg->n_input_video_resolution_cy == 540) ||

						(pSysCfg->n_input_video_resolution_cx == 1920 && pSysCfg->n_input_video_resolution_cy == 540) ) {

						pSysCfg->n_input_video_resolution_interleaved = 1;
					}
					else {

						pSysCfg->n_input_video_resolution_interleaved = 0;
					}
					pSysCfg->n_input_audio_sampling_frequency = 48000;

					b_is_signal_changed = TRUE;
				}
				b_is_signal_vaild = TRUE;
			}
		}
		else {
					
			//make signal unplug/plug nothing changed
			//pSysCfg->n_input_video_resolution_cx = 0;

			//pSysCfg->n_input_video_resolution_cy = 0;

			//pSysCfg->n_input_video_resolution_fps = 0;

			//pSysCfg->n_input_video_resolution_fps_m = 0;

			pSysCfg->n_input_video_resolution_interleaved = 0;

			pSysCfg->n_input_video_resolution_h_total = 0;

			//make signal unplug/plug nothing changed
			//pSysCfg->n_input_video_resolution_v_total = 0;

			pSysCfg->n_input_video_resolution_hv_polarity = 0;

			pSysCfg->n_input_video_resolution_color_colorimetry = 0;

			pSysCfg->n_input_video_resolution_color_range = 0;

			pSysCfg->n_input_mode_index = 0xFFFF;

			pSysCfg->b_input_video_resolution_spliter_mode = FALSE;

			pSysCfg->b_input_video_resolution_vga_period_us_counts = 0;
		}
		if( b_is_signal_vaild ) {

			#if defined(AME_PL330B) || defined(AME_PL330A)
			B6DA6D73E4484C36B5A7CF9DFE4BBFB0( pDevice, pDevice->m_nAnalogVideoDecoderStatusProperty, 1 );
			#endif

			BYTE R005F = MST3367_GetRegister( pDevice, 0x00, 0x5F );

			if( pSysCfg->n_input_video_resolution_fps > 50 ) {

				pDevice->FD314ADAD9404496b842EBFC396E875CB = V4L2_STD_NTSC_M;
			}
			else if( pSysCfg->n_input_video_resolution_fps > 30 ) {

				pDevice->FD314ADAD9404496b842EBFC396E875CB = V4L2_STD_PAL_B;
			}
			else if( pSysCfg->n_input_video_resolution_fps > 25 ) {

				pDevice->FD314ADAD9404496b842EBFC396E875CB = V4L2_STD_NTSC_M;
			}
			else {

				pDevice->FD314ADAD9404496b842EBFC396E875CB = V4L2_STD_PAL_B;
			}
			pDevice->m_nCustomAnalogVideoResolutionProperty = (pSysCfg->n_input_video_resolution_cx << 16) |

															  (pSysCfg->n_input_video_resolution_cy <<  0);

			if( pSysCfg->n_input_video_resolution_fps == 59 ||

				pSysCfg->n_input_video_resolution_fps == 61 ) {

				pDevice->m_nCustomAnalogVideoFrameRateProperty = 60;
			}
			else if( pSysCfg->n_input_video_resolution_fps == 76 ) {

				pDevice->m_nCustomAnalogVideoFrameRateProperty = 75;
			}
			else {

				pDevice->m_nCustomAnalogVideoFrameRateProperty = pSysCfg->n_input_video_resolution_fps;
			}
			pDevice->m_nCustomAnalogVideoInterleavedProperty = pSysCfg->n_input_video_resolution_interleaved;

			pDevice->m_nCustomAnalogAudioSampleFrequencyProperty = 48000;

			pDevice->m_nAnalogVideoDecoderStatusProperty = 1;
#ifdef MEDICAL
			pDevice->m_nAnalogCopyProtMacrovisionProperty = 0;
#else
			pDevice->m_nAnalogCopyProtMacrovisionProperty = (R005F & 0x10) ? 1 : 0;
#endif
		}
		else {


			//pSysCfg->n_input_video_resolution_cx = 0;
			//pSysCfg->n_input_video_resolution_cy = 0;
			//pSysCfg->n_input_video_resolution_fps = 0;

			pDevice->m_nCustomAnalogVideoResolutionProperty = 0;
		
			pDevice->m_nCustomAnalogVideoFrameRateProperty = 0;

			pDevice->m_nCustomAnalogVideoInterleavedProperty = 0;

			pDevice->m_nCustomAnalogAudioSampleFrequencyProperty = 0;

			pDevice->m_nAnalogVideoDecoderStatusProperty = 0;

			pDevice->m_nAnalogCopyProtMacrovisionProperty = 0;
		}
		if( b_is_signal_changed ) {

			// -----> RxHandleVideoIn()
			//
			{	BYTE R00AB = MST3367_GetRegister( pDevice, 0x00, 0xAB ); R00AB &= 0x7F;

				MST3367_SetRegister( pDevice, 0x00, 0xAB, R00AB | 0x80 ); // BLANK.OUTPUT

				// H.TOTAL = PERIOD (PIXELS)
				//
				// V.TOTAL = PERIOD (LINES)
				//
				// H.START = BLANK - PULSE.F6B9E557A4BA24ffd926B820B836289C8 (PIXELS)
				//
				// V.START = BLANK - PULSE.F6B9E557A4BA24ffd926B820B836289C8 (LINES)
				//
				// NVDIA RULES: DMT -> CVT -> Total Pixels (?�個�? -> Total Pixels - Active Pixels - Front Porch (?�個�?

				ULONG j = (pDevice->m_nAnalogCrossbarVideoInputProperty == 3) ? (DEFAULT_MST3367_VESA_SIZE - 1) : (DEFAULT_MST3367_EIA_SIZE - 1);

				if( pSysCfg->n_input_mode_index != 0xFFFF ) {
					
					j = pSysCfg->n_input_mode_index;
					
					if( pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) {
						
						if( j <= (DEFAULT_MST3367_VESA_SIZE - 1) ) {
							
							goto set_ad_parameter;
						}
						else {
							
							F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] error n_input_mode_index(0x%x)---!!! 444???\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, pSysCfg->n_input_mode_index );
							
							pSysCfg->n_input_mode_index = 0xFFFF;

							return FALSE;
						}
					}
					else {
						
						if( j <= (DEFAULT_MST3367_EIA_SIZE - 1) ) {
							
							goto set_ad_parameter;
						}
						else {
							
							F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] error n_input_mode_index(0x%x)---!!! 555???\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, pSysCfg->n_input_mode_index );

							pSysCfg->n_input_mode_index = 0xFFFF;

							return FALSE;
						}
					}
				}

				if( pSysCfg->n_input_video_resolution_h_total > 0 ) {

					ULONG * p = NULL;

					if( pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) { // DVI.ANALOG

						p = &(RX_ADC_SET_VALUES_VESA[ j ][ 0 ]);

					}
					else { // COMPONENT

						p = &(RX_ADC_SET_VALUES_EIA[ j ][ 0 ]);
					}
					p[ 0 ] = 0xE8; 
					
					p[ 1 ] = 0x08; 
						
					p[ 2 ] = 0x30; 
						
					p[ 3 ] = 0x60; 
					
					p[ 4 ] = 0x00;
						
					p[ 5 ] = 0x00;
						
					p[ 6 ] = n_signal_h_total;
						
					p[ 7 ] = n_signal_v_total;
						
					p[ 8 ] = n_signal_h_start;
						
					p[ 9 ] = n_signal_v_start;
				}
				else {

					j--;

					for( ; j > 0 ; j-- ) {
	
						if( pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) { // DVI.ANALOG
	
							if( RX_ADC_SET_VALUES_VESA[ j ][ 10 ] == pSysCfg->n_input_video_resolution_cx &&
								
								RX_ADC_SET_VALUES_VESA[ j ][ 11 ] == pSysCfg->n_input_video_resolution_cy &&
								
								RX_ADC_SET_VALUES_VESA[ j ][ 12 ] == pSysCfg->n_input_video_resolution_fps ) {

								F1838C0176E054c129B7F2BF440D1236E( KERN_INFO, "[%02d] DVI.ANALOG j(%d)\n", (int)(pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE), j );
	
								break;
							}
						}
						else { // COMPONENT
	
							if( RX_ADC_SET_VALUES_EIA[ j ][ 10 ] == pSysCfg->n_input_video_resolution_cx &&
								
								RX_ADC_SET_VALUES_EIA[ j ][ 11 ] == pSysCfg->n_input_video_resolution_cy &&
								
								RX_ADC_SET_VALUES_EIA[ j ][ 12 ] == pSysCfg->n_input_video_resolution_fps ) {
	
								break;
							}
						}
					}
				}
set_ad_parameter:

				if( pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) { // DVI.ANALOG

					MST3367_SetRegister( pDevice, 0x00, 0x03, (BYTE)(RX_ADC_SET_VALUES_VESA[ j ][ 0 ]) );

					MST3367_SetRegister( pDevice, 0x00, 0x05, (BYTE)(RX_ADC_SET_VALUES_VESA[ j ][ 1 ]) );

					MST3367_SetRegister( pDevice, 0x00, 0x06, (BYTE)(RX_ADC_SET_VALUES_VESA[ j ][ 2 ]) );

//					MST3367_SetRegister( pDevice, 0x00, 0x07, (BYTE)(RX_ADC_SET_VALUES_VESA[ j ][ 3 ]) );

					MST3367_SetRegister( pDevice, 0x00, 0x07, (BYTE)(RX_ADC_SET_VALUES_VESA[ j ][ 17 ]) ); // HSYNC PULSE WIDTH FROM VGA RESOLUTION TABLE [2015.10.16]

					MST3367_SetRegister( pDevice, 0x00, 0x1E, (BYTE)(RX_ADC_SET_VALUES_VESA[ j ][ 4 ]) );

					MST3367_SetRegister( pDevice, 0x00, 0x1F, (BYTE)(RX_ADC_SET_VALUES_VESA[ j ][ 5 ]) );

					if( pSysCfg->n_input_video_resolution_h_total > 0 ) {

						if( (pSysCfg->n_input_video_resolution_cx * pSysCfg->n_input_video_resolution_cy * pSysCfg->n_input_video_resolution_fps) > (80000000) ||
						
							(pSysCfg->n_input_video_resolution_cx * pSysCfg->n_input_video_resolution_cy) > (2073600) ) {

							pSysCfg->b_input_video_resolution_spliter_mode = TRUE;
						}
						else {

							pSysCfg->b_input_video_resolution_spliter_mode = FALSE;
						}
					}

					MST3367_SetRegister( pDevice, 0x00, 0x01, (BYTE)((RX_ADC_SET_VALUES_VESA[ j ][ 6 ] - 1) >> 4) );

					MST3367_SetRegister( pDevice, 0x00, 0x02, (BYTE)((RX_ADC_SET_VALUES_VESA[ j ][ 6 ] - 1) << 4) );

					MST3367_SetRegister( pDevice, 0x00, 0x0B, 0x7A ); // GRADE SCALE

					MST3367_SetRegister( pDevice, 0x00, 0x0C, 0x7A );

					MST3367_SetRegister( pDevice, 0x00, 0x0D, 0x7A );

					MST3367_SetRegister( pDevice, 0x00, 0x08, 0x9E );

					MST3367_SetRegister( pDevice, 0x00, 0x09, 0x9E ); 

					MST3367_SetRegister( pDevice, 0x00, 0x0A, 0x9E ); 

				//	MST3367_SetRegister( pDevice, 0x00, 0x1E, 0x44 ); 
				//
				//	MST3367_SetRegister( pDevice, 0x00, 0x1F, 0x04 ); 

					BYTE R0010 = MST3367_GetRegister( pDevice, 0x00, 0x10 ); R0010 &= ~0x05; R0010 |= 0x00;

					MST3367_SetRegister( pDevice, 0x00, 0x10, R0010 );

					MST3367_SetRegister( pDevice, 0x00, 0x18, 0x00 );

					MST3367_SetRegister( pDevice, 0x00, 0x19, 0x00 );

					MST3367_SetRegister( pDevice, 0x00, 0x1A, 0x00 );

					MST3367_SetRegister( pDevice, 0x00, 0x39, 0x00 );

					MST3367_SetRegister( pDevice, 0x00, 0x2C, 0xCC );
					
					/////////////////////////////////////////////////////////////////////////

					BYTE R0060 = MST3367_GetRegister( pDevice, 0x00, 0x60 );

					MST3367_SetRegister( pDevice, 0x00, 0x60, R0060 & ~0x04 );
				}
				else { // COMPONENT

					MST3367_SetRegister( pDevice, 0x00, 0x03, (BYTE)(RX_ADC_SET_VALUES_EIA[ j ][ 0 ]) );

					MST3367_SetRegister( pDevice, 0x00, 0x05, (BYTE)(RX_ADC_SET_VALUES_EIA[ j ][ 1 ]) );

					MST3367_SetRegister( pDevice, 0x00, 0x06, (BYTE)(RX_ADC_SET_VALUES_EIA[ j ][ 2 ]) );

					MST3367_SetRegister( pDevice, 0x00, 0x07, (BYTE)(RX_ADC_SET_VALUES_EIA[ j ][ 3 ]) );

					MST3367_SetRegister( pDevice, 0x00, 0x1E, (BYTE)(RX_ADC_SET_VALUES_EIA[ j ][ 4 ]) );

					MST3367_SetRegister( pDevice, 0x00, 0x1F, (BYTE)(RX_ADC_SET_VALUES_EIA[ j ][ 5 ]) );

					if( pSysCfg->n_input_video_resolution_h_total > 0 ) {

						if( (pSysCfg->n_input_video_resolution_cx * pSysCfg->n_input_video_resolution_cy * pSysCfg->n_input_video_resolution_fps) > (80000000) ||
						
							(pSysCfg->n_input_video_resolution_cx * pSysCfg->n_input_video_resolution_cy) > (2073600) ) {

							pSysCfg->b_input_video_resolution_spliter_mode = TRUE;
						}
						else {

							pSysCfg->b_input_video_resolution_spliter_mode = FALSE;
						}
					}
					MST3367_SetRegister( pDevice, 0x00, 0x01, (BYTE)((RX_ADC_SET_VALUES_EIA[ j ][ 6 ] - 1) >> 4) );

					MST3367_SetRegister( pDevice, 0x00, 0x02, (BYTE)((RX_ADC_SET_VALUES_EIA[ j ][ 6 ] - 1) << 4) );

					BYTE R0010 = MST3367_GetRegister( pDevice, 0x00, 0x10 ); R0010 &= ~0x05; R0010 |= 0x05;

					MST3367_SetRegister( pDevice, 0x00, 0x10, R0010 );

					BYTE R000F = MST3367_GetRegister( pDevice, 0x00, 0x0F ); R000F &= ~0x20; R000F |= 0x20;

					MST3367_SetRegister( pDevice, 0x00, 0x0F, R000F );

					MST3367_SetRegister( pDevice, 0x00, 0x12, 0x04 );

					BYTE R0017 = MST3367_GetRegister( pDevice, 0x00, 0x17 ); R0017 &= ~0x02; R0017 |= 0x02;

					MST3367_SetRegister( pDevice, 0x00, 0x17, R0017 );

					MST3367_SetRegister( pDevice, 0x00, 0x0B, 0x80 ); // GRADE SCALE

					MST3367_SetRegister( pDevice, 0x00, 0x0C, 0x70 );

					MST3367_SetRegister( pDevice, 0x00, 0x0D, 0x80 );

					MST3367_SetRegister( pDevice, 0x00, 0x08, 0xC0 );

					MST3367_SetRegister( pDevice, 0x00, 0x09, 0xC0 ); 

					MST3367_SetRegister( pDevice, 0x00, 0x0A, 0xC0 ); 

				//	MST3367_SetRegister( pDevice, 0x00, 0x1E, 0x54 ); 
				//  
				//	MST3367_SetRegister( pDevice, 0x00, 0x1F, 0x05 ); 

					MST3367_SetRegister( pDevice, 0x00, 0x1B, 0x00 );

					MST3367_SetRegister( pDevice, 0x00, 0x1C, 0x00 );

					MST3367_SetRegister( pDevice, 0x00, 0x1D, 0x00 );

					MST3367_SetRegister( pDevice, 0x00, 0x18, 0x10 );

					MST3367_SetRegister( pDevice, 0x00, 0x19, 0x10 );

					MST3367_SetRegister( pDevice, 0x00, 0x1A, 0x10 );

					MST3367_SetRegister( pDevice, 0x00, 0x2D, 0x11 );

					MST3367_SetRegister( pDevice, 0x00, 0x2E, 0x11 );

					BYTE R002F = MST3367_GetRegister( pDevice, 0x00, 0x2F ); R002F &= ~0x02; R002F |= 0x02;

					MST3367_SetRegister( pDevice, 0x00, 0x2F, R002F );

					MST3367_SetRegister( pDevice, 0x00, 0x3A, 0x0C );

					MST3367_SetRegister( pDevice, 0x00, 0x3B, 0x08 );

					BYTE R0005 = MST3367_GetRegister( pDevice, 0x00, 0x05 );

					BYTE R0006 = MST3367_GetRegister( pDevice, 0x00, 0x06 );

					MST3367_SetRegister( pDevice, 0x00, 0x39, 0x88 + R0005 + R0006 );

					MST3367_SetRegister( pDevice, 0x00, 0x2C, 0x9D );

					/////////////////////////////////////////////////////////////////////////

					BYTE R0060 = MST3367_GetRegister( pDevice, 0x00, 0x60 );

					MST3367_SetRegister( pDevice, 0x00, 0x60, R0060 & ~0x04 );
				}
				 if( (pSysCfg->n_input_video_resolution_cx == 1440 && pSysCfg->n_input_video_resolution_cy == 240 && pSysCfg->n_input_video_resolution_fps == 60) ||

						 (pSysCfg->n_input_video_resolution_cx == 1440 && pSysCfg->n_input_video_resolution_cy == 288 && pSysCfg->n_input_video_resolution_fps == 50) ) {

					if( pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) { // DVI.ANALOG

						MST3367_SetRegister( pDevice, 0x00, 0xB1, 0xC1 ); // DEMPA RGB CONVERTER BOX
					}
					else { // COMPONENT

						MST3367_SetRegister( pDevice, 0x00, 0xB1, 0xC1 );
					}
				}
				else {
			
					MST3367_SetRegister( pDevice, 0x00, 0xB1, 0xC0 );
				}
				/////////////////////////////////////////////////////////////////////////

				BYTE R0014 = MST3367_GetRegister( pDevice, 0x00, 0x14 );

				BYTE R0080 = MST3367_GetRegister( pDevice, 0x00, 0x80 ); R0080 &= 0xF0;

				ULONG cx_start = (pDevice->m_nAnalogCrossbarVideoInputProperty == 3) ? (RX_ADC_SET_VALUES_VESA[ j ][ 8 ] - 1) : RX_ADC_SET_VALUES_EIA[ j ][ 8 ];

				ULONG cy_start = (pDevice->m_nAnalogCrossbarVideoInputProperty == 3) ? (RX_ADC_SET_VALUES_VESA[ j ][ 9 ] - 0) : RX_ADC_SET_VALUES_EIA[ j ][ 9 ];

				LONG  cx_offset = 0;

				LONG  cy_offset = 0;

				#if 1

				if( pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) {

					cx_offset = pSysCfg->n_input_video_resolution_offset_x_start_vesa[ j ];

					cy_offset = pSysCfg->n_input_video_resolution_offset_y_start_vesa[ j ];
				}
				else {

					cx_offset = pSysCfg->n_input_video_resolution_offset_x_start_eia[ j ];

					cy_offset = pSysCfg->n_input_video_resolution_offset_y_start_eia[ j ];
				}
				pSysCfg->n_input_video_resolution_offset_x_start_fetch = cx_start;

				pSysCfg->n_input_video_resolution_offset_y_start_fetch = cy_start;

				pSysCfg->n_input_video_resolution_offset_index = j;

				#endif

				cx_start += cx_offset;

				cy_start += cy_offset;

				F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "MST3367_ADC_GET_SYNC( %s x %02X )\n", (R0014 & 0x40) ? "SOG" : "HSYNC", R0014);

				MST3367_SetRegister( pDevice, 0x00, 0x80, R0080 | (BYTE)(cx_start >> 8) );

				MST3367_SetRegister( pDevice, 0x00, 0x81, (BYTE)(cx_start) );

				MST3367_SetRegister( pDevice, 0x00, 0x82, (BYTE)(pSysCfg->n_input_video_resolution_cx >> 8) );

				MST3367_SetRegister( pDevice, 0x00, 0x83, (BYTE)(pSysCfg->n_input_video_resolution_cx >> 0) );

				MST3367_SetRegister( pDevice, 0x00, 0x84, (BYTE)(cy_start) );

				MST3367_SetRegister( pDevice, 0x00, 0x85, (BYTE)(pSysCfg->n_input_video_resolution_cy >> 8) );

				if( pSysCfg->n_input_video_resolution_interleaved ) {

					BYTE R0085 = (BYTE)(pSysCfg->n_input_video_resolution_cy >> 8);

					MST3367_SetRegister( pDevice, 0x00, 0x85, R0085 |  0x20 );

					BYTE R0060 = MST3367_GetRegister( pDevice, 0x00, 0x60 );

					MST3367_SetRegister( pDevice, 0x00, 0x60, R0060 & ~0x04 );
				}
					if( ((pDevice->iProduct == 0xE5)) || 
				
				    ((pDevice->idVendor == 0x05CA) && (pDevice->idProduct == 0x0901)) ||

					((pDevice->idVendor == 0x04BB) && (pDevice->idProduct == 0x0543)) || // IODATA BOARD (UB535)
						
				    ((pDevice->idVendor == 0x0FD9) && (pDevice->idProduct == 0x004F)) || // ELGATO BOARD (UB535)

				    ((pDevice->idVendor == 0x0FD9) && (pDevice->idProduct == 0x005E)) || // ELGATO BOARD (UB535)

				    ((pDevice->idProduct & 0x0FF0) == 0x0530) ) {

					if( pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) {

						if( (pSysCfg->n_input_video_resolution_cx == 720 && pSysCfg->n_input_video_resolution_cy == 240 && pSysCfg->n_input_video_resolution_fps == 60) ||

							(pSysCfg->n_input_video_resolution_cx == 720 && pSysCfg->n_input_video_resolution_cy == 288 && pSysCfg->n_input_video_resolution_fps == 50) ||

							(pSysCfg->n_input_video_resolution_cx == 768 && pSysCfg->n_input_video_resolution_cy == 288 && pSysCfg->n_input_video_resolution_fps == 50) ) { // DEMPA RGB CONVERTER BOX

							BYTE R0060 = MST3367_GetRegister( pDevice, 0x00, 0x60 );

							MST3367_SetRegister( pDevice, 0x00, 0x60, R0060 | 0x04 );
						}
					}
				}
				MST3367_SetRegister( pDevice, 0x00, 0x86, (BYTE)(pSysCfg->n_input_video_resolution_cy >> 0) );

				#if defined(AME_PL330B) || defined(AME_PL330A)

				MST3367_SetRegister( pDevice, 0x00, 0x73, 0x00 );
				
				if( pDevice->m_nAnalogCrossbarVideoInputProperty == 2  || 
				
					pDevice->m_nAnalogCrossbarVideoInputProperty == 3 ) {

					if( pSysCfg->n_input_video_resolution_interleaved ) {
						
						MST3367_SetRegister( pDevice, 0x00, 0x73, 0x00 );

						MST3367_SetRegister( pDevice, 0x00, 0xB1, 0xC0 );
					}
					else {
						
						MST3367_SetRegister( pDevice, 0x00, 0x73, 0x80 );

						MST3367_SetRegister( pDevice, 0x00, 0xB1, 0xE0 );
					}
				}

				MST3367_SetRegister( pDevice, 0x00, 0xB2, 0x08 );

				#endif

				if( pDevice->m_nAnalogCrossbarVideoInputProperty == 2 ) { // COMPONENT

					if( (pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy == 720 && pSysCfg->n_input_video_resolution_fps == 30) || 
						
						(pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy == 720 && pSysCfg->n_input_video_resolution_fps == 25) ||
						
						(pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy == 720 && pSysCfg->n_input_video_resolution_fps == 24) ) {

						MST3367_SetRegister( pDevice, 0x00, 0x12, 0x00 );
					}
					else {

						MST3367_SetRegister( pDevice, 0x00, 0x12, 0x04 );
					}
				}
				MST3367_SetRegister( pDevice, 0x00, 0xAB, R00AB ); // NORMAL.OUTPUT
			}
			// -----> RxHandleVideoOut()
			//
			{	MST3367_SETUP_CSC_TABLE( pDevice );

				MST3367_ADC_AUTO_PHASE( pDevice );

//				MST3367_ADJUST_CSC_TABLE( pDevice, (BYTE)(pDevice->m_nAnalogVideoProcAmpBrightnessProperty[ 0 ] & 0xFF), 
					
//												   (BYTE)(pDevice->m_nAnalogVideoProcAmpContrastProperty[ 0 ] & 0xFF), 
												   
//												   (BYTE)(pDevice->m_nAnalogVideoProcAmpSaturationProperty[ 0 ] & 0xFF), 
												   
//												   (BYTE)(pDevice->m_nAnalogVideoProcAmpHueProperty[ 0 ] & 0xFF), 
												   
//												  ((BYTE)(pDevice->m_nAnalogVideoProcAmpSharpnessProperty[ 0 ] & 0xFF) >> 5) ); // ?�簡?�解, �?��?�該要追究哪??REG �??SEGA 跳�??��?

				MST3367_ADJUST_CSC_TABLE( pDevice, (BYTE)(FADD02C9C13B14f83989880EFACB8D8DC[ pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE * 1 ][ 0 ] & 0xFF), 
					
												   (BYTE)(F3A66BD0F0BCB4afcAD006E378E671B9A[ pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE * 1 ][ 0 ] & 0xFF), 
												   
												   (BYTE)(F925442591E22492f9239C6028CE3DD94[ pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE * 1 ][ 0 ] & 0xFF), 
												   
												   (BYTE)(F42BAA55A84E847faA4D0C0565699845E[ pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE * 1 ][ 0 ] & 0xFF),

												   (BYTE)(F1D56E1ED762E4b99BB2BD370DFE317D1[ pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE * 1 ][ 0 ] & 0xFF));

			}
			pSysCfg->b_input_video_signal_changed = TRUE;

			#ifdef ENABLE_1920X1080PX60FPS // +SC500

			// FPGA
			// 
			#ifndef AME_PL330A
			if( (pDevice->iManufacturer == 0x01 && pDevice->iProduct == 0x07) ||
				
				(pDevice->iManufacturer == 0x04 && pDevice->iProduct == 0x07) ||
				
				(pDevice->iManufacturer == 0x0A && pDevice->iProduct == 0x07) ||

				(pDevice->iManufacturer == 0x10) ||
				
				(pDevice->iManufacturer == 0x16) ||
				
				(pDevice->iManufacturer == 0x17) ||

				(pDevice->iManufacturer == 0x1F) ||
				
			   ((pDevice->iManufacturer & 0xF0) == 0x00 &&
			   
			    (pDevice->iProduct & 0x0F) == 0x05) ) {

				ULONG is_spliter_mode = FALSE;

				if( (pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy ==  768 && pSysCfg->n_input_video_resolution_fps == 85) ||

					(pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy ==  800 && pSysCfg->n_input_video_resolution_fps == 85) ||

					(pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy ==  960 && pSysCfg->n_input_video_resolution_fps == 75) ||

					(pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy ==  960 && pSysCfg->n_input_video_resolution_fps == 85) ||

					(pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy == 1024 && pSysCfg->n_input_video_resolution_fps == 75) ||

					(pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy == 1024 && pSysCfg->n_input_video_resolution_fps == 85) ||

					(pSysCfg->n_input_video_resolution_cx == 1400 && pSysCfg->n_input_video_resolution_cy == 1050 && pSysCfg->n_input_video_resolution_fps >   0) ||

					(pSysCfg->n_input_video_resolution_cx == 1440 && pSysCfg->n_input_video_resolution_cy ==  900 && pSysCfg->n_input_video_resolution_fps == 75) ||

					(pSysCfg->n_input_video_resolution_cx == 1440 && pSysCfg->n_input_video_resolution_cy ==  900 && pSysCfg->n_input_video_resolution_fps == 85) ||

					(pSysCfg->n_input_video_resolution_cx == 1680 && pSysCfg->n_input_video_resolution_cy == 1050 && pSysCfg->n_input_video_resolution_fps == 60) ||

					(pSysCfg->n_input_video_resolution_cx == 1680 && pSysCfg->n_input_video_resolution_cy == 1050 && pSysCfg->n_input_video_resolution_fps == 50) ||

					(pSysCfg->n_input_video_resolution_cx == 1920 && pSysCfg->n_input_video_resolution_cy == 1080 && pSysCfg->n_input_video_resolution_fps == 60) ||

					(pSysCfg->n_input_video_resolution_cx == 1920 && pSysCfg->n_input_video_resolution_cy == 1080 && pSysCfg->n_input_video_resolution_fps == 61) ||

					(pSysCfg->n_input_video_resolution_cx == 1920 && pSysCfg->n_input_video_resolution_cy == 1080 && pSysCfg->n_input_video_resolution_fps == 50) ||

					(pSysCfg->n_input_video_resolution_cx == 1600 && pSysCfg->n_input_video_resolution_cy ==  900 && pSysCfg->n_input_video_resolution_fps >   0) ||

					(pSysCfg->n_input_video_resolution_cx == 1600 && pSysCfg->n_input_video_resolution_cy == 1200 && pSysCfg->n_input_video_resolution_fps >   0) ||

					(pSysCfg->n_input_video_resolution_cx == 1920 && pSysCfg->n_input_video_resolution_cy == 1200 && pSysCfg->n_input_video_resolution_fps >   0) ||

					(pSysCfg->n_input_video_resolution_cx == 3840 && pSysCfg->n_input_video_resolution_cy == 1024 && pSysCfg->n_input_video_resolution_fps >   0) ) {

					if( pSysCfg->n_input_video_resolution_cy == 1200 ) {

						FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x24, 0x01 );
					}
					else {

						FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x24, 0x00 );
					}
					is_spliter_mode = TRUE;
				}
				else if( pSysCfg->n_input_video_resolution_h_total > 0 ) {

					is_spliter_mode = pSysCfg->b_input_video_resolution_spliter_mode;

					FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x24, 0x00 );
				}
				else {

					is_spliter_mode = FALSE;
				}
				if( ((pDevice->iManufacturer & 0xF0) == 0x00 &&
			   
					 (pDevice->iProduct & 0x0F) == 0x05) ) { // FOR ALL SC500/SC502

					if( is_spliter_mode ) {

						FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x21, 0x01 ); // BYPASS.MODE

						FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x21, 0x00 ); // SPLIT.MODE
					}
					else {

						FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x21, 0x00 ); // SPLIT.MODE

						FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x21, 0x01 ); // BYPASS.MODE
					}
				}
				else {

					if( is_spliter_mode ) {

						ULONG R0000E004 = A77C4935F8134B048348571A43F2A9CA( pDevice, 0x0000E000 + 0x0004 ); // GPIO.WR
						
						R0000E004 |=  0x00020000;

						A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 );

						R0000E004 &= ~0x00020000; // SPLITER.MODE

						A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 );
					}
					else {

						ULONG R0000E004 = A77C4935F8134B048348571A43F2A9CA( pDevice, 0x0000E000 + 0x0004 ); // GPIO.WR

						R0000E004 &= ~0x00020000;

						A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 );

						R0000E004 |=  0x00020000; // BYPASS.MODE

						A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 );
					}
				}
			}
			#endif
			#endif
		}
	}
	if( pDevice->m_nAnalogCrossbarVideoInputProperty == 0 ||  // HDMI (TMDS.B)

		pDevice->m_nAnalogCrossbarVideoInputProperty == 1 ) { // DVI.DIGITAL (TMDS.A)

		ULONG n_signal_h_total = 0;
		
		ULONG n_signal_v_total = 0;
		
		ULONG n_signal_h_period = 0; 
		
		ULONG n_signal_v_period = 0;
		
		ULONG n_signal_detect_delay = 0;

		ULONGLONG n_signal_lock_status = MST3367_HDMI_MODE_DETECT( pDevice, &n_signal_h_total, &n_signal_v_total, &n_signal_h_period, &n_signal_v_period, &n_signal_detect_delay );


		BOOLEAN b_is_signal_vaild = FALSE;

		BOOLEAN b_is_signal_changed = FALSE;

		if( n_signal_lock_status & 0x8000000000000000 ) {

			BYTE  fi = (BYTE )((n_signal_lock_status & 0x4000000000000000) >> 62);

			ULONG fv = (ULONG)((n_signal_lock_status & 0x0FFF000000000000) >> 48); // n_signal_v_period

			ULONG cx = (ULONG)((n_signal_lock_status & 0x00000FFF00000000) >> 32); //

			ULONG wx = (ULONG)((n_signal_lock_status & 0x000000000FFF0000) >> 16); // n_signal_h_total

			ULONG wy = (ULONG)((n_signal_lock_status & 0x0000000000000FFF) >>  0); // n_signal_v_total

			ULONG x = 0;

			ULONG y = 0;

			ULONG fps = 0;

			if( (cx ==  720 && wy ==  262) ) { x = 720; y = 240; fps = 60; }

			if( (cx ==  720 && wy ==  263) ) { x = 720; y = 240; fps = 60; }
			
			if( (cx == 1440 && wy ==  262) ) { x = 720; y = 240; fps = 60; }

			if( (cx == 1440 && wy ==  263) ) { x = 720; y = 240; fps = 60; }

			if( (cx ==  720 && wy ==  312) ) { x = 720; y = 288; fps = 50; }

			if( (cx ==  720 && wy ==  313) ) { x = 720; y = 288; fps = 50; }

			if( (cx == 1440 && wy ==  312) ) { x = 720; y = 288; fps = 50; }

			if( (cx == 1440 && wy ==  313) ) { x = 720; y = 288; fps = 50; }

			if( (cx ==  720 && wy ==  525) ) { x = 720; y = 480; fps = 60; }

			if( (cx ==  720 && wy ==  625) ) { x = 720; y = 576; fps = 50; }

			if( (cx ==  720 && wy ==  446) ) { x = 720; y = 400; fps = 85; }

			if( (cx ==  832 && wy ==  654) ) { x = 832; y = 624; fps = 75; }

			if( (cx == 1440 && (wy & ~1) ==  262) ) { x = fi ? 720 : 1440; y = 240; fps = 60; }

			if( (cx == 1440 && (wy & ~1) ==  312) ) { x = fi ? 720 : 1440; y = 288; fps = 50; }

			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= ( 750 -  5)) && (wy <= ( 750 +  5)) && (fv >= (300 -  5)) && (fv <= (300 +  5)) ) { x = 1280; y  = 720; fps = 30; } 
			
			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= ( 750 -  5)) && (wy <= ( 750 +  5)) && (fv >= (250 -  5)) && (fv <= (250 +  5)) ) { x = 1280; y  = 720; fps = 25; } 
			
			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= ( 750 -  5)) && (wy <= ( 750 +  5)) && (fv >= (240 - 5)) && (fv <= (240 + 5)) ) { x = 1280; y  = 720; fps = 24; } 

			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= ( 778 -  5)) && (wy <= ( 778 +  5)) && (fv >= (590 - 5)) && (fv <= (590 + 5)) ) { x = 1280; y  = 720; fps = 59; } // TOSHIBA CAMERA

			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= ( 750 - 15)) && (wy <= ( 750 + 15)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { x = 1280; y  = 720; fps = 60; }

			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= ( 750 - 15)) && (wy <= ( 750 + 15)) && (fv >= (500 - 5)) && (fv <= (500 + 5)) ) { x = 1280; y  = 720; fps = 50; }

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= ( 562 - 15)) && (wy <= ( 562 + 15)) && (fv >= (1200 -  5)) && (fv <= (1200 +  5)) ) { x = 1920; y =  540; fps = 120; }

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= ( 562 - 15)) && (wy <= ( 562 + 15)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { x = 1920; y  = 540; fps = 60; }

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= ( 562 - 15)) && (wy <= ( 562 + 15)) && (fv >= (500 - 5)) && (fv <= (500 + 5)) ) { x = 1920; y =  540; fps = 50; }

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= (1125 - 15)) && (wy <= (1125 + 15)) && (fv >= (240 - 5)) && (fv <= (240 + 5)) ) { x = 1920; y = 1080; fps = 24; }

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= (1125 - 15)) && (wy <= (1125 + 15)) && (fv >= (300 - 5)) && (fv <= (300 + 5)) ) { x = 1920; y = 1080; fps = 30; }

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= (1125 - 15)) && (wy <= (1125 + 15)) && (fv >= (250 - 5)) && (fv <= (250 + 5)) ) { x = 1920; y = 1080; fps = 25; }

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= (1125 - 15)) && (wy <= (1125 + 15)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { x = 1920; y = 1080; fps = 60; }

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= (1125 - 15)) && (wy <= (1125 + 15)) && (fv >= (500 - 5)) && (fv <= (500 + 5)) ) { x = 1920; y = 1080; fps = 50; }

			BOOL is_cvte_lvds = FALSE;

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy ==         (0)) && (wy == (        0)) ) { x = 1920; y = 1080; fps = (fv + 5) / 10; is_cvte_lvds = true; } // LVDS

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= (1080 -  5)) && (wy <= (1080 +  5)) ) { x = 1920; y = 1080; fps = (fv + 5) / 10; is_cvte_lvds = true; } // LVDS

			if( (cx >= (1366 - 5)) && (cx <= (1366 + 5)) && (wy ==         (0)) && (wy == (        0)) ) { x = 1368; y =  768; fps = (fv + 5) / 10; is_cvte_lvds = true; } // LVDS

			if( (cx >= (1366 - 5)) && (cx <= (1366 + 5)) && (wy >= ( 768 -  5)) && (wy <= ( 768 +  5)) ) { x = 1368; y =  768; fps = (fv + 5) / 10; is_cvte_lvds = true; } // LVDS

			if( (cx >= (1440 - 5)) && (cx <= (1440 + 5)) && (wy ==         (0)) && (wy == (        0)) ) { x = 1440; y =  900; fps = (fv + 5) / 10; is_cvte_lvds = true; } // LVDS

			if( (cx >= (1440 - 5)) && (cx <= (1440 + 5)) && (wy >= ( 900 -  5)) && (wy <= ( 900 +  5)) ) { x = 1440; y =  900; fps = (fv + 5) / 10; is_cvte_lvds = true; } // LVDS

			if( (cx >= ( 960 - 5)) && (cx <= ( 960 + 5)) && (wy ==         (0)) && (wy == (        0)) ) { x =  960; y =  540; fps = (fv + 5) / 10; is_cvte_lvds = true; } // LVDS

			if( (cx >= ( 960 - 5)) && (cx <= ( 960 + 5)) && (wy >= ( 540 -  5)) && (wy <= ( 540 +  5)) ) { x =  960; y =  540; fps = (fv + 5) / 10; is_cvte_lvds = true; } // LVDS

			if( (cx >= ( 640 - 5)) && (cx <= ( 640 + 5)) && (wy >= ( 525 - 15)) && (wy <= ( 525 + 15)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { x =  640; y =  480; fps = 60; }
			
			if( (cx >= ( 640 - 5)) && (cx <= ( 640 + 5)) && (wy >= ( 520 - 15)) && (wy <= ( 520 + 15)) && (fv >= (720 - 8)) && (fv <= (720 + 8)) ) { x =  640; y =  480; fps = 72; }
			
			if( (cx >= ( 640 - 5)) && (cx <= ( 640 + 5)) && (wy >= ( 500 - 15)) && (wy <= ( 500 + 15)) && (fv >= (750 - 5)) && (fv <= (750 + 5)) ) { x =  640; y =  480; fps = 75; }
			
			if( (cx >= ( 640 - 5)) && (cx <= ( 640 + 5)) && (wy >= ( 509 - 15)) && (wy <= ( 509 + 15)) && (fv >= (850 - 5)) && (fv <= (850 + 5)) ) { x =  640; y =  480; fps = 85; }
			

			if( (cx >= ( 800 - 5)) && (cx <= ( 800 + 5)) && (wy >= ( 625 - 15)) && (wy <= ( 625 + 15)) && (fv >= (560 - 5)) && (fv <= (560 + 5)) ) { x =  800; y =  600; fps = 56; }
			
			if( (cx >= ( 800 - 5)) && (cx <= ( 800 + 5)) && (wy >= ( 628 - 15)) && (wy <= ( 628 + 15)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { x =  800; y =  600; fps = 60; }
			
			if( (cx >= ( 800 - 5)) && (cx <= ( 800 + 5)) && (wy >= ( 666 - 15)) && (wy <= ( 666 + 15)) && (fv >= (720 - 5)) && (fv <= (720 + 5)) ) { x =  800; y =  600; fps = 72; }
			
			if( (cx >= ( 800 - 5)) && (cx <= ( 800 + 5)) && (wy >= ( 625 - 15)) && (wy <= ( 625 + 15)) && (fv >= (750 - 5)) && (fv <= (750 + 5)) ) { x =  800; y =  600; fps = 75; }
			
			if( (cx >= ( 800 - 5)) && (cx <= ( 800 + 5)) && (wy >= ( 720 - 15)) && (wy <= ( 720 + 15)) && (fv >= (750 -  5)) && (fv <= (750 +  5)) ) { x =  800; y =  600; fps = 76; }
			
			if( (cx >= ( 800 - 5)) && (cx <= ( 800 + 5)) && (wy >= ( 631 - 15)) && (wy <= ( 631 + 15)) && (fv >= (850 - 5)) && (fv <= (850 + 5)) ) { x =  800; y =  600; fps = 85; }


			if( (cx >= (1024 - 5)) && (cx <= (1024 + 5)) && (wy >= ( 624 - 15)) && (wy <= ( 624 + 15)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { x = 1024; y =  600; fps = 60; }


			if( (cx >= (1024 - 5)) && (cx <= (1024 + 5)) && (wy >= ( 804 - 15)) && (wy <= ( 804 + 15)) && (fv >= (500 - 5)) && (fv <= (500 + 5)) ) { x = 1024; y =  768; fps = 50; }
			
			if( (cx >= (1024 - 5)) && (cx <= (1024 + 5)) && (wy >= ( 806 - 15)) && (wy <= ( 806 + 15)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { x = 1024; y =  768; fps = 60; }
			
			if( (cx >= (1024 - 5)) && (cx <= (1024 + 5)) && (wy >= ( 806 - 15)) && (wy <= ( 806 + 15)) && (fv >= (700 - 5)) && (fv <= (700 + 5)) ) { x = 1024; y =  768; fps = 70; }
			
			if( (cx >= (1024 - 5)) && (cx <= (1024 + 5)) && (wy >= ( 800 - 15)) && (wy <= ( 800 + 15)) && (fv >= (750 - 5)) && (fv <= (750 + 5)) ) { x = 1024; y =  768; fps = 75; }

			if( (cx >= (1024 - 5)) && (cx <= (1024 + 5)) && (wy >= ( 808 - 15)) && (wy <= ( 808 + 15)) && (fv >= (850 - 5)) && (fv <= (850 + 5)) ) { x = 1024; y =  768; fps = 85; }

			if( (cx >= (1038 - 5)) && (cx <= (1038 + 5)) && (wy >= ( 806 -  5)) && (wy <= ( 806 +  5)) && (fv >= (600 -  5)) && (fv <= (600 +  5)) ) { x = 1024; y =  768; fps = 60; }


			if( (cx >= (1064 - 5)) && (cx <= (1064 + 5)) && (wy >= ( 624 - 15)) && (wy <= ( 624 + 15)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { x = 1064; y =  600; fps = 60; }


			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= ( 600 - 25)) && (wy <= ( 600 + 25)) && (fv >= (300 -  5)) && (fv <= (300 +  5)) ) { x = 1280; y =  600; fps = 30; } // HITACHI DI-SC120R


			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= ( 798 - 15)) && (wy <= ( 798 + 15)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { x = 1280; y =  768; fps = 60; }


			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= ( 831 - 15)) && (wy <= ( 831 + 15)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { x = 1280; y =  800; fps = 60; }


			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= (1000 - 15)) && (wy <= (1000 + 15)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { x = 1280; y =  960; fps = 60; }


			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= (1057 - 15)) && (wy <= (1057 + 15)) && (fv >= (500 - 5)) && (fv <= (500 + 5)) ) { x = 1280; y = 1024; fps = 50; }

			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= (1082 -  5)) && (wy <= (1082 +  5)) && (fv >= (590 - 5)) && (fv <= (590 + 4)) ) { x = 1280; y = 1024; fps = 59; }

			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= (1066 -  5)) && (wy <= (1066 +  5)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { x = 1280; y = 1024; fps = 60; }

			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= (1066 -  5)) && (wy <= (1066 +  5)) && (fv >= (749 -  5)) && (fv <= (749 +  5)) ) { x = 1280; y = 1024; fps = 75; }

			if( (cx >= (1280 - 5)) && (cx <= (1280 + 5)) && (wy >= (1072 -  5)) && (wy <= (1072 +  5)) && (fv >= (849 -  5)) && (fv <= (849 +  5)) ) { x = 1280; y = 1024; fps = 85; }


			if( (cx >= (1360 - 5)) && (cx <= (1360 + 5)) && (wy >= ( 795 -  5)) && (wy <= ( 795 +  5)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { 

				if( (wx >= (1776 - 5)) && (wx <= (1776 + 5)) ) {

					x = 1360; y =  768; fps = 61; // SEGA

				}
				else {

					x = 1360; y =  768; fps = 60; 
				}
			}
			if( (cx >= (1152 - 5)) && (cx <= (1152 + 5)) && (wy >= ( 900 -  5)) && (wy <= ( 900 +  5)) && (fv >= (750 - 5)) && (fv <= (750 + 5)) ) { x = 1152; y =  864; fps = 75; }


		 // if( (cx >= (1400 - 5)) && (cx <= (1400 + 5)) && (wy >= (1089 -  5)) && (wy <= (1089 +  5)) && (fv >= (600 -  5)) && (fv <= (600 +  5)) ) { x = 1400; y = 1050; fps = 60; }
			
			if( (cx >= (1400 - 5)) && (cx <= (1400 + 5)) && (wy >= (1089 -  5)) && (wy <= (1089 +  5)) && (fv >= (600 -  5)) && (fv <= (600 +  5)) ) { x = 1392; y = 1050; fps = 60; }

			if( (cx >= (1400 - 5)) && (cx <= (1400 + 5)) && (wy >= (1080 -  5)) && (wy <= (1080 +  5)) && (fv >= (600 -  5)) && (fv <= (600 +  5)) ) { x = 1392; y = 1050; fps = 60; }

			if( (cx >= (1400 - 5)) && (cx <= (1400 + 5)) && (wy >= (1099 -  5)) && (wy <= (1099 +  5)) && (fv >= (750 -  5)) && (fv <= (750 +  5)) ) { x = 1392; y = 1050; fps = 75; }
			if( (cx >= (1400 - 5)) && (cx <= (1400 + 5)) && (wy >= (1089 -  5)) && (wy <= (1089 +  5)) && (fv >= (750 -  5)) && (fv <= (750 +  5)) ) { x = 1392; y = 1050; fps = 75; }

			if( (cx >= (1400 - 5)) && (cx <= (1400 + 5)) && (wy >= (1089 -  5)) && (wy <= (1089 +  5)) && (fv >= (850 -  5)) && (fv <= (850 +  5)) ) { x = 1392; y = 1050; fps = 85; }
			if( (cx >= (1400 - 5)) && (cx <= (1400 + 5)) && (wy >= (1099 -  5)) && (wy <= (1099 +  5)) && (fv >= (850 -  5)) && (fv <= (850 +  5)) ) { x = 1392; y = 1050; fps = 85; }

			if( (cx >= (1440 - 5)) && (cx <= (1440 + 5)) && (wy >= ( 934 -  5)) && (wy <= ( 934 +  5)) && (fv >= (600 - 5)) && (fv <= (600 + 5)) ) { x = 1440; y =  900; fps = 60; }


			if( (cx >= (1440 - 5)) && (cx <= (1440 + 5)) && (wy >= ( 557 -  5)) && (wy <= ( 557 +  5)) && (fv >= (500 - 5)) && (fv <= (500 + 5)) ) { x = 1440; y  = 540; fps = 50; }


			if( (cx >= (1680 - 5)) && (cx <= (1680 + 5)) && (wy >= (1080 - 10)) && (wy <= (1080 + 10)) && (fv >= (600 - 10)) && (fv <= (600 + 10)) ) { x = 1680; y = 1050; fps = 60; }

			if( (cx >= (1680 - 5)) && (cx <= (1680 + 5)) && (wy >= (1080 - 10)) && (wy <= (1080 + 10)) && (fv >= (500 - 10)) && (fv <= (500 + 10)) ) { x = 1680; y = 1050; fps = 50; }
			

			if( (cx >= (1600 - 5)) && (cx <= (1600 + 5)) && (wy >= (1221 - 10)) && (wy <= (1221 + 10)) && (fv >= (300 - 10)) && (fv <= (300 + 10)) ) { x = 1600; y = 1200; fps = 30; }

			if( (cx >= (1600 - 5)) && (cx <= (1600 + 5)) && (wy >= (1238 - 10)) && (wy <= (1238 + 10)) && (fv >= (500 - 10)) && (fv <= (500 + 10)) ) { x = 1600; y = 1200; fps = 50; }

			if( (cx >= (1600 - 5)) && (cx <= (1600 + 5)) && (wy >= (1250 - 10)) && (wy <= (1250 + 10)) && (fv >= (600 - 10)) && (fv <= (600 + 10)) ) { x = 1600; y = 1200; fps = 60; }
			
			
			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= (1221 - 10)) && (wy <= (1221 + 10)) && (fv >= (300 - 10)) && (fv <= (300 + 10)) ) { x = 1920; y = 1200; fps = 30; }

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= (1235 - 10)) && (wy <= (1235 + 10)) && (fv >= (600 - 10)) && (fv <= (600 + 10)) ) { x = 1920; y = 1200; fps = 60; }

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= (1250 - 10)) && (wy <= (1250 + 10)) && (fv >= (600 - 10)) && (fv <= (600 + 10)) ) { x = 1920; y = 1200; fps = 60; }

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= (1235 - 10)) && (wy <= (1235 + 10)) && (fv >= (500 - 10)) && (fv <= (500 + 10)) ) { x = 1920; y = 1200; fps = 50; }

			if( (cx >= (1920 - 5)) && (cx <= (1920 + 5)) && (wy >= (1250 - 10)) && (wy <= (1250 + 10)) && (fv >= (500 - 10)) && (fv <= (500 + 10)) ) { x = 1920; y = 1200; fps = 50; }

			if( (cx >= (2048 - 5)) && (cx <= (2048 + 5)) && (wy >= (1558 - 10)) && (wy <= (1558 + 10)) && (fv >= (300 - 10)) && (fv <= (300 + 10)) ) { x = 2048; y = 1536; fps = 30; }


			if( (fps == 0) || (x == 0) || (y == 0) ) {

				MST3367_SetRegister( pDevice, 0x00, 0xE2, 0x80 ); // ENABLE AUTO POSITION

				MST3367_SetRegister( pDevice, 0x00, 0xE3, 0x08 ); // REPORT DIGITAL DE WINDOW

				MST3367_SetRegister( pDevice, 0x00, 0xE4, 0x00 ); // POSITION THRESHOLD, DIGITAL SET 0 (10 BIT RESOLUTION)

				BYTE R6C = MST3367_GetRegister( pDevice, 0x00, 0x6C );

				BYTE R6D = MST3367_GetRegister( pDevice, 0x00, 0x6D );

				ULONG n_signal_v_width = (R6D & 0x1F) >> 1;

//				LONGLONG ts = n_signal_detect_delay;

//				ts *= 10000;

//				F6B9E557A4BA24ffd926B820B836289C8_100NS( ts );

				wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies( n_signal_detect_delay ) );

				ULONG n_signal_h_start = ((MST3367_GetRegister( pDevice, 0x00, 0xF4 ) & 0x0F) << 8) | 

										 ((MST3367_GetRegister( pDevice, 0x00, 0xF3 ) & 0xFF) << 0);

				ULONG n_signal_h_end =   ((MST3367_GetRegister( pDevice, 0x00, 0xF6 ) & 0x0F) << 8) | 

										 ((MST3367_GetRegister( pDevice, 0x00, 0xF5 ) & 0xFF) << 0);

				ULONG n_signal_v_start = ((MST3367_GetRegister( pDevice, 0x00, 0xF8 ) & 0x0F) << 8) | 

										 ((MST3367_GetRegister( pDevice, 0x00, 0xF7 ) & 0xFF) << 0);

				ULONG n_signal_v_end =   ((MST3367_GetRegister( pDevice, 0x00, 0xFA ) & 0x0F) << 8) | 

										 ((MST3367_GetRegister( pDevice, 0x00, 0xF9 ) & 0xFF) << 0);

				ULONG n_signal_h_width = ((n_signal_h_start + 12) / 24) * 8;

				LONGLONG n_calc_cx = n_signal_h_end - n_signal_h_start + 1;

				if( n_signal_h_end >= 4095 && n_calc_cx != cx ) { // 4095 = 0x0FFF
					
					n_calc_cx = cx; 
				}
				n_calc_cx &= 0xFFFFFFF8;

				cx &= 0xFFFFFFF8;

				LONGLONG n_calc_cy = n_signal_v_end - n_signal_v_start + 1;

				LONGLONG n_calc_sz = n_calc_cx * n_calc_cy;

				F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO,"[%02d] MST3367_HDMI_MODE_DETECT_AUTO( %d x %d x %d x %d x %d x %d x %d )\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, n_signal_h_start, n_signal_h_end, n_signal_v_start, n_signal_v_end, n_signal_h_width, (LONG)(n_calc_cx), (LONG)(n_calc_cy)  );

				ULONG summary = 0;//pDevice->m_nCloneStreamPointerBaseCommonBufferSize[ 0 ] >> 1;

				if( summary <= (1920 * 1440) ) {

					summary = (1920 * 1440);
				}
				if( n_calc_sz <= summary &&

					n_calc_cx == cx &&
					
					n_calc_cx > 1 &&
					
					n_calc_cy > 1 &&
					
				   (n_calc_cx & 0x07) == 0 ) {

					x = (ULONG)(n_calc_cx);

					y = (ULONG)(n_calc_cy);

					fps = (fv + 5) / (10);

					pSysCfg->n_input_video_resolution_h_total = n_signal_h_total;

					if( (x * y * fps) > (80000000) ||
						
						(x * y) > (2073600) ) {

						pSysCfg->b_input_video_resolution_spliter_mode = TRUE;
					}
					else {

						pSysCfg->b_input_video_resolution_spliter_mode = FALSE;
					}
				//	MST3367_SetRegister( pDevice, 0x00, 0xE2, 0x00 ); // DISABLE AUTO POSITION
				}
			}
			else {

				pSysCfg->n_input_video_resolution_h_total = 0;

				pSysCfg->b_input_video_resolution_spliter_mode = FALSE;

				MST3367_SetRegister( pDevice, 0x00, 0xE2, 0x00 ); // DISABLE AUTO POSITION
			}
			//F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] n_input_video_resolution_h_total(0d%d) \n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, pSysCfg->n_input_video_resolution_h_total );

			if( is_cvte_lvds ) {

				pSysCfg->n_input_video_resolution_h_total = 1;

				pSysCfg->b_input_video_resolution_spliter_mode = TRUE;
			}


			if( x != 0 && y != 0 ) {

				ULONG m = MST3367_GET_FREQV( pDevice );

				if( pSysCfg->n_input_video_resolution_cx != x ||

					pSysCfg->n_input_video_resolution_cy != y ||
					
					//Toshiba case need this
					pSysCfg->n_input_video_resolution_fps_m != m || // [2016.02.15] [?�京??�精?] ?�造�??��?設�?不穩�?( ESAOTE MYLAB TM SEVEN )
					
					pSysCfg->n_input_video_resolution_fps != fps ) {
					
					if( pSysCfg->n_input_video_resolution_cx == 0 || 
						
						pSysCfg->n_input_video_resolution_cy == 0 || 
						
						pSysCfg->n_input_video_resolution_fps == 0 ) {

						BYTE R0207 = MST3367_GetRegister( pDevice, 0x02, 0x07 ); R0207 |= 0x10; 
						
						MST3367_SetRegister( pDevice, 0x02, 0x07, R0207 );
						
						R0207 &= ~0x10;

						MST3367_SetRegister( pDevice, 0x02, 0x07, R0207 );
					}
					pSysCfg->n_input_video_resolution_cx = x;

					pSysCfg->n_input_video_resolution_cy = y;

					pSysCfg->n_input_video_resolution_fps = fps;

					pSysCfg->n_input_video_resolution_fps_m = m;

					if( (pSysCfg->n_input_video_resolution_cx ==  720 && pSysCfg->n_input_video_resolution_cy == 240) ||

						(pSysCfg->n_input_video_resolution_cx ==  720 && pSysCfg->n_input_video_resolution_cy == 288) ||

						(pSysCfg->n_input_video_resolution_cx ==  768 && pSysCfg->n_input_video_resolution_cy == 288) ||

						(pSysCfg->n_input_video_resolution_cx == 1440 && pSysCfg->n_input_video_resolution_cy == 540) ||

						(pSysCfg->n_input_video_resolution_cx == 1920 && pSysCfg->n_input_video_resolution_cy == 540) ) {

						pSysCfg->n_input_video_resolution_interleaved = 1;
					}
					else {

						pSysCfg->n_input_video_resolution_interleaved = 0;
					}
					b_is_signal_changed = TRUE;
				}
				b_is_signal_vaild = TRUE;
			}
		}
		else {

			//keep original value even signal loss, m_nCustomAnalogVideoResolutionProperty set to 0
					
			//pSysCfg->n_input_video_resolution_cx = 0;

			//pSysCfg->n_input_video_resolution_cy = 0;

			//pSysCfg->n_input_video_resolution_fps = 0;

			//pSysCfg->n_input_video_resolution_fps_m = 0;

			pSysCfg->n_input_video_resolution_interleaved = 0;

			pSysCfg->n_input_video_resolution_h_total = 0;

			pSysCfg->n_input_video_resolution_v_total = 0;

			pSysCfg->b_input_video_resolution_spliter_mode = FALSE;
		}
		if( b_is_signal_vaild ) {

			if( pDevice->m_nAnalogCrossbarAudioInputProperty == 0 ) {
				/*
				BYTE R029B = MST3367_GetRegister( pDevice, 0x02, 0x9B ) & 0xF0; 

				pSysCfg->n_input_audio_sampling_frequency = 48000;

				if( R029B == 0x00 ) { pSysCfg->n_input_audio_sampling_frequency = 44100; }

				if( R029B == 0x40 ) { pSysCfg->n_input_audio_sampling_frequency = 48000; }

				if( R029B == 0xC0 ) { pSysCfg->n_input_audio_sampling_frequency = 32000; }
				*/

				//check if audio frequency changed
				if( pSysCfg->n_input_audio_sampling_frequency == MST3367_GetAudioSamplingFreq( pDevice ) * 100)
				{
					NULL;
				}
				else
				{
					pSysCfg->b_input_video_signal_changed = TRUE;
				}

				pSysCfg->n_input_audio_sampling_frequency = MST3367_GetAudioSamplingFreq( pDevice ) * 100;

			}
			else {

				pSysCfg->n_input_audio_sampling_frequency = 48000;
			}
		}
		if( b_is_signal_vaild ) {

			#if defined(AME_PL330B) || defined(AME_PL330A)
			B6DA6D73E4484C36B5A7CF9DFE4BBFB0( pDevice, pDevice->m_nAnalogVideoDecoderStatusProperty, 1 );
			#endif

			ULONG type = MST3367_TMDS_GET_TYPE( pDevice );

			if( pSysCfg->n_input_video_resolution_fps > 50 ) {

				pDevice->FD314ADAD9404496b842EBFC396E875CB = V4L2_STD_NTSC_M;
			}
			else if( pSysCfg->n_input_video_resolution_fps > 30 ) {

				pDevice->FD314ADAD9404496b842EBFC396E875CB = V4L2_STD_PAL_B;
			}
			else if( pSysCfg->n_input_video_resolution_fps > 25 ) {

				pDevice->FD314ADAD9404496b842EBFC396E875CB = V4L2_STD_NTSC_M;
			}
			else {

				pDevice->FD314ADAD9404496b842EBFC396E875CB = V4L2_STD_PAL_B;
			}
			pDevice->m_nCustomAnalogVideoResolutionProperty = (pSysCfg->n_input_video_resolution_cx << 16) |

															  (pSysCfg->n_input_video_resolution_cy <<  0);

			if( pSysCfg->n_input_video_resolution_fps == 59 || 
				
				pSysCfg->n_input_video_resolution_fps == 61 ) {

				pDevice->m_nCustomAnalogVideoFrameRateProperty = 60;
			}
			else if( pSysCfg->n_input_video_resolution_fps == 76 ) {

				pDevice->m_nCustomAnalogVideoFrameRateProperty = 75;
			}
			else {

				pDevice->m_nCustomAnalogVideoFrameRateProperty = pSysCfg->n_input_video_resolution_fps;
			}
			pDevice->m_nCustomAnalogVideoInterleavedProperty = pSysCfg->n_input_video_resolution_interleaved;

			pDevice->m_nCustomAnalogAudioSampleFrequencyProperty = pSysCfg->n_input_audio_sampling_frequency;

			if( pDevice->m_nAnalogVideoDecoderStatusProperty == 0 )
			{
				MST3367_SetRegister( pDevice, 0x02, 0x27, 0x00 ); // UNMUTE AUDIO
			}

			pDevice->m_nAnalogVideoDecoderStatusProperty = 1;

			#ifdef AME_PL330B
			if( pDevice->m_size_not_match_no_signal_blue_pattern )
			{
				CheckAllSettingParameters( pDevice, &pDevice->m_nAnalogVideoDecoderStatusProperty );
			}
			#endif

#ifdef MEDICAL
			pDevice->m_nAnalogCopyProtMacrovisionProperty = 0;
#else
			pDevice->m_nAnalogCopyProtMacrovisionProperty = (type & 0x00000002) ? 1 : 0;
#endif
		}
		else {


			//???
			//pSysCfg->n_input_video_resolution_cx = 0;
			//pSysCfg->n_input_video_resolution_cy = 0;
			//pSysCfg->n_input_video_resolution_fps = 0;

			pDevice->m_nCustomAnalogVideoResolutionProperty = 0;

			pDevice->m_nCustomAnalogVideoFrameRateProperty = 0;

			pDevice->m_nCustomAnalogVideoInterleavedProperty = 0;

			pDevice->m_nCustomAnalogAudioSampleFrequencyProperty = pSysCfg->n_output_audio_sampling_frequency = 0;

			pDevice->m_nAnalogVideoDecoderStatusProperty = 0;

			pDevice->m_nAnalogCopyProtMacrovisionProperty = 0;
		}
		if( b_is_signal_vaild ) {

			ULONG n_packet_status = MST3367_HdmiGetPacketStatus( pDevice );

			if( n_packet_status & 0x00000008 ) {

//				BYTE R0214 = MST3367_GetRegister( pDevice, 0x02, 0x14 ); // -> RxMonitorHdmi
//	
//				if( R0214 & 0x40 ) { // -> RxMonitorHdmi
//	
//					MST3367_SetRegister( pDevice, 0x02, 0x14, R0214 & ~0x40 ); // -> RxMonitorHdmi
//				}
				ULONG n_packet_color = MST3367_HdmiGetPacketColor( pDevice );

				if( pSysCfg->n_input_video_colorspace != n_packet_color ) {

					pSysCfg->n_input_video_colorspace = n_packet_color;

					b_is_signal_changed = TRUE;
				}
//				if( n_packet_status & 0x40 ) { // mute audio while no audio clock regeneration packet
//						
//					MST3367_SetRegister( pDevice, 0x02, 0x27, 0x00 ); // UNMUTE AUDIO
//				}
//				else {
//					
//					MST3367_SetRegister( pDevice, 0x02, 0x27, 0xFF ); // MUTE AUDIO
//				}

			}
			else {

				ULONG n_packet_color = 0x00000000;

				if( pSysCfg->n_input_video_colorspace != n_packet_color ) {

					pSysCfg->n_input_video_colorspace = n_packet_color;

					b_is_signal_changed = TRUE;
				}
			}
		}
		else
		{
			MST3367_SetRegister( pDevice, 0x02, 0x27, 0xFF ); // MUTE AUDIO
		}

		if( b_is_signal_changed ) {

			// -----> RxHandleVideoIn()

			// -----> RxHandleVideoOut()
			//
			#if defined(AME_PL330B) || defined(AME_PL330A)

			if( (pSysCfg->n_input_video_resolution_cx == 1920 && pSysCfg->n_input_video_resolution_cy == 540) ) {

				MST3367_SetRegister( pDevice, 0x00, 0x73, 0x90 );

				MST3367_SetRegister( pDevice, 0x00, 0xB1, 0xE0 );

				MST3367_SetRegister( pDevice, 0x00, 0xB2, 0x08 );
			}
			else {

				MST3367_SetRegister( pDevice, 0x00, 0x73, 0x00 );

				MST3367_SetRegister( pDevice, 0x00, 0xB1, 0xC0 );

				MST3367_SetRegister( pDevice, 0x00, 0xB2, 0x08 );
			}
			#endif
			
			MST3367_SETUP_CSC_TABLE( pDevice );

			pSysCfg->b_input_video_signal_changed = TRUE;

			F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "b_input_video_signal_changed(%d)\n", pSysCfg->b_input_video_signal_changed );
			F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "n_input_video_resolution_cx(%d)\n", pSysCfg->n_input_video_resolution_cx );
			F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "n_input_video_resolution_cy(%d)\n", pSysCfg->n_input_video_resolution_cy );
			F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "n_input_video_resolution_fps(%d)\n", pSysCfg->n_input_video_resolution_fps );
			F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "n_input_video_resolution_fps_m(%d)\n", pSysCfg->n_input_video_resolution_fps_m );

			#ifdef ENABLE_1920X1080PX60FPS // +SC500

			// FPGA
			// 
			#ifndef AME_PL330A
			if( (pDevice->iManufacturer == 0x01 && pDevice->iProduct == 0x07) ||
				
				(pDevice->iManufacturer == 0x04 && pDevice->iProduct == 0x07) ||
				
				(pDevice->iManufacturer == 0x0A && pDevice->iProduct == 0x07) ||

				(pDevice->iManufacturer == 0x10) ||
				
				(pDevice->iManufacturer == 0x16) ||
				
				(pDevice->iManufacturer == 0x17) ||
				
				(pDevice->iManufacturer == 0x1F) ||

			   ((pDevice->iManufacturer & 0xF0) == 0x00 &&
			   
			    (pDevice->iProduct & 0x0F) == 0x05) ) {

				ULONG is_spliter_mode = FALSE;

				if( (pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy ==  768 && pSysCfg->n_input_video_resolution_fps == 85) ||

					(pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy ==  800 && pSysCfg->n_input_video_resolution_fps == 85) ||

					(pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy ==  960 && pSysCfg->n_input_video_resolution_fps == 75) ||

					(pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy ==  960 && pSysCfg->n_input_video_resolution_fps == 85) ||

					(pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy == 1024 && pSysCfg->n_input_video_resolution_fps == 75) ||

					(pSysCfg->n_input_video_resolution_cx == 1280 && pSysCfg->n_input_video_resolution_cy == 1024 && pSysCfg->n_input_video_resolution_fps == 85) ||

					(pSysCfg->n_input_video_resolution_cx == 1400 && pSysCfg->n_input_video_resolution_cy == 1050 && pSysCfg->n_input_video_resolution_fps >   0) ||

					(pSysCfg->n_input_video_resolution_cx == 1440 && pSysCfg->n_input_video_resolution_cy ==  900 && pSysCfg->n_input_video_resolution_fps == 75) ||

					(pSysCfg->n_input_video_resolution_cx == 1440 && pSysCfg->n_input_video_resolution_cy ==  900 && pSysCfg->n_input_video_resolution_fps == 85) ||

					(pSysCfg->n_input_video_resolution_cx == 1680 && pSysCfg->n_input_video_resolution_cy == 1050 && pSysCfg->n_input_video_resolution_fps == 60) ||

					(pSysCfg->n_input_video_resolution_cx == 1680 && pSysCfg->n_input_video_resolution_cy == 1050 && pSysCfg->n_input_video_resolution_fps == 50) ||

					(pSysCfg->n_input_video_resolution_cx == 1920 && pSysCfg->n_input_video_resolution_cy == 1080 && pSysCfg->n_input_video_resolution_fps == 60) ||

					(pSysCfg->n_input_video_resolution_cx == 1920 && pSysCfg->n_input_video_resolution_cy == 1080 && pSysCfg->n_input_video_resolution_fps == 61) ||

					(pSysCfg->n_input_video_resolution_cx == 1920 && pSysCfg->n_input_video_resolution_cy == 1080 && pSysCfg->n_input_video_resolution_fps == 50) ||

					(pSysCfg->n_input_video_resolution_cx == 1600 && pSysCfg->n_input_video_resolution_cy ==  900 && pSysCfg->n_input_video_resolution_fps >   0) ||

					(pSysCfg->n_input_video_resolution_cx == 1600 && pSysCfg->n_input_video_resolution_cy == 1200 && pSysCfg->n_input_video_resolution_fps >   0) ||

					(pSysCfg->n_input_video_resolution_cx == 1920 && pSysCfg->n_input_video_resolution_cy == 1200 && pSysCfg->n_input_video_resolution_fps >   0) ||

					(pSysCfg->n_input_video_resolution_cx == 3840 && pSysCfg->n_input_video_resolution_cy == 1024 && pSysCfg->n_input_video_resolution_fps >   0) ) {

					if( pSysCfg->n_input_video_resolution_cy == 1200 ) {

						FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x24, 0x01 );
					}
					else {

						FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x24, 0x00 );
					}
					is_spliter_mode = TRUE;
				}
				else if( pSysCfg->n_input_video_resolution_h_total > 0 ) {

					is_spliter_mode = pSysCfg->b_input_video_resolution_spliter_mode;

					FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x24, 0x00 );
				}
				else {

					is_spliter_mode = FALSE;
				}

				if( ((pDevice->iManufacturer & 0xF0) == 0x00 &&
			   
					 (pDevice->iProduct & 0x0F) == 0x05) ) { // FOR ALL SC500/SC502

					if( is_spliter_mode ) {

						FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x21, 0x01 ); // BYPASS.MODE

						FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x21, 0x00 ); // SPLIT.MODE
					}
					else {

						FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x21, 0x00 ); // SPLIT.MODE

						FB416CF1CDE54D39BFB1E336A29493C2( pDevice, 0x21, 0x01 ); // BYPASS.MODE
					}
				}
				else {

					if( is_spliter_mode ) {

						ULONG R0000E004 = A77C4935F8134B048348571A43F2A9CA( pDevice, 0x0000E000 + 0x0004 ); // GPIO.WR
						
						R0000E004 |=  0x00020000;

						A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 );

						R0000E004 &= ~0x00020000; // SPLITER.MODE

						A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 );
					}
					else {

						ULONG R0000E004 = A77C4935F8134B048348571A43F2A9CA( pDevice, 0x0000E000 + 0x0004 ); // GPIO.WR

						R0000E004 &= ~0x00020000;

						A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 );

						R0000E004 |=  0x00020000; // BYPASS.MODE

						A60D06861EDC409FA66867980ABA9748( pDevice, 0x0000E000 + 0x0004, R0000E004 );
					}
				}
			}
			MST3367_SetRegister( pDevice, 0x02, 0x27, 0x00 ); // UNMUTE AUDIO
			
			#endif
			#endif
		}
	}


	return TRUE;
}

#define BBIT2    0x0004

#define BBIT3    0x0008

#define BBIT4    0x0010

UINT MST3367_DETECT_VSYNC_WIDTH( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, ULONG knownvtotal, ULONG vfreq )
{
    BYTE reg_value_log1, reg_value_log2, i, j;

	//peter fix boser crash
    //WORD vtotal, diffs[ DIFFTIMES * 3 ], temp, getvalue, same;

	//peter fix !!!!!!!!!!
	BYTE DIFFTIMES = 10;

	WORD vtotal, diffs[ 30 ], temp, getvalue, same; //DIFFTIMES * 3

    reg_value_log1 = MST3367_GetRegister( pDevice, 0, 0x54 );

    MST3367_SetRegister( pDevice, 0, 0x54, (BYTE)(reg_value_log1 & (~BBIT4)) ); //use HV for mode detection

    reg_value_log2=MST3367_GetRegister( pDevice,0,0x0E);

    MST3367_SetRegister( pDevice, 0, 0x0E, (BYTE)(reg_value_log2 | BBIT3) ); //input VSYNC = VSYPOL_USER bit, BIT2

	getvalue = 0;
	
	F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "DetectVSyncWidth() know total %d vfreq %d\n", knownvtotal, vfreq );
	
    for( j = 0 ; j < 150 ; j++ ) {

//      MST3367_SetRegister( pDevice, 0, 0x54, (BYTE)(MST3367_GetRegister( pDevice, 0, 0x54 ) & (~BBIT4)) );

//      MST3367_SetRegister( pDevice, 0, 0x0E, (BYTE)(MST3367_GetRegister( pDevice,0,0x0E) | BBIT3) );

        MST3367_SetRegister( pDevice, 0, 0x0e, (BYTE)(MST3367_GetRegister( pDevice,0,0x0E) ^ BBIT2) );

#if 0
		//peter possible divide by 0
		if(vfreq > 0)
		{
			//Daniel suggest
			#if( AMEBDAD_PRODUCT == AME_CY3014 )

			CY3014_SYS_CFG * pSysCfg = (CY3014_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

			#endif

			#if( AMEBDAD_PRODUCT == AME_SA7160 )

			SA7160_SYS_CFG * pSysCfg = (SA7160_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

			#endif

			#if( AMEBDAD_PRODUCT == AME_FH8735 )

			FH8735_SYS_CFG * pSysCfg = (FH8735_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

			#endif

			#if (AMEBDAD_PRODUCT == AME_PL330A) || \
				(AMEBDAD_PRODUCT == AME_PL330B)

			PL330B_SYS_CFG * pSysCfg = (PL330B_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

			#endif

			#if( AMEBDAD_PRODUCT == AME_MZ0380 )

			MZ0380_SYS_CFG * pSysCfg = (MZ0380_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

			#endif

			//Daniel suggest
			if( pSysCfg->n_Interlace_mode )
			{
				F6B9E557A4BA24ffd926B820B836289C8_100NS( ((ULONG)1100*10000)/vfreq );	//delay 1 frame

				DIFFTIMES = 10;
			}
	        vtotal = (MST3367_GetRegister( pDevice, 0, 0x5b ) << 8) + MST3367_GetRegister( pDevice, 0, 0x5c );
			AMEBDAD_DEBUG( ("DetectVSyncWidth() detect vtotal %d, know total %d \n", vtotal, knownvtotal ));

		}
#else
		{
			ULONG ind, loops;
	
			loops = 2000 / vfreq;			//60HZ, loops = 32;

			for(ind = 0;ind < loops;ind++)
			{
		        vtotal = (MST3367_GetRegister( pDevice, 0, 0x5b ) << 8) + MST3367_GetRegister( pDevice, 0, 0x5c );
				if( (vtotal > (knownvtotal+1)) || (vtotal < (knownvtotal-1)) )
				{
					break;
				}
			}
			if(ind == loops)
			{
				vtotal = (WORD)knownvtotal;
			}
			F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "DetectVSyncWidth() ind = %d, Vfreq = %d, vtotal = %d\n", ind, vfreq, vtotal);
		}
#endif
		

		if( vtotal == 0xffff || vtotal == 0 ) {
			
			break;
		}
		if( vtotal > (WORD)(knownvtotal) ) {
				
			temp = vtotal - (WORD)(knownvtotal);
		}
		else {
			temp = (WORD)(knownvtotal) - vtotal;
		}
		if( temp < 40 && temp > 0) {
				
			same = 0;
						
			diffs[getvalue++] = temp;
						
			for( i = 0 ; i < getvalue ; i++ ) {
						
				if( diffs[ i ] == temp ) {
						
					same++;
						
					if(same == DIFFTIMES/3)			//3 TIMES
					
						goto outdetect;
			}
		}
    }
	if(getvalue >= DIFFTIMES*2 || (getvalue == 0 && j > DIFFTIMES))		//too much sync width difference or all the sync width is 0
	
		break;
				
	}
outdetect:
	F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "MST3367_DETECT_VSYNC_WIDTH( FINAL get value %d, same %d, width %d j %d )\n", getvalue, same, temp, j);

    MST3367_SetRegister( pDevice, 0, 0x54, reg_value_log1 );

    MST3367_SetRegister( pDevice, 0, 0x0E, reg_value_log2 );

	return (ULONG)temp;
}

ULONG GetTotalDisplayModeIndex(ULONG *ptr, int totalindex, ULONG vtotal, ULONG vfreq, ULONG polarity, ULONG syncwidth, ULONG n_sog_vsync_mode, ULONG interlacemode)
{
	int j, count, matchindex, i, freq_diff;

	ULONG * tempptr = ptr;

	ULONG original_vtotal = vtotal;

	matchindex = -1;

	F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "GetTotalDisplayModeIndex Input vtotal %d vfreq %d polarity %d sog vsync mode %d, interlace %d\n", vtotal, vfreq, polarity, n_sog_vsync_mode, interlacemode);

	count = 0;
	
	freq_diff = 0;
		
//peter modify for sync width 0
//	for(i = 0;i < 2;i++)
	for(i = 0;i < 3;i++)
	{
		ptr = tempptr;

		if(i == 1)
			freq_diff = 1;
		for( j = 0 ; j < totalindex ; j++ ) {
			
			if(n_sog_vsync_mode != HV_SEP_MODE || i == 1)	//do not care about HV polarity, while SOG case and 2 loop
				polarity = ptr[ 13 ];
			if(n_sog_vsync_mode == SOG_NO_HSYNC)
			{
				syncwidth = ptr[15];
				vtotal = original_vtotal + syncwidth;
			}
			
			//if( syncwidth == ptr[15]  && (vfreq   >= ptr[ 12 ]-freq_diff) && 
			//peter fix !!!!!!!!!!
			//peter add 
			if( ( (interlacemode == 1 && syncwidth >= (ptr[15] - 1) && syncwidth <= (ptr[15]+1)) || syncwidth == ptr[15] ) && (vfreq   >= ptr[ 12 ]-freq_diff) && 

				//peter add interlace check
				( interlacemode == ptr[18] ) &&
				
				(vfreq  <= ptr[ 12 ]+freq_diff) && 	polarity == ptr[ 13 ] ) 
			{
				 
				if((interlacemode == 1 && vtotal >= (ptr[7] - 1) && vtotal <= (ptr[7]+1))
					|| vtotal == ptr[7])
				{
					count++;
				
					matchindex = j;
				}
			}

			//peter modify for sync width 0
			if( (i == 2) && (count == 0) && (vfreq >= ptr[ 12 ]-freq_diff) && ( interlacemode == ptr[18] ) && (vfreq  <= ptr[ 12 ]+freq_diff) && polarity == ptr[ 13 ] )//if no match for 2 times, neglect sync width
			{

				if((interlacemode == 1 && vtotal >= (ptr[7] - 1) && vtotal <= (ptr[7]+1))
					|| vtotal == ptr[7])
				{

					count++;
	
					matchindex = j;

					break; //out at first matched
				}
			}

			ptr += MODESIZE;
		}
	    
		F1838C0176E054c129B7F2BF440D1236E( KERN_INFO, "GetTotalDisplayModeIndex( loop %d, Input vtotal %d vfreq %d polarity %d, count = %d, match = %d )\n", i, vtotal, vfreq, polarity, count, matchindex);
	
		if( count != 0 ) 
		{
			if(count == 1)
				return matchindex;								//only one display mode match
			return (0x80000000 | (count<<16) | matchindex);		//more than 2 mode match, use the last 16 bits
		}
	}
	
	return 0xffffffff;
}

#define TOTAL_EXTRA 4
static ULONG RX_ADC_SET_VALUES_VESA_EXTRA[ TOTAL_EXTRA ][ MODESIZE ] = { 
{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  525, 144 + 3, 75 + 0,  640,  400, 60, 0, 3150,  2,  25200,  96 }, // [00]  640 ?  400 @60 [DMT  ]
{ 0x08, 0x08, 0x08, 0x18, 0x33, 0x03,  800,  525, 144 + 3, 35 + 0,  640,  480, 60, 0, 3150,  2,  25200,  96 }, // [00]  640 ?  480 @60 [DMT  ]
{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1800, 1000, 424 + 2, 39 + 0, 1280,  960, 60, 3, 6000,  3, 108000, 112 }, // [00] 1280 ?  960 @60 [DMT  ]
{ 0xA0, 0x38, 0x20, 0x30, 0x11, 0x01, 1800, 1000, 176 + 2, 99 + 0, 1600,  900, 60, 3, 6000,  3, 108000,  80 }, // [00] 1600 ?  900 @60 [DMTRB]
};

ULONG DetectDisplayPosition(F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, unsigned int index)
{
	ULONG vstart, vend, i, detect_level, mindex, fps, height, testvstart, testheight, j;

	mindex = 0xff;
	for(i = 0;i < TOTAL_EXTRA;i++)
	{
		if(RX_ADC_SET_VALUES_VESA_EXTRA[i][6] == RX_ADC_SET_VALUES_VESA[index][6] && RX_ADC_SET_VALUES_VESA_EXTRA[i][7] == RX_ADC_SET_VALUES_VESA[index][7] &&
		RX_ADC_SET_VALUES_VESA_EXTRA[i][10] == RX_ADC_SET_VALUES_VESA[index][10] && RX_ADC_SET_VALUES_VESA_EXTRA[i][11] == RX_ADC_SET_VALUES_VESA[index][11] && 
		RX_ADC_SET_VALUES_VESA_EXTRA[i][12] == RX_ADC_SET_VALUES_VESA[index][12] && RX_ADC_SET_VALUES_VESA_EXTRA[i][13] == RX_ADC_SET_VALUES_VESA[index][13] && 
		RX_ADC_SET_VALUES_VESA_EXTRA[i][14] == RX_ADC_SET_VALUES_VESA[index][14] && RX_ADC_SET_VALUES_VESA_EXTRA[i][15] == RX_ADC_SET_VALUES_VESA[index][15])
		{
		    break;
		}
	}
	if(i == TOTAL_EXTRA)
		return 0;
	
	F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "DetectDisplayPosition i = %d index = %d\n",i, index);
	return 0;
	
	fps = RX_ADC_SET_VALUES_VESA[index][12];
	MST3367_SetRegister( pDevice, 0, 0xe2, 0x80);	//enable auto position
	MST3367_SetRegister( pDevice, 0, 0xe3, 0x00);	//report DE windows(pixel count) for analog input
	for(j = 0;j < 6;j++)
	{
		detect_level = 0xa8 - j*16;
		MST3367_SetRegister( pDevice, 0, 0xe4, (unsigned char)detect_level);	//auto position threshold level for analog input

		//peter possible divide by 0
		if( fps > 0 )
		{
			wrapper_schedule_timeout_interruptible( wrapper_msecs_to_jiffies( 21000/fps ) );
		}
		vstart = (MST3367_GetRegister( pDevice,0,0xf7)&0xff) | ((MST3367_GetRegister( pDevice,0,0xf8)&0x0f)<<8) ;
		vend   = (MST3367_GetRegister( pDevice,0,0xf9)&0xff) | ((MST3367_GetRegister( pDevice,0,0xfa)&0x0f)<<8) ;
		height = vend - vstart + 1;
		F1838C0176E054c129B7F2BF440D1236E( KERN_INFO, "DetectDisplayPosition (0x%x) vstart = %d, height = %d \n",detect_level, vstart, height);
		for(i = 0;i < TOTAL_EXTRA;i++)
		{
			if(RX_ADC_SET_VALUES_VESA_EXTRA[i][6] == RX_ADC_SET_VALUES_VESA[index][6] && RX_ADC_SET_VALUES_VESA_EXTRA[i][7] == RX_ADC_SET_VALUES_VESA[index][7])
			{
				testheight = RX_ADC_SET_VALUES_VESA_EXTRA[i][11];
				testvstart = RX_ADC_SET_VALUES_VESA_EXTRA[i][9];
				if(vstart >= (testvstart-2) && vstart <= (testvstart+2) && height >= (testheight - 2) && height <= (testheight + 2))
				{
					mindex = i;
				    break;
				}
			}
		}
		if(mindex != 0xff)
			break;
	}
	MST3367_SetRegister( pDevice, 0, 0xe2, 0x00);	//enable auto position
	if(mindex != 0xff)
	{
		for(i = 0;i < MODESIZE;i++)
		{
			RX_ADC_SET_VALUES_VESA[index][i] = RX_ADC_SET_VALUES_VESA_EXTRA[mindex][i];
		}
	}

	return mindex;
}

ULONG SearchDisplayModeTable(F42A18AF66EFF459eA332CA253FFF8A65 * pDevice, ULONG inputmode, ULONG vtotal, ULONG vfreq, ULONG polarity)
{
	ULONG index, syncwidth;

	index = 0xffffffff;

	#ifdef AME_CY3014

	CY3014_SYS_CFG * pSysCfg = (CY3014_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

	#endif

	#ifdef  AME_SA7160

	SA7160_SYS_CFG * pSysCfg = (SA7160_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

	#endif

	#ifdef AME_FH8735

	FH8735_SYS_CFG * pSysCfg = (FH8735_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

	#endif

	#if defined(AME_PL330B) || defined(AME_PL330A)

	PL330B_SYS_CFG * pSysCfg = (PL330B_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

	#endif

	#ifdef AME_MZ0380

	MZ0380_SYS_CFG * pSysCfg = (MZ0380_SYS_CFG *)(pDevice->m_pCustomSystemConfigProperty);

	#endif

	if( vtotal == 0 || vfreq == 0 ) { return 0xFFFF; }

	syncwidth = MST3367_DETECT_VSYNC_WIDTH( pDevice, vtotal, vfreq );

	F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "syncwidth %d n_SOG_mode %d\n", syncwidth, pSysCfg->n_SOG_mode);
	if(pSysCfg->n_SOG_mode == HV_COMPOSITE || pSysCfg->n_SOG_mode == SOG_SIGNAL)	//composite sync or SOG
	{
		polarity = 0xff;		//For SOG, the HSYNC & VSYNC polarity is useless

		if(syncwidth == 0)
			pSysCfg->n_SOG_vsync_mode = SOG_NO_HSYNC;
		else
		{
//Quantumn data 804, SOG TV Mode, 1080p, 720p, 1080i, 480i, 576i, 
//(no need to handle 480p and 570p, no half horizontal in the vertical blank area)
const ULONG TVMODE_VTOTAL[] = {1130, 755, 578, 272, 320};		//1920
const ULONG TVMODE_VWIDTH[] = {9,     9,   19,   6,   6};
const ULONG REAL_TVMODE_VTOTAL[] ={1125, 750, 1125/2, 525/2, 625/2}; 
const ULONG REAL_TVMODE_VWIDTH[] ={5,   5,   5, 3, 3};
			BYTE i;

			pSysCfg->n_SOG_vsync_mode = SOG_WITH_HSYNC;
			for(i = 0;i < 5;i++)
			{
				F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "compare known (%d %d), (%d, %d)\n", TVMODE_VTOTAL[i], TVMODE_VWIDTH[i], vtotal, syncwidth);
				if((vtotal >= TVMODE_VTOTAL[i]-1 && vtotal <= TVMODE_VTOTAL[i]+1) && 
				   (syncwidth >= TVMODE_VWIDTH[i]-1 && syncwidth <= TVMODE_VWIDTH[i]+1))
				{
					pSysCfg->n_SOG_vsync_mode = SOG_TV_MODE;
					vtotal = REAL_TVMODE_VTOTAL[i];
					syncwidth = REAL_TVMODE_VWIDTH[i];
					F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "SearchDisplayModeTable SOG_TV_MODE vtotal %d vfreq %d sync width %d\n", vtotal, vfreq, syncwidth);
					break;
				}
			}
		}
	}
	else 
	{
		pSysCfg->n_SOG_vsync_mode =  HV_SEP_MODE;
	}

	F1838C0176E054c129B7F2BF440D1236E( KERN_INFO, "SearchDisplayModeTable inputmode %d vtotal %d vfreq %d polarity %d sog vsync mode %d, sync width %d\n", inputmode, vtotal, vfreq, polarity, pSysCfg->n_SOG_vsync_mode, syncwidth);

	if(inputmode == 3) {
		index = GetTotalDisplayModeIndex( (ULONG*)(&RX_ADC_SET_VALUES_VESA[ 0 ]), DEFAULT_MST3367_VESA_SIZE, vtotal, vfreq, polarity, syncwidth, pSysCfg->n_SOG_vsync_mode, pSysCfg->n_Interlace_mode);
	}
	else {
		index = GetTotalDisplayModeIndex( (ULONG*)(&RX_ADC_SET_VALUES_EIA[ 0 ]), DEFAULT_MST3367_EIA_SIZE-1, vtotal, vfreq, polarity, syncwidth, pSysCfg->n_SOG_vsync_mode, pSysCfg->n_Interlace_mode);
	}
		
	if( index == 0xffffffff ) return 0xffff; // nothing found

	if( (index&0xffff) >= DEFAULT_MST3367_VESA_SIZE )
	{
		F966EAAB748564259849CBD3F3D6C48A7( KERN_INFO, "[%02d] error index(0x%x)---!!! 333???\n", pDevice->F0C7DF8CDF1004a6eB97071CBDF459ECE, index );

		return 0xffff;
	}

	if(inputmode == 3) {
		pSysCfg->n_vsync_width = RX_ADC_SET_VALUES_VESA[index&0xffff][15];
	}
	else {
		pSysCfg->n_vsync_width = RX_ADC_SET_VALUES_EIA[index&0xffff][15];
	}

	if(inputmode == 3 && (index & 0x80000000) == 0)
	{
			DetectDisplayPosition(pDevice, index);
		return index;	//only one mode exist
	}

	//more than two mode found, use the last match one
	return index&0xffff;
}

//peter fix audio clock, the same as CIT6612::GetAudioSamplingFreq
const unsigned short SampleFreqs[] = { 320,  441,  480,  882,  960, 1764, 1920};
const unsigned short AudioPLL[] =    {6711, 4870, 4474, 2435, 2237, 1217, 1118};

WORD MST3367_GetAudioSamplingFreq( F42A18AF66EFF459eA332CA253FFF8A65 * pDevice )
{
	BYTE i;
	unsigned short audioSynth, tempvalue;
	
	audioSynth = MST3367_GetRegister(pDevice, 0x02, 0x11)|(((unsigned int)MST3367_GetRegister(pDevice, 0x02, 0x12))<<8);
	i = 0;
	while(1)
	{
		tempvalue = AudioPLL[i];
		if(audioSynth >= (tempvalue-30) && audioSynth <= (tempvalue+30))
			break;
		if(i == 6)
			return 0xffff;
		i++;
	}
	return SampleFreqs[i];
}
